<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NCFS-Pack: NcDSP Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() { init_search(); });
/* @license-end */
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../ncfslogo.jpg"/></td>
  <td id="projectalign">
   <div id="projectname">NCFS-Pack
   </div>
   <div id="projectbrief">A generic (astro)particle physics analysis framework</div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(1); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('d7/d8a/class_nc_d_s_p.html','../../'); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="../../d9/d32/class_nc_d_s_p-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">NcDSP Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Various Digital Signal Processing (DSP) operations for (sequential) data samples.  
 <a href="#details">More...</a></p>

<p><code>#include &quot;<a class="el" href="../../db/da5/_nc_d_s_p_8h_source.html">NcDSP.h</a>&quot;</code></p>
<div class="dynheader">
Inheritance diagram for NcDSP:</div>
<div class="dyncontent">
 <div class="center">
  <img src="../../d7/d8a/class_nc_d_s_p.png" alt=""/>
 </div></div>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Various Digital Signal Processing (DSP) operations for (sequential) data samples. </p>
<hr  />
 <div class="fragment"><div class="line">Copyright(c) 2021 NCFS/IIHE, All Rights Reserved.                           *</div>
<div class="line">                                                                            *</div>
<div class="line">Authors: The Netherlands Center <span class="keywordflow">for</span> Fundamental Studies (NCFS).             *</div>
<div class="line">         The Inter-university Institute <span class="keywordflow">for</span> High Energies (IIHE).           *                 </div>
<div class="line">                   Website : http:<span class="comment">//www.iihe.ac.be                          *</span></div>
<div class="line">           Contact : Nick van Eijndhoven (nickve.nl@gmail.com)              *</div>
<div class="line">                                                                            *</div>
<div class="line">Contributors are mentioned in the code where appropriate.                   *</div>
<div class="line">                                                                            * </div>
<div class="line">No part of <span class="keyword">this</span> software may be used, copied, modified or distributed       *</div>
<div class="line">by any means nor transmitted or translated into machine language <span class="keywordflow">for</span>        *</div>
<div class="line">commercial purposes without written permission by the IIHE representative.  *</div>
<div class="line">Permission to use the software strictly <span class="keywordflow">for</span> non-commercial purposes         *</div>
<div class="line">is hereby granted without fee, provided that the above copyright notice     *</div>
<div class="line">appears in all copies and that both the copyright notice and <span class="keyword">this</span>           *</div>
<div class="line">permission notice appear in the supporting documentation.                   *</div>
<div class="line">This software is provided <span class="stringliteral">&quot;as is&quot;</span> without express or implied warranty.      *</div>
<div class="line">The authors make no claims that <span class="keyword">this</span> software is free of error, or is       *</div>
<div class="line">consistent with any particular standard of merchantability, or that it      *</div>
<div class="line">will meet your requirements <span class="keywordflow">for</span> any particular application, other than      *</div>
<div class="line">indicated in the corresponding documentation.                               *</div>
<div class="line">This software should not be relied on <span class="keywordflow">for</span> solving a problem whose           *</div>
<div class="line">incorrect solution could result in injury to a person or loss of <span class="keyword">property</span>.  *</div>
<div class="line">If you <span class="keywordflow">do</span> use <span class="keyword">this</span> software in such a manner, it is at your own risk.       *</div>
<div class="line">The authors disclaim all liability <span class="keywordflow">for</span> direct or consequential damage       *</div>
<div class="line">resulting from your use of <span class="keyword">this</span> software.                                   *</div>
</div><!-- fragment --> <hr  />
<div class="fragment"><div class="line"><span class="comment">// Class NcDSP</span></div>
<div class="line"><span class="comment">// Class to perform various Digital Signal Processing (DSP) operations on (sequential) data samples.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// For a description of most of the DSP techniques, please refer to the excellent textbook :</span></div>
<div class="line"><span class="comment">// &quot;The Scientist and Engineer&#39;s Guide to Digital Signal Processing&quot; by Steven W. Smith,</span></div>
<div class="line"><span class="comment">// which is online available at http://www.dspguide.com/pdfbook.htm</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The following discrete transformations (using the FFTW algorithms) are supported :</span></div>
<div class="line"><span class="comment">// Fourier (DFT), Hartley (DHT), Sine (DST) and Cosine (DCT).</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// All transformation results have been normalized, such that</span></div>
<div class="line"><span class="comment">// the inverse transformation provides the original input spectrum.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// In addition to the above transformations, also convolution, correlation,</span></div>
<div class="line"><span class="comment">// filter, Analog to Digital Converter (ADC), Digital to Analog Converter (DAC)</span></div>
<div class="line"><span class="comment">// and ADC-DAC chain transmission processors are provided.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// For details about the various operations and their options, please refer</span></div>
<div class="line"><span class="comment">// to the documentation in the corresponding member functions.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Usage example for a discrete Fourier transform (DFT) :</span></div>
<div class="line"><span class="comment">// ------------------------------------------------------</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Int_t N=2048;          // Number of samples</span></div>
<div class="line"><span class="comment">// Float_t fsample=3.2e9; // Sampling rate in Hz</span></div>
<div class="line"><span class="comment">// Float_t nu=3e8;        // Signal frequency in Hz</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Float_t pi=acos(-1.);</span></div>
<div class="line"><span class="comment">// Float_t omega=2.*pi*nu;  // Signal frequency in rad/sec</span></div>
<div class="line"><span class="comment">// Float_t step=1./fsample; // The time step of each sample</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// // Fill the time domain sampled data</span></div>
<div class="line"><span class="comment">// Double_t tdata[N];</span></div>
<div class="line"><span class="comment">// Float_t t=0;</span></div>
<div class="line"><span class="comment">// Float_t y=0;</span></div>
<div class="line"><span class="comment">// for (Int_t i=0; i&lt;N; i++)</span></div>
<div class="line"><span class="comment">// {</span></div>
<div class="line"><span class="comment">//  y=cos(omega*t)+5.*sin(3.*omega*t);</span></div>
<div class="line"><span class="comment">//  tdata[i]=y;</span></div>
<div class="line"><span class="comment">//  t+=step;</span></div>
<div class="line"><span class="comment">// }</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// NcDSP q;</span></div>
<div class="line"><span class="comment">// q.SetSamplingFrequency(fsample);</span></div>
<div class="line"><span class="comment">// q.Load(N,tdata);</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// // Obtain the amplitudes in an array</span></div>
<div class="line"><span class="comment">// q.Fourier(&quot;R2C&quot;);</span></div>
<div class="line"><span class="comment">// TArrayD arr=q.GetData(&quot;AMP out&quot;);</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// // Obtain the amplitudes in a histogram</span></div>
<div class="line"><span class="comment">// TH1F hist;</span></div>
<div class="line"><span class="comment">// q.Fourier(&quot;R2C&quot;,&amp;hist,&quot;AMP Hz&quot;);</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// // Illustration of forward followed by inverse transformation</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// // The original time domain input spectrum</span></div>
<div class="line"><span class="comment">// TH1F hist1;</span></div>
<div class="line"><span class="comment">// q.Fourier(&quot;R2C&quot;,&amp;hist1,&quot;t&quot;);</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// // The forward transformation</span></div>
<div class="line"><span class="comment">// TH1F hist2;</span></div>
<div class="line"><span class="comment">// q.Fourier(&quot;R2C&quot;,&amp;hist2,&quot;AMP Hz&quot;);</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// // Load the obtained frequency domain data as new input to obtain</span></div>
<div class="line"><span class="comment">// // the original time domain spectrum via the inverse transformation</span></div>
<div class="line"><span class="comment">// q.LoadResult();</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// // The frequency domain input spectrum</span></div>
<div class="line"><span class="comment">// TH1F hist3;</span></div>
<div class="line"><span class="comment">// q.Fourier(&quot;C2R&quot;,&amp;hist3,&quot;AMP Hz&quot;);</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// // Obtain the original time domain spectrum via the inverse transformation</span></div>
<div class="line"><span class="comment">// TH1F hist4;</span></div>
<div class="line"><span class="comment">// q.Fourier(&quot;C2R&quot;,&amp;hist4,&quot;t&quot;);</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// TCanvas c1(&quot;c1&quot;,&quot;Forward&quot;);</span></div>
<div class="line"><span class="comment">// c1.Divide(1,2);</span></div>
<div class="line"><span class="comment">// c1.cd(1);</span></div>
<div class="line"><span class="comment">// hist1.Draw();</span></div>
<div class="line"><span class="comment">// c1.cd(2);</span></div>
<div class="line"><span class="comment">// hist2.Draw();</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// TCanvas c2(&quot;c2&quot;,&quot;Inverse&quot;);</span></div>
<div class="line"><span class="comment">// c2.Divide(1,2);</span></div>
<div class="line"><span class="comment">// c2.cd(1);</span></div>
<div class="line"><span class="comment">// hist3.Draw();</span></div>
<div class="line"><span class="comment">// c2.cd(2);</span></div>
<div class="line"><span class="comment">// hist4.Draw();</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Usage example for Convolution :</span></div>
<div class="line"><span class="comment">// ------------------------------- </span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// // The input signal</span></div>
<div class="line"><span class="comment">// const Int_t nx=17;</span></div>
<div class="line"><span class="comment">// Double_t x[nx]={0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0};</span></div>
<div class="line"><span class="comment">// </span></div>
<div class="line"><span class="comment">// // The system impulse response</span></div>
<div class="line"><span class="comment">// const Int_t nh=10;</span></div>
<div class="line"><span class="comment">// Double_t h[nh]={1,0.9,0.8,0.7,0.6,0.5,0.4,0.3,0.2,0.1};</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// NcDSP q;</span></div>
<div class="line"><span class="comment">// q.SetSamplingFrequency(1e9); // Sampling frequency in Hz</span></div>
<div class="line"><span class="comment">// q.Load(nx,x);                // Load the signal input data</span></div>
<div class="line"><span class="comment">// q.SetWaveform(nh,h);         // Load the system response data</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// printf(&quot; Stored elements : Nsignal=%-i  Nwaveform=%-i \n&quot;,q.GetN(),q.GetN(1));</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// // Perform the Convolution</span></div>
<div class="line"><span class="comment">// TH1F hy;</span></div>
<div class="line"><span class="comment">// Int_t smin,smax;</span></div>
<div class="line"><span class="comment">// TArrayD y=q.Convolve(&amp;hy,&amp;smin,&amp;smax);</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// printf(&quot; Convolution full coverage between sample numbers %-i and %-i \n&quot;,smin,smax);</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// // Plot the various distributions</span></div>
<div class="line"><span class="comment">// TH1F hx(&quot;hx&quot;,&quot;Input signal&quot;,nx,0,nx);</span></div>
<div class="line"><span class="comment">// for (Int_t i=1; i&lt;=nx; i++)</span></div>
<div class="line"><span class="comment">// {</span></div>
<div class="line"><span class="comment">//  hx.SetBinContent(i,x[i-1]);</span></div>
<div class="line"><span class="comment">// }</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// TH1F hh(&quot;hh&quot;,&quot;Impulse response&quot;,nh,0,nh);</span></div>
<div class="line"><span class="comment">// for (Int_t i=1; i&lt;=nh; i++)</span></div>
<div class="line"><span class="comment">// {</span></div>
<div class="line"><span class="comment">//  hh.SetBinContent(i,h[i-1]);</span></div>
<div class="line"><span class="comment">// }</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// TCanvas c(&quot;c&quot;,&quot;Convolution&quot;);</span></div>
<div class="line"><span class="comment">// c.Divide(1,3);</span></div>
<div class="line"><span class="comment">// c.cd(1);</span></div>
<div class="line"><span class="comment">// hx.SetMarkerStyle(20);</span></div>
<div class="line"><span class="comment">// hx.Draw(&quot;PL&quot;);</span></div>
<div class="line"><span class="comment">// c.cd(2);</span></div>
<div class="line"><span class="comment">// hh.SetMarkerStyle(20);</span></div>
<div class="line"><span class="comment">// hh.Draw(&quot;PL&quot;);</span></div>
<div class="line"><span class="comment">// c.cd(3);</span></div>
<div class="line"><span class="comment">// hy.SetMarkerStyle(20);</span></div>
<div class="line"><span class="comment">// hy.Draw(&quot;PL&quot;);</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Usage example for cross-correlation :</span></div>
<div class="line"><span class="comment">// -------------------------------------</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// // The input signal</span></div>
<div class="line"><span class="comment">// const Int_t nx=17;</span></div>
<div class="line"><span class="comment">// Double_t x[nx]={0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0};</span></div>
<div class="line"><span class="comment">// </span></div>
<div class="line"><span class="comment">// // The waveform pattern</span></div>
<div class="line"><span class="comment">// const Int_t nh=10;</span></div>
<div class="line"><span class="comment">// Double_t h[nh]={1,0.9,0.8,0.7,0.6,0.5,0.4,0.3,0.2,0.1};</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// NcDSP q;</span></div>
<div class="line"><span class="comment">// q.SetSamplingFrequency(1e9); // Sampling frequency in Hz</span></div>
<div class="line"><span class="comment">// q.Load(nx,x);                // Load the signal input data</span></div>
<div class="line"><span class="comment">// q.SetWaveform(nh,h);         // Load the waveform data</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// printf(&quot; Stored elements : Nsignal=%-i  Nwaveform=%-i \n&quot;,q.GetN(),q.GetN(1));</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// // Perform the Cross-Correlation</span></div>
<div class="line"><span class="comment">// TH1F hy;</span></div>
<div class="line"><span class="comment">// Int_t smin,smax;</span></div>
<div class="line"><span class="comment">// TArrayD y=q.Correlate(&amp;hy,&amp;smin,&amp;smax);</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// printf(&quot; Correlation full coverage between sample numbers %-i and %-i \n&quot;,smin,smax);</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// // Plot the various distributions</span></div>
<div class="line"><span class="comment">// TH1F hx(&quot;hx&quot;,&quot;Input signal&quot;,nx,0,nx);</span></div>
<div class="line"><span class="comment">// for (Int_t i=1; i&lt;=nx; i++)</span></div>
<div class="line"><span class="comment">// {</span></div>
<div class="line"><span class="comment">//  hx.SetBinContent(i,x[i-1]);</span></div>
<div class="line"><span class="comment">// }</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// TH1F hh(&quot;hh&quot;,&quot;Waveform pattern&quot;,nh,0,nh);</span></div>
<div class="line"><span class="comment">// for (Int_t i=1; i&lt;=nh; i++)</span></div>
<div class="line"><span class="comment">// {</span></div>
<div class="line"><span class="comment">//  hh.SetBinContent(i,h[i-1]);</span></div>
<div class="line"><span class="comment">// }</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// TCanvas c(&quot;c&quot;,&quot;Correlation&quot;);</span></div>
<div class="line"><span class="comment">// c.Divide(1,3);</span></div>
<div class="line"><span class="comment">// c.cd(1);</span></div>
<div class="line"><span class="comment">// hx.SetMarkerStyle(20);</span></div>
<div class="line"><span class="comment">// hx.Draw(&quot;PL&quot;);</span></div>
<div class="line"><span class="comment">// c.cd(2);</span></div>
<div class="line"><span class="comment">// hh.SetMarkerStyle(20);</span></div>
<div class="line"><span class="comment">// hh.Draw(&quot;PL&quot;);</span></div>
<div class="line"><span class="comment">// c.cd(3);</span></div>
<div class="line"><span class="comment">// hy.SetMarkerStyle(20);</span></div>
<div class="line"><span class="comment">// hy.Draw(&quot;PL&quot;);</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Usage example for a Band Pass filter :</span></div>
<div class="line"><span class="comment">// --------------------------------------</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// NcDSP q;</span></div>
<div class="line"><span class="comment">// Float_t fsample=1e9; // Sampling frequency in Hz</span></div>
<div class="line"><span class="comment">// q.SetSamplingFrequency(fsample);</span></div>
<div class="line"><span class="comment">// q.Load(nx,x);                    // Load some signal input data</span></div>
<div class="line"><span class="comment">// Double_t f1=200e6/fsample;       // The lower bound (200 MHz) of the frequency band</span></div>
<div class="line"><span class="comment">// Double_t f2=300e6/fsample;       // The upper bound (300 MHz) of the frequency band</span></div>
<div class="line"><span class="comment">// Int_t n=101;     // The number of points describing the filter kernel</span></div>
<div class="line"><span class="comment">// TH1F hisf;       // The frequency domain histogram</span></div>
<div class="line"><span class="comment">// TH1F hist;       // The time domain histogram</span></div>
<div class="line"><span class="comment">// Int_t imin,imax; // The sample number boundaries of the signal for which the kernel is fully embedded</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// // Perform the filtering</span></div>
<div class="line"><span class="comment">// q.FilterBandPass(f1,f2,n,&amp;hisf,&amp;hist,&amp;imin,&amp;imax);</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// printf(&quot; Filter kernel full coverage between sample numbers %-i and %-i \n&quot;,imin,imax);</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// TCanvas cf(&quot;cf&quot;,&quot;cf&quot;);</span></div>
<div class="line"><span class="comment">// hisf.Draw();</span></div>
<div class="line"><span class="comment">// TCanvas ct(&quot;ct&quot;,&quot;ct&quot;);</span></div>
<div class="line"><span class="comment">// hist.Draw();</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Usage example for a Multi Band filter :</span></div>
<div class="line"><span class="comment">// ---------------------------------------</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// NcDSP q;</span></div>
<div class="line"><span class="comment">// Float_t fsample=1e9; // Sampling frequency in Hz</span></div>
<div class="line"><span class="comment">// q.SetSamplingFrequency(fsample);</span></div>
<div class="line"><span class="comment">// q.Load(nx,x);                // Load some signal input data</span></div>
<div class="line"><span class="comment">// Double_t f1=200e6/fsample;   // The lower bound (200 MHz) of the 1st frequency band</span></div>
<div class="line"><span class="comment">// Double_t f2=300e6/fsample;   // The upper bound (300 MHz) of the 1st frequency band</span></div>
<div class="line"><span class="comment">// Double_t f3=450e6/fsample;   // The lower bound (450 MHz) of the 2nd frequency band</span></div>
<div class="line"><span class="comment">// Double_t f4=550e6/fsample;   // The upper bound (550 MHz) of the 2nd frequency band</span></div>
<div class="line"><span class="comment">// TArrayF freqs(4); // Specification of the frequency bands</span></div>
<div class="line"><span class="comment">// freqs[0]=f1;</span></div>
<div class="line"><span class="comment">// freqs[1]=f2;</span></div>
<div class="line"><span class="comment">// freqs[2]=f3;</span></div>
<div class="line"><span class="comment">// freqs[3]=f4;</span></div>
<div class="line"><span class="comment">// Int_t n=101;     // The number of points describing the filter kernel</span></div>
<div class="line"><span class="comment">// TH1F hisf;       // The frequency domain histogram</span></div>
<div class="line"><span class="comment">// TH1F hist;       // The time domain histogram</span></div>
<div class="line"><span class="comment">// Int_t imin,imax; // The sample number boundaries of the signal for which the kernel is fully embedded</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// // Perform the filtering</span></div>
<div class="line"><span class="comment">// q.FilterMultiBand(freqs,n,&amp;hisf,&amp;hist,&amp;imin,&amp;imax);</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// printf(&quot; Filter kernel full coverage between sample numbers %-i and %-i \n&quot;,imin,imax);</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// TCanvas cf(&quot;cf&quot;,&quot;cf&quot;);</span></div>
<div class="line"><span class="comment">// hisf.Draw();</span></div>
<div class="line"><span class="comment">// TCanvas ct(&quot;ct&quot;,&quot;ct&quot;);</span></div>
<div class="line"><span class="comment">// hist.Draw();</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//--- Author: Nick van Eijndhoven, IIHE-VUB, Brussel, October 19, 2021  09:42Z</span></div>
<div class="line"><span class="comment">//- Modified: Nick van Eijndhoven, IIHE-VUB, Brussel, March 25, 2025  11:47Z</span></div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="../../db/da5/_nc_d_s_p_8h_source.html#l00018">18</a> of file <a class="el" href="../../db/da5/_nc_d_s_p_8h_source.html">NcDSP.h</a>.</p>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a6f2607c80cc20d8fb8acf85c8469e293" id="r_a6f2607c80cc20d8fb8acf85c8469e293"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6f2607c80cc20d8fb8acf85c8469e293">NcDSP</a> (const char *name=&quot;&quot;, const char *title=&quot;&quot;)</td></tr>
<tr class="separator:a6f2607c80cc20d8fb8acf85c8469e293"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79f3870217df88f1a19794cedfba3bd2" id="r_a79f3870217df88f1a19794cedfba3bd2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a79f3870217df88f1a19794cedfba3bd2">NcDSP</a> (const <a class="el" href="../../d7/d8a/class_nc_d_s_p.html">NcDSP</a> &amp;q)</td></tr>
<tr class="separator:a79f3870217df88f1a19794cedfba3bd2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2799f6a940c6ee0a298f48fe371c913" id="r_aa2799f6a940c6ee0a298f48fe371c913"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa2799f6a940c6ee0a298f48fe371c913">~NcDSP</a> ()</td></tr>
<tr class="separator:aa2799f6a940c6ee0a298f48fe371c913"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83aecc252cea37b922fab4056f128d45" id="r_a83aecc252cea37b922fab4056f128d45"><td class="memItemLeft" align="right" valign="top">TArrayL64&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a83aecc252cea37b922fab4056f128d45">ADC</a> (Int_t nbits, Double_t range, Double_t Vbias=0, TArray *Vsig=0, TH1 *hist=0, Int_t B=0, Int_t C=3) const</td></tr>
<tr class="separator:a83aecc252cea37b922fab4056f128d45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9fd73361974806a775989f7e89e5729" id="r_ac9fd73361974806a775989f7e89e5729"><td class="memItemLeft" align="right" valign="top">virtual TObject *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac9fd73361974806a775989f7e89e5729">Clone</a> (const char *name=&quot;&quot;) const</td></tr>
<tr class="separator:ac9fd73361974806a775989f7e89e5729"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a368854525d1dd9b8639863172bcd36ed" id="r_a368854525d1dd9b8639863172bcd36ed"><td class="memItemLeft" align="right" valign="top">TArrayD&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a368854525d1dd9b8639863172bcd36ed">Convolve</a> (TH1 *hist=0, Int_t *i1=0, Int_t *i2=0, Int_t shift=0)</td></tr>
<tr class="separator:a368854525d1dd9b8639863172bcd36ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad60376eeb44c4579aa66b4c447180e40" id="r_ad60376eeb44c4579aa66b4c447180e40"><td class="memItemLeft" align="right" valign="top">TArrayD&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad60376eeb44c4579aa66b4c447180e40">Correlate</a> (TH1 *hist=0, Int_t *i1=0, Int_t *i2=0, Double_t *peak=0, TString norm=&quot;NONE&quot;)</td></tr>
<tr class="separator:ad60376eeb44c4579aa66b4c447180e40"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b90651b703eba06ee4320d0107bbf00" id="r_a7b90651b703eba06ee4320d0107bbf00"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7b90651b703eba06ee4320d0107bbf00">Cosine</a> (Int_t type, TH1 *hist=0, TString sel=&quot;none&quot;)</td></tr>
<tr class="separator:a7b90651b703eba06ee4320d0107bbf00"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0e67f9ac1058ceacfe6111eb7688d0a" id="r_aa0e67f9ac1058ceacfe6111eb7688d0a"><td class="memItemLeft" align="right" valign="top">TArrayD&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa0e67f9ac1058ceacfe6111eb7688d0a">DAC</a> (Int_t nbits, Double_t range, Double_t Vbias=0, TArray *adcs=0, TArray *peds=0, TH1 *hist=0, Int_t B=0, Int_t C=3) const</td></tr>
<tr class="separator:aa0e67f9ac1058ceacfe6111eb7688d0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e0119bb2ee8d82d8cf6447f1bb60c9f" id="r_a8e0119bb2ee8d82d8cf6447f1bb60c9f"><td class="memItemLeft" align="right" valign="top">TArrayD&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8e0119bb2ee8d82d8cf6447f1bb60c9f">Digitize</a> (Int_t nbits, Double_t vcal, Int_t mode, TH1 *hist=0, Double_t *stp=0, Double_t *scale=0) const</td></tr>
<tr class="separator:a8e0119bb2ee8d82d8cf6447f1bb60c9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aefcde9f30432748f529637ee3da3a2f1" id="r_aefcde9f30432748f529637ee3da3a2f1"><td class="memItemLeft" align="right" valign="top">TArrayD&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aefcde9f30432748f529637ee3da3a2f1">FilterBandPass</a> (Double_t f1, Double_t f2, Int_t n, TH1 *hisf=0, Bool_t dB=kTRUE, TH1 *hist=0, Int_t *i1=0, Int_t *i2=0, Bool_t adaptn=kTRUE)</td></tr>
<tr class="separator:aefcde9f30432748f529637ee3da3a2f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b1b310255c5a22e6c58839cd0dcf9c2" id="r_a9b1b310255c5a22e6c58839cd0dcf9c2"><td class="memItemLeft" align="right" valign="top">TArrayD&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9b1b310255c5a22e6c58839cd0dcf9c2">FilterBandReject</a> (Double_t f1, Double_t f2, Int_t n, TH1 *hisf=0, Bool_t dB=kTRUE, TH1 *hist=0, Int_t *i1=0, Int_t *i2=0, Bool_t adaptn=kTRUE)</td></tr>
<tr class="separator:a9b1b310255c5a22e6c58839cd0dcf9c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66948496d9a3a99604e3ac4d5761c96e" id="r_a66948496d9a3a99604e3ac4d5761c96e"><td class="memItemLeft" align="right" valign="top">TArrayD&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a66948496d9a3a99604e3ac4d5761c96e">FilterHighPass</a> (Double_t fcut, Int_t n, TH1 *hisf=0, Bool_t dB=kTRUE, TH1 *hist=0, Int_t *i1=0, Int_t *i2=0, Bool_t adaptn=kTRUE)</td></tr>
<tr class="separator:a66948496d9a3a99604e3ac4d5761c96e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a24c382cba3b7bc94eedfbfe9c543734a" id="r_a24c382cba3b7bc94eedfbfe9c543734a"><td class="memItemLeft" align="right" valign="top">TArrayD&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a24c382cba3b7bc94eedfbfe9c543734a">FilterLowPass</a> (Double_t fcut, Int_t n, TH1 *hisf=0, Bool_t dB=kTRUE, TH1 *hist=0, Int_t *i1=0, Int_t *i2=0, Bool_t adaptn=kTRUE)</td></tr>
<tr class="separator:a24c382cba3b7bc94eedfbfe9c543734a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8bbb9fd73ba629c831f41538c639c978" id="r_a8bbb9fd73ba629c831f41538c639c978"><td class="memItemLeft" align="right" valign="top">TArrayD&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8bbb9fd73ba629c831f41538c639c978">FilterMovingAverage</a> (Int_t n, TString mode, TH1 *hist=0, Int_t *i1=0, Int_t *i2=0, TH1 *hisf=0, Bool_t dB=kTRUE)</td></tr>
<tr class="separator:a8bbb9fd73ba629c831f41538c639c978"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ae44f29a31ddda09119ef82d49acee9" id="r_a0ae44f29a31ddda09119ef82d49acee9"><td class="memItemLeft" align="right" valign="top">TArrayD&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0ae44f29a31ddda09119ef82d49acee9">FilterMultiBand</a> (TArray &amp;freqs, Int_t n, TH1 *hisf=0, Bool_t dB=kTRUE, TH1 *hist=0, Int_t *i1=0, Int_t *i2=0, Bool_t adaptn=kTRUE)</td></tr>
<tr class="separator:a0ae44f29a31ddda09119ef82d49acee9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62d6ef8baf2426d10c55e5e8786315c3" id="r_a62d6ef8baf2426d10c55e5e8786315c3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a62d6ef8baf2426d10c55e5e8786315c3">Fourier</a> (TString mode, TH1 *hist=0, TString sel=&quot;none&quot;)</td></tr>
<tr class="separator:a62d6ef8baf2426d10c55e5e8786315c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af82b12df8da7719258c97bdab1337701" id="r_af82b12df8da7719258c97bdab1337701"><td class="memItemLeft" align="right" valign="top">TArrayD&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af82b12df8da7719258c97bdab1337701">GetBandPassKernel</a> (Double_t f1, Double_t f2, Int_t n, TH1 *hisf=0, Bool_t dB=kTRUE, TH1 *hist=0, Bool_t adaptn=kTRUE)</td></tr>
<tr class="separator:af82b12df8da7719258c97bdab1337701"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69555899fb115f18c44c3d0103e38e45" id="r_a69555899fb115f18c44c3d0103e38e45"><td class="memItemLeft" align="right" valign="top">TArrayD&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a69555899fb115f18c44c3d0103e38e45">GetBandRejectKernel</a> (Double_t f1, Double_t f2, Int_t n, TH1 *hisf=0, Bool_t dB=kTRUE, TH1 *hist=0, Bool_t adaptn=kTRUE)</td></tr>
<tr class="separator:a69555899fb115f18c44c3d0103e38e45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d672ab3cb4298ed53214d1147e03f35" id="r_a8d672ab3cb4298ed53214d1147e03f35"><td class="memItemLeft" align="right" valign="top">TArrayD&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8d672ab3cb4298ed53214d1147e03f35">GetData</a> (TString mode) const</td></tr>
<tr class="separator:a8d672ab3cb4298ed53214d1147e03f35"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8829a4cbc8de99cf6d442a1b784c875b" id="r_a8829a4cbc8de99cf6d442a1b784c875b"><td class="memItemLeft" align="right" valign="top">TArrayD&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8829a4cbc8de99cf6d442a1b784c875b">GetHighPassKernel</a> (Double_t fcut, Int_t n, TH1 *hisf=0, Bool_t dB=kTRUE, TH1 *hist=0, Bool_t adaptn=kTRUE)</td></tr>
<tr class="separator:a8829a4cbc8de99cf6d442a1b784c875b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aacd75a5e0c6ff58406ed592ee34c5af9" id="r_aacd75a5e0c6ff58406ed592ee34c5af9"><td class="memItemLeft" align="right" valign="top">TArrayD&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aacd75a5e0c6ff58406ed592ee34c5af9">GetLowPassKernel</a> (Double_t fcut, Int_t n, TH1 *hisf=0, Bool_t dB=kTRUE, TH1 *hist=0, Bool_t adaptn=kTRUE)</td></tr>
<tr class="separator:aacd75a5e0c6ff58406ed592ee34c5af9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab403e51f2b327b1edd31a16eb0f1e625" id="r_ab403e51f2b327b1edd31a16eb0f1e625"><td class="memItemLeft" align="right" valign="top">TArrayD&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab403e51f2b327b1edd31a16eb0f1e625">GetMovingAverageKernel</a> (Int_t n, TH1 *hisf=0, Bool_t dB=kTRUE, TH1 *hist=0)</td></tr>
<tr class="separator:ab403e51f2b327b1edd31a16eb0f1e625"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3fb8f355038b2a8e3a3cbea599e38a0c" id="r_a3fb8f355038b2a8e3a3cbea599e38a0c"><td class="memItemLeft" align="right" valign="top">TArrayD&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3fb8f355038b2a8e3a3cbea599e38a0c">GetMultiBandKernel</a> (TArray &amp;freqs, Int_t n, TH1 *hisf=0, Bool_t dB=kTRUE, TH1 *hist=0, Bool_t adaptn=kTRUE)</td></tr>
<tr class="separator:a3fb8f355038b2a8e3a3cbea599e38a0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09897f6df6a8ba077a86b24714400aaf" id="r_a09897f6df6a8ba077a86b24714400aaf"><td class="memItemLeft" align="right" valign="top">Int_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a09897f6df6a8ba077a86b24714400aaf">GetN</a> (Int_t mode=0) const</td></tr>
<tr class="separator:a09897f6df6a8ba077a86b24714400aaf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb599c179a7c300ddd455fc53c9ebd54" id="r_acb599c179a7c300ddd455fc53c9ebd54"><td class="memItemLeft" align="right" valign="top">Float_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acb599c179a7c300ddd455fc53c9ebd54">GetSamplingFrequency</a> () const</td></tr>
<tr class="separator:acb599c179a7c300ddd455fc53c9ebd54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c2608c32bb15409daef231f43648e1a" id="r_a8c2608c32bb15409daef231f43648e1a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8c2608c32bb15409daef231f43648e1a">Hartley</a> (Int_t mode, TH1 *hist=0, TString sel=&quot;none&quot;)</td></tr>
<tr class="separator:a8c2608c32bb15409daef231f43648e1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e9923feba6dd30ff1de67d849cdf678" id="r_a5e9923feba6dd30ff1de67d849cdf678"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5e9923feba6dd30ff1de67d849cdf678">Hilbert</a> (Int_t mode, TH1 *hist=0, TString sel=&quot;none&quot;)</td></tr>
<tr class="separator:a5e9923feba6dd30ff1de67d849cdf678"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeed9635f232bec20b1b8a8d64cfd2b0a" id="r_aeed9635f232bec20b1b8a8d64cfd2b0a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aeed9635f232bec20b1b8a8d64cfd2b0a">Load</a> (Int_t n, Double_t *re, Double_t *im=0, Float_t f=-1)</td></tr>
<tr class="separator:aeed9635f232bec20b1b8a8d64cfd2b0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c6f7585b1c6b5c672ef86e4c62bd950" id="r_a8c6f7585b1c6b5c672ef86e4c62bd950"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8c6f7585b1c6b5c672ef86e4c62bd950">Load</a> (<a class="el" href="../../de/dcd/class_nc_sample.html">NcSample</a> *s, Int_t i, Float_t f=-1)</td></tr>
<tr class="separator:a8c6f7585b1c6b5c672ef86e4c62bd950"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a323a1fda4a45e3d8b5e2b8f13bc4caf7" id="r_a323a1fda4a45e3d8b5e2b8f13bc4caf7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a323a1fda4a45e3d8b5e2b8f13bc4caf7">Load</a> (<a class="el" href="../../de/dcd/class_nc_sample.html">NcSample</a> *s, TString name, Float_t f=-1)</td></tr>
<tr class="separator:a323a1fda4a45e3d8b5e2b8f13bc4caf7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e81a3a697134fc57f888fce42197e9d" id="r_a5e81a3a697134fc57f888fce42197e9d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5e81a3a697134fc57f888fce42197e9d">Load</a> (TArray *re, TArray *im=0, Float_t f=-1)</td></tr>
<tr class="separator:a5e81a3a697134fc57f888fce42197e9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab872cea8f749c9d878a3addfd6923ad7" id="r_ab872cea8f749c9d878a3addfd6923ad7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab872cea8f749c9d878a3addfd6923ad7">Load</a> (TGraph *gr, Float_t f=-1)</td></tr>
<tr class="separator:ab872cea8f749c9d878a3addfd6923ad7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33355ba7cd7a534f275c5ea45f24d716" id="r_a33355ba7cd7a534f275c5ea45f24d716"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a33355ba7cd7a534f275c5ea45f24d716">Load</a> (TH1 *h, Float_t f=-1)</td></tr>
<tr class="separator:a33355ba7cd7a534f275c5ea45f24d716"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0251f481e659a9d8aea78b76dc311a33" id="r_a0251f481e659a9d8aea78b76dc311a33"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0251f481e659a9d8aea78b76dc311a33">LoadResult</a> ()</td></tr>
<tr class="separator:a0251f481e659a9d8aea78b76dc311a33"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93c6598a165c81a817c66d8d33b7af6a" id="r_a93c6598a165c81a817c66d8d33b7af6a"><td class="memItemLeft" align="right" valign="top">TArrayD&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a93c6598a165c81a817c66d8d33b7af6a">SampleAndHold</a> (Int_t ns, TH1 *hist=0, Int_t loc=-1, Int_t jmin=0, Int_t jmax=-1) const</td></tr>
<tr class="separator:a93c6598a165c81a817c66d8d33b7af6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac85fe915d2a3bcd806ea3968a73c53be" id="r_ac85fe915d2a3bcd806ea3968a73c53be"><td class="memItemLeft" align="right" valign="top">TArrayD&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac85fe915d2a3bcd806ea3968a73c53be">SampleAndHold</a> (TF1 f, Double_t step, Double_t vmin, Double_t vmax, TH1 *hist=0, Int_t loc=-1) const</td></tr>
<tr class="separator:ac85fe915d2a3bcd806ea3968a73c53be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:affa7aa3764900c07a15b09b9020caf05" id="r_affa7aa3764900c07a15b09b9020caf05"><td class="memItemLeft" align="right" valign="top">TArrayD&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#affa7aa3764900c07a15b09b9020caf05">SampleAndSum</a> (Int_t ns, TH1 *hist, Int_t jmin=0, Int_t jmax=-1) const</td></tr>
<tr class="separator:affa7aa3764900c07a15b09b9020caf05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5421ce4995ad4d99d6e9cba90f850e5" id="r_ae5421ce4995ad4d99d6e9cba90f850e5"><td class="memItemLeft" align="right" valign="top">TArrayD&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae5421ce4995ad4d99d6e9cba90f850e5">SampleAndSum</a> (TF1 f, Double_t step, Double_t vmin, Double_t vmax, TH1 *hist=0) const</td></tr>
<tr class="separator:ae5421ce4995ad4d99d6e9cba90f850e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1301f9e36ac0292108a475a7fc62f889" id="r_a1301f9e36ac0292108a475a7fc62f889"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1301f9e36ac0292108a475a7fc62f889">SetSamplingFrequency</a> (Float_t f)</td></tr>
<tr class="separator:a1301f9e36ac0292108a475a7fc62f889"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63d66c347ca2cdc882b590940e7ac175" id="r_a63d66c347ca2cdc882b590940e7ac175"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a63d66c347ca2cdc882b590940e7ac175">SetWaveform</a> (Int_t n, Double_t *h, Float_t f=-1)</td></tr>
<tr class="separator:a63d66c347ca2cdc882b590940e7ac175"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4397b2e0eee2e9b40748771f4476a990" id="r_a4397b2e0eee2e9b40748771f4476a990"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4397b2e0eee2e9b40748771f4476a990">SetWaveform</a> (<a class="el" href="../../de/dcd/class_nc_sample.html">NcSample</a> *s, Int_t i, Float_t f=-1)</td></tr>
<tr class="separator:a4397b2e0eee2e9b40748771f4476a990"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08921a1001ce0ed9064a359795e66d0c" id="r_a08921a1001ce0ed9064a359795e66d0c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a08921a1001ce0ed9064a359795e66d0c">SetWaveform</a> (<a class="el" href="../../de/dcd/class_nc_sample.html">NcSample</a> *s, TString name, Float_t f=-1)</td></tr>
<tr class="separator:a08921a1001ce0ed9064a359795e66d0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8763e48cf48629eddd304cfc44c2ed6c" id="r_a8763e48cf48629eddd304cfc44c2ed6c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8763e48cf48629eddd304cfc44c2ed6c">SetWaveform</a> (TArray *h, Float_t f=-1)</td></tr>
<tr class="separator:a8763e48cf48629eddd304cfc44c2ed6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b9dfcb56cddda2b0ca6706def8ab27b" id="r_a4b9dfcb56cddda2b0ca6706def8ab27b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4b9dfcb56cddda2b0ca6706def8ab27b">SetWaveform</a> (TGraph *gr, Float_t f=-1)</td></tr>
<tr class="separator:a4b9dfcb56cddda2b0ca6706def8ab27b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af38e23b504b608f3dc495a0fcfb40825" id="r_af38e23b504b608f3dc495a0fcfb40825"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af38e23b504b608f3dc495a0fcfb40825">SetWaveform</a> (TH1 *h, Float_t f=-1)</td></tr>
<tr class="separator:af38e23b504b608f3dc495a0fcfb40825"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb13c3f3c536b0527aaccc44d4f5a8a1" id="r_aeb13c3f3c536b0527aaccc44d4f5a8a1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aeb13c3f3c536b0527aaccc44d4f5a8a1">Sine</a> (Int_t type, TH1 *hist=0, TString sel=&quot;none&quot;)</td></tr>
<tr class="separator:aeb13c3f3c536b0527aaccc44d4f5a8a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afacc03640067b04d54f8e0a1a515886c" id="r_afacc03640067b04d54f8e0a1a515886c"><td class="memItemLeft" align="right" valign="top">TArrayD&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afacc03640067b04d54f8e0a1a515886c">Transmit</a> (Int_t nbits, Double_t range, Double_t Vbias=0, TArray *Vsig=0, TArray *peds=0, TH1 *hist=0, Int_t B=0, Int_t C=3) const</td></tr>
<tr class="separator:afacc03640067b04d54f8e0a1a515886c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-methods" name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a9fdac328a320753b02f4afe7cced73a5" id="r_a9fdac328a320753b02f4afe7cced73a5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9fdac328a320753b02f4afe7cced73a5">HistogramFilterFFT</a> (TArray *h, TH1 *hisf, Bool_t dB, Bool_t kernel, TH1 *hist=0)</td></tr>
<tr class="separator:a9fdac328a320753b02f4afe7cced73a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a575237089eac623bf91975837386563f" id="r_a575237089eac623bf91975837386563f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a575237089eac623bf91975837386563f">HistogramTrafoResult</a> (TString name, Int_t mode, TH1 *hist, TString sel)</td></tr>
<tr class="separator:a575237089eac623bf91975837386563f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9d6afad52d8b8cf9ec43e851f63bf03" id="r_af9d6afad52d8b8cf9ec43e851f63bf03"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af9d6afad52d8b8cf9ec43e851f63bf03">Reset</a> ()</td></tr>
<tr class="separator:af9d6afad52d8b8cf9ec43e851f63bf03"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-attribs" name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a69b54f8645cb90858a0135afd08e740c" id="r_a69b54f8645cb90858a0135afd08e740c"><td class="memItemLeft" align="right" valign="top">TArrayD&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a69b54f8645cb90858a0135afd08e740c">fHisto</a></td></tr>
<tr class="separator:a69b54f8645cb90858a0135afd08e740c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34e5e42913d9623d72e9cee8b6858ae4" id="r_a34e5e42913d9623d72e9cee8b6858ae4"><td class="memItemLeft" align="right" valign="top">TArrayD&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a34e5e42913d9623d72e9cee8b6858ae4">fImIn</a></td></tr>
<tr class="separator:a34e5e42913d9623d72e9cee8b6858ae4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b8348e01bce8e11b8ea3c1216ccb020" id="r_a6b8348e01bce8e11b8ea3c1216ccb020"><td class="memItemLeft" align="right" valign="top">TArrayD&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6b8348e01bce8e11b8ea3c1216ccb020">fImOut</a></td></tr>
<tr class="separator:a6b8348e01bce8e11b8ea3c1216ccb020"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aebe9cb538759a671784075e62ae7f799" id="r_aebe9cb538759a671784075e62ae7f799"><td class="memItemLeft" align="right" valign="top">Bool_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aebe9cb538759a671784075e62ae7f799">fKeepOutput</a></td></tr>
<tr class="separator:aebe9cb538759a671784075e62ae7f799"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f049e701e085d51118e339f80be5cdf" id="r_a6f049e701e085d51118e339f80be5cdf"><td class="memItemLeft" align="right" valign="top">Int_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6f049e701e085d51118e339f80be5cdf">fN</a></td></tr>
<tr class="separator:a6f049e701e085d51118e339f80be5cdf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8498148368a1c5fafca2ab544e326d91" id="r_a8498148368a1c5fafca2ab544e326d91"><td class="memItemLeft" align="right" valign="top">TString&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8498148368a1c5fafca2ab544e326d91">fNorm</a></td></tr>
<tr class="separator:a8498148368a1c5fafca2ab544e326d91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad105520e483dc48a2ee5ca221f4f5502" id="r_ad105520e483dc48a2ee5ca221f4f5502"><td class="memItemLeft" align="right" valign="top">Int_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad105520e483dc48a2ee5ca221f4f5502">fNwf</a></td></tr>
<tr class="separator:ad105520e483dc48a2ee5ca221f4f5502"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2dfa20010b5370a7c322f992d845c93" id="r_ab2dfa20010b5370a7c322f992d845c93"><td class="memItemLeft" align="right" valign="top">TVirtualFFT *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab2dfa20010b5370a7c322f992d845c93">fProc</a></td></tr>
<tr class="separator:ab2dfa20010b5370a7c322f992d845c93"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad11cc8c1e6213b72de4c28eea9981e07" id="r_ad11cc8c1e6213b72de4c28eea9981e07"><td class="memItemLeft" align="right" valign="top">TArrayD&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad11cc8c1e6213b72de4c28eea9981e07">fReIn</a></td></tr>
<tr class="separator:ad11cc8c1e6213b72de4c28eea9981e07"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a920356d1a2bd3d00c4be0148e166d3b4" id="r_a920356d1a2bd3d00c4be0148e166d3b4"><td class="memItemLeft" align="right" valign="top">TArrayD&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a920356d1a2bd3d00c4be0148e166d3b4">fReOut</a></td></tr>
<tr class="separator:a920356d1a2bd3d00c4be0148e166d3b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ff8680e1c66ca2defd7ac8a2e17c191" id="r_a5ff8680e1c66ca2defd7ac8a2e17c191"><td class="memItemLeft" align="right" valign="top">Float_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5ff8680e1c66ca2defd7ac8a2e17c191">fSample</a></td></tr>
<tr class="separator:a5ff8680e1c66ca2defd7ac8a2e17c191"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d4532d92035792cda2b6bf57eb9687c" id="r_a5d4532d92035792cda2b6bf57eb9687c"><td class="memItemLeft" align="right" valign="top">TArrayD&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5d4532d92035792cda2b6bf57eb9687c">fWaveform</a></td></tr>
<tr class="separator:a5d4532d92035792cda2b6bf57eb9687c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a6f2607c80cc20d8fb8acf85c8469e293" name="a6f2607c80cc20d8fb8acf85c8469e293"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f2607c80cc20d8fb8acf85c8469e293">&#9670;&#160;</a></span>NcDSP() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">NcDSP::NcDSP </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>name</em></span><span class="paramdefsep"> = </span><span class="paramdefval">&quot;&quot;</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>title</em></span><span class="paramdefsep"> = </span><span class="paramdefval">&quot;&quot;</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="comment">// Default constructor.</span></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html#l00293">293</a> of file <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html">NcDSP.cxx</a>.</p>

</div>
</div>
<a id="aa2799f6a940c6ee0a298f48fe371c913" name="aa2799f6a940c6ee0a298f48fe371c913"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa2799f6a940c6ee0a298f48fe371c913">&#9670;&#160;</a></span>~NcDSP()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">NcDSP::~NcDSP </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel virtual">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="comment">// Default destructor.</span></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html#l00307">307</a> of file <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html">NcDSP.cxx</a>.</p>

</div>
</div>
<a id="a79f3870217df88f1a19794cedfba3bd2" name="a79f3870217df88f1a19794cedfba3bd2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a79f3870217df88f1a19794cedfba3bd2">&#9670;&#160;</a></span>NcDSP() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">NcDSP::NcDSP </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d7/d8a/class_nc_d_s_p.html">NcDSP</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>q</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="comment">// Copy constructor.</span></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html#l00322">322</a> of file <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html">NcDSP.cxx</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a83aecc252cea37b922fab4056f128d45" name="a83aecc252cea37b922fab4056f128d45"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83aecc252cea37b922fab4056f128d45">&#9670;&#160;</a></span>ADC()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TArrayL64 NcDSP::ADC </td>
          <td>(</td>
          <td class="paramtype">Int_t</td>          <td class="paramname"><span class="paramname"><em>nbits</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Double_t</td>          <td class="paramname"><span class="paramname"><em>range</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Double_t</td>          <td class="paramname"><span class="paramname"><em>Vbias</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TArray *</td>          <td class="paramname"><span class="paramname"><em>Vsig</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TH1 *</td>          <td class="paramname"><span class="paramname"><em>hist</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t</td>          <td class="paramname"><span class="paramname"><em>B</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t</td>          <td class="paramname"><span class="paramname"><em>C</em></span><span class="paramdefsep"> = </span><span class="paramdefval">3</span>&#160;) const</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="comment">// Processing of an Analog to Digital Converter (ADC). </span></div>
<div class="line"><span class="comment">// Construct from analog input signals the discrete quantized data values of an &quot;nbits&quot; ADC,</span></div>
<div class="line"><span class="comment">// based on the &quot;range&quot; for the analog signal and a bias voltage &quot;Vbias&quot; (see below).</span></div>
<div class="line"><span class="comment">// The analog input signals may be provided by the (optional) TArray &quot;Vsig&quot;.</span></div>
<div class="line"><span class="comment">// In case the array &quot;Vsig&quot; is not provided, the stored waveform is used to provide the analog input signals.</span></div>
<div class="line"><span class="comment">// The resulting (integer) quantized ADC values are returned in a TArrayL64 object,</span></div>
<div class="line"><span class="comment">// without modification of the original waveform data.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Note : Make sure to use the same units for &quot;range&quot;, &quot;Vbias&quot; and the analog input signals.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The number of available quantization levels is given by N=2^|nbits|, of which the lowest</span></div>
<div class="line"><span class="comment">// level represents the value 0. This yields for the quantized values (adc) the range [0,N-1].</span></div>
<div class="line"><span class="comment">// The mapping of an analog input voltage (Vin) to one of the quantization levels depends on the</span></div>
<div class="line"><span class="comment">// specified &quot;range&quot; and &quot;Vbias&quot; and whether we have a linear or Log ADC (see below).</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// As outlined below, the range of the analog input voltage can be specified as the Full Scale</span></div>
<div class="line"><span class="comment">// voltage range (Vfs) corresponding to adc=N-1 or as the Reference voltage (Vref) corresponding to</span></div>
<div class="line"><span class="comment">// the hypothetical adc=N.</span></div>
<div class="line"><span class="comment">// </span></div>
<div class="line"><span class="comment">// The Least Significant Bit (LSB) represents the smallest analog input voltage interval</span></div>
<div class="line"><span class="comment">// that can reliably be resolved. In other words LSB=Voltage(adc=1)-Voltage(adc=0).</span></div>
<div class="line"><span class="comment">// For a linear ADC we have : LSB=Vfs/(N-1) or equivalently LSB=Vref/N.</span></div>
<div class="line"><span class="comment">// For a Log_B ADC (see below) we have : LSB=Vref*pow(B,-C)*(pow(B,C/N)-1).</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The formulas for the Vin-&gt;adc mapping with Vin=(Vbias+Vsig) are :</span></div>
<div class="line"><span class="comment">// Linear ADC : adc=Vin/LSB.</span></div>
<div class="line"><span class="comment">// Log_B ADC (see below) : adc=(N/C)*Log_B(pow(B,C)*Vin/Vref).</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Which leads to the following relations between Vref and Vfs : </span></div>
<div class="line"><span class="comment">// Linear ADC : Vref=Vfs+LSB.</span></div>
<div class="line"><span class="comment">// Log_B ADC (see below) : Vfs=Vref*pow(B,-C)*pow(B,(N-1)*C/N).</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The Dynamic Range (DR) is defined as the ratio of the largest and smallest input voltages</span></div>
<div class="line"><span class="comment">// that can reliably be resolved.</span></div>
<div class="line"><span class="comment">// Expressed in decibel we have : DR=20*log_10(Vfs/LSB) dB.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// For details about the procedure, please refer to the excellent textbook :</span></div>
<div class="line"><span class="comment">// &quot;The Scientist and Engineer&#39;s Guide to Digital Signal Processing&quot; by Steven W. Smith,</span></div>
<div class="line"><span class="comment">// which is online available at http://www.dspguide.com/pdfbook.htm</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// and the publication by Y. Sundarasaradula et al. :</span></div>
<div class="line"><span class="comment">// &quot;A 6-bit, Two-step, Successive Approximation Logarithmic ADC for Biomedical Applications&quot;</span></div>
<div class="line"><span class="comment">// which is online available at https://spiral.imperial.ac.uk/bitstream/10044/1/44156/2/2016_ICECS_LogADC_Camera.pdf.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Input arguments :</span></div>
<div class="line"><span class="comment">// -----------------</span></div>
<div class="line"><span class="comment">// nbits    : Digital quantization of the input values will be performed using nbits.</span></div>
<div class="line"><span class="comment">// range &gt;0 : The full scale voltage range (Vfs) of the analog signal that corresponds to adc=N-1. </span></div>
<div class="line"><span class="comment">//       &lt;0 : |range| is the reference voltage (Vref) of the analog signal that corresponds to the hypothetical adc=N.</span></div>
<div class="line"><span class="comment">// Vbias    : The bias voltage that will be added to the analog input signal before digitization.</span></div>
<div class="line"><span class="comment">// Vsig     : (Optional) array to contain the analog input signals.</span></div>
<div class="line"><span class="comment">// B     &gt;1 : Base for a Log ADC (e.g. B=10 emulates a Log_10 ADC).</span></div>
<div class="line"><span class="comment">//       =0 : The ADC will be linear</span></div>
<div class="line"><span class="comment">//       =1 : The ADC will be a Log_e ADC.</span></div>
<div class="line"><span class="comment">//            Note : When B&gt;0 all (Vbias+Vsig) input values should be positive.</span></div>
<div class="line"><span class="comment">// C        : Code efficiency factor for a Log ADC.</span></div>
<div class="line"><span class="comment">//            Rule of thumb : pow(B,-C) is about the smallest signal/|range| ratio that can be resolved.</span></div>
<div class="line"><span class="comment">//            So, for a log_10 ADC with C=3, the smallest signal that can be resolved is about |range|/1000.</span></div>
<div class="line"><span class="comment">//            Note : It is required that C&gt;0.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Optional output arguments :</span></div>
<div class="line"><span class="comment">// ---------------------------</span></div>
<div class="line"><span class="comment">// hist  : Histogram with the digitized result</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Notes :</span></div>
<div class="line"><span class="comment">// -------</span></div>
<div class="line"><span class="comment">// 1) In case no &quot;Vsig&quot; array is provided and no waveform is present, just the ADC specs will be printed</span></div>
<div class="line"><span class="comment">//    and in the TArrayL64 only the adc value corresponding to Vbias is returned.</span></div>
<div class="line"><span class="comment">//    This allows to quickly investigate various scenarios without any data treatment.</span></div>
<div class="line"><span class="comment">// 2) Providing a &quot;Vsig&quot; array with different small (random) amplitudes allows to mimic variations of the bias or</span></div>
<div class="line"><span class="comment">//    characteristics of the various switched capacitor array elements for the individual samplings.</span></div>
<div class="line"><span class="comment">//    This resembles a so called &quot;pedestal run&quot; in real life Data Acquisition (DAQ) applications.</span></div>
<div class="line"><span class="comment">//    For a linear ADC, the contents of the returned TArrayL64 can be used afterwards for pedestal subtraction.  </span></div>
<div class="line"><span class="comment">//         </span></div>
<div class="line"><span class="comment">// The maximum number of bits that is supported is 60 to guarantee identical functioning</span></div>
<div class="line"><span class="comment">// on all machines.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// In case of inconsistent input parameters, no digitization is performed and an empty TArrayL64 is returned.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The default values are Vbias=0, Vsig=0, hist=0, B=0 and C=3.</span></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html#l02798">2798</a> of file <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html">NcDSP.cxx</a>.</p>

</div>
</div>
<a id="ac9fd73361974806a775989f7e89e5729" name="ac9fd73361974806a775989f7e89e5729"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9fd73361974806a775989f7e89e5729">&#9670;&#160;</a></span>Clone()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TObject * NcDSP::Clone </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>name</em></span><span class="paramdefsep"> = </span><span class="paramdefval">&quot;&quot;</span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel virtual">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="comment">// Make a deep copy of the current object and provide the pointer to the copy.</span></div>
<div class="line"><span class="comment">// This memberfunction enables automatic creation of new objects of the</span></div>
<div class="line"><span class="comment">// correct type depending on the object type, a feature which may be very useful</span></div>
<div class="line"><span class="comment">// for containers like NcEvent when adding objects in case the</span></div>
<div class="line"><span class="comment">// container owns the objects.</span></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html#l05552">5552</a> of file <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html">NcDSP.cxx</a>.</p>

</div>
</div>
<a id="a368854525d1dd9b8639863172bcd36ed" name="a368854525d1dd9b8639863172bcd36ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a368854525d1dd9b8639863172bcd36ed">&#9670;&#160;</a></span>Convolve()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TArrayD NcDSP::Convolve </td>
          <td>(</td>
          <td class="paramtype">TH1 *</td>          <td class="paramname"><span class="paramname"><em>hist</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t *</td>          <td class="paramname"><span class="paramname"><em>i1</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t *</td>          <td class="paramname"><span class="paramname"><em>i2</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t</td>          <td class="paramname"><span class="paramname"><em>shift</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="comment">// Convolve the loaded input data x[] with the data contained in the (system response)</span></div>
<div class="line"><span class="comment">// waveform h[] and return the resulting data y[] in a TArrayD object.</span></div>
<div class="line"><span class="comment">// The input data x[] have to be entered as real numbers by one of the Load() member functions,</span></div>
<div class="line"><span class="comment">// whereas the (system response) waveform h[] has to be specified by SetWaveform().</span></div>
<div class="line"><span class="comment">// The provided data of x[] and h[] are not modified.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// In formula : y[]=x[]*h[].</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The convolution of two (time) series expresses how the shape of one</span></div>
<div class="line"><span class="comment">// is modified by the other, which makes it a versatile tool to describe</span></div>
<div class="line"><span class="comment">// system responses, digital filtering processing, superposition of various influences</span></div>
<div class="line"><span class="comment">// in physical systems etc.</span></div>
<div class="line"><span class="comment">// The result y[] can be regarded as the weighted sum (or pdf) of X+H, where </span></div>
<div class="line"><span class="comment">// X and H are two independent random variables with as pdf x[] and h[], respectively.</span></div>
<div class="line"><span class="comment">// Note that here x[]*h[] is identical to h[]*x[].</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// For details about the procedure, please refer to the excellent textbook :</span></div>
<div class="line"><span class="comment">// &quot;The Scientist and Engineer&#39;s Guide to Digital Signal Processing&quot; by Steven W. Smith,</span></div>
<div class="line"><span class="comment">// which is online available at http://www.dspguide.com/pdfbook.htm</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Input arguments :</span></div>
<div class="line"><span class="comment">// -----------------</span></div>
<div class="line"><span class="comment">// hist : (optional) Histogram with the convolution result</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The (optional) arguments i1 and i2 provide the range [i1,i2] in the</span></div>
<div class="line"><span class="comment">// resulting convolved data array for which &quot;h&quot; was fully immersed in the</span></div>
<div class="line"><span class="comment">// input (signal) data x[].</span></div>
<div class="line"><span class="comment">// In other words : The indices range [i1,i2] in the resulting convolved data array y[]</span></div>
<div class="line"><span class="comment">// corresponds to all the y[] elements for which the convolution was completely performed</span></div>
<div class="line"><span class="comment">// by using all the elements of h[].</span></div>
<div class="line"><span class="comment">// So, values of y[j] with j&lt;i1 or j&gt;i2 contain incomplete convolutions, and as such should not</span></div>
<div class="line"><span class="comment">// be considered as reliable, especially when x[] and/or h[] contain large variations.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The argument &quot;shift&quot; determines whether the Xaxis values of the (optional) result histogram</span></div>
<div class="line"><span class="comment">// are shifted or that the array y[] is truncated in order to provide (a view of) the resulting array y[]</span></div>
<div class="line"><span class="comment">// such that it can be directly compared to the original array x[] (see notes 2) and 3) below).</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The convention is :</span></div>
<div class="line"><span class="comment">// shift = 0 --&gt; No shift and the full array y[] is returned and shown &quot;as is&quot; in the (optional) histogram.</span></div>
<div class="line"><span class="comment">//         1 --&gt; The full array y[] is returned and shown in the (optional) histogram with y[i1] at the center.</span></div>
<div class="line"><span class="comment">//               This mode is particulary useful for correlation studies between two distributions [see Correlate()],</span></div>
<div class="line"><span class="comment">//               since it will show both negative and positive values at the Xaxis of the (optional) histogram,</span></div>
<div class="line"><span class="comment">//               and the self-correlation peak coincides with the value 0 at the Xaxis.  </span></div>
<div class="line"><span class="comment">//         2 --&gt; The array y[] contains only the modified x[] elements and is shown with y[0] at the start of the (optional) histogram.</span></div>
<div class="line"><span class="comment">//               This mode is particulary useful for digital filtering processes (see the various filtering member functions),</span></div>
<div class="line"><span class="comment">//               since it allows to directly compare the filtered and the unfiltered x[] distribution.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Notes :</span></div>
<div class="line"><span class="comment">// -------</span></div>
<div class="line"><span class="comment">// 1) The sampling (rate) of h[] has to be the same as for the input data x[].</span></div>
<div class="line"><span class="comment">// 2) Array sizes of x[nx] and h[nh] will result in a convolved data array of size y[(nx+nh-1)],</span></div>
<div class="line"><span class="comment">//    except for shift=2 for which the convolved data array has size y[nx]. </span></div>
<div class="line"><span class="comment">// 3) For an absolute comparison between the x[] and y[] values, one should realize that </span></div>
<div class="line"><span class="comment">//    the array sizes of x[] and y[] are different and that x[k] should be compared with y[k+i1].</span></div>
<div class="line"><span class="comment">// 4) The values i1 and i2 (if requested) are indicated by vertical dashed blue lines</span></div>
<div class="line"><span class="comment">//    in the time domain histogram.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The default values are hist=0, i1=0, i2=0 and shift=0.</span></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html#l02126">2126</a> of file <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html">NcDSP.cxx</a>.</p>

</div>
</div>
<a id="ad60376eeb44c4579aa66b4c447180e40" name="ad60376eeb44c4579aa66b4c447180e40"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad60376eeb44c4579aa66b4c447180e40">&#9670;&#160;</a></span>Correlate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TArrayD NcDSP::Correlate </td>
          <td>(</td>
          <td class="paramtype">TH1 *</td>          <td class="paramname"><span class="paramname"><em>hist</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t *</td>          <td class="paramname"><span class="paramname"><em>i1</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t *</td>          <td class="paramname"><span class="paramname"><em>i2</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Double_t *</td>          <td class="paramname"><span class="paramname"><em>peak</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TString</td>          <td class="paramname"><span class="paramname"><em>norm</em></span><span class="paramdefsep"> = </span><span class="paramdefval">&quot;NONE&quot;</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="comment">// (Cross) Correlate the data contained in the waveform h[] with the loaded input data x[]</span></div>
<div class="line"><span class="comment">// and return the resulting data y[] in a TArrayD object.</span></div>
<div class="line"><span class="comment">// The input data x[] have to be entered as real numbers by one of the Load() member functions,</span></div>
<div class="line"><span class="comment">// whereas the waveform h[] has to be specified by SetWaveform().</span></div>
<div class="line"><span class="comment">// The provided data of x[] and h[] are not modified.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// In formula : y[]=h[]*x[].</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The cross-correlation is a measure of similarity of two (time) series as a function</span></div>
<div class="line"><span class="comment">// of the displacement of one relative to the other.</span></div>
<div class="line"><span class="comment">// The result y[] can be regarded as the weighted sum (or pdf) of X-H, where </span></div>
<div class="line"><span class="comment">// X and H are two independent random variables with as pdf x[] and h[], respectively.</span></div>
<div class="line"><span class="comment">// Note that here h[]*x[] is different from x[]*h[].</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Mathematically it is seen that the cross-correlation h[]*x[] is equivalent</span></div>
<div class="line"><span class="comment">// to the convolution of h[] and x[], but with the ordering of the elements</span></div>
<div class="line"><span class="comment">// of the distribution h[] reversed.</span></div>
<div class="line"><span class="comment">// </span></div>
<div class="line"><span class="comment">// In formula : Cross-correlation h[m]*x[n] is equivalent to Convolution h[-m]*x[n].</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// This feature is used here to centralize the computation in the member function Convolve(),</span></div>
<div class="line"><span class="comment">// so that also this Correlate() processor will automatically profit from possible CPU speed</span></div>
<div class="line"><span class="comment">// improvements in the Convolution processor.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// For details about the procedure, please refer to the excellent textbook :</span></div>
<div class="line"><span class="comment">// &quot;The Scientist and Engineer&#39;s Guide to Digital Signal Processing&quot; by Steven W. Smith,</span></div>
<div class="line"><span class="comment">// which is online available at http://www.dspguide.com/pdfbook.htm</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Input arguments :</span></div>
<div class="line"><span class="comment">// -----------------</span></div>
<div class="line"><span class="comment">// hist : (optional) Histogram with the correlation result</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The (optional) arguments i1 and i2 provide the range [i1,i2] in the</span></div>
<div class="line"><span class="comment">// resulting correlated data array for which &quot;h&quot; was fully immersed in the</span></div>
<div class="line"><span class="comment">// input (signal) data.</span></div>
<div class="line"><span class="comment">// These values i1 and i2 (if requested) are indicated by vertical</span></div>
<div class="line"><span class="comment">// dashed blue lines in the histogram.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The (optional) argument &quot;peak&quot; provides the location of the correlation peak, indicating</span></div>
<div class="line"><span class="comment">// the shift (aka lag) of the h[] pattern w.r.t. the best matching pattern in x[], with the convention</span></div>
<div class="line"><span class="comment">// that the autocorrelation peak falls at 0.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The (optional) argument &quot;norm&quot; allows to obtain the normalized correlation values.</span></div>
<div class="line"><span class="comment">// When normalized, the resulting correlation values will be in the interval [-1,1],</span></div>
<div class="line"><span class="comment">// which facilitates an interpretation of the amount of correlation.</span></div>
<div class="line"><span class="comment">// However, it should be realized that different normalizations may result in different cross-correlation profiles,</span></div>
<div class="line"><span class="comment">// as outlined below.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// norm = &quot;NONE&quot; --&gt; No normalization</span></div>
<div class="line"><span class="comment">//        &quot;GNCC&quot; --&gt; Same as norm=&quot;NONE&quot; but the resulting correlation values will be divided by (|h|*|x|) of the total vectors h[] and [x] </span></div>
<div class="line"><span class="comment">//        &quot;NCC&quot;  --&gt; NCC  normalization, i.e. Sum{h[i]*x[i]/(|h|*|x|)}, where |h| and |x| are the vector lengths of the overlapping parts</span></div>
<div class="line"><span class="comment">//        &quot;ZNCC&quot; --&gt; ZNCC normalization, i.e. (1/N)*Sum{(h[i]-hmean)*(x[i]-xmean)/(sx*sh)}, where sx and sh are the STDs of the overlapping parts</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The &quot;NCC&quot; and &quot;ZNCC&quot; normalizations are preferred when looking for pattern matches, irrespective of the amplitudes.</span></div>
<div class="line"><span class="comment">// This will provide consistent results for different amplitudes of x[] and/or h[], but may yield incorrect results when</span></div>
<div class="line"><span class="comment">// looking for a (time) lag between two pulses on top of some background noise.</span></div>
<div class="line"><span class="comment">// The &quot;GNCC&quot; normalization is preferred in case amplitude matches, next to pattern matches, are also relevant.</span></div>
<div class="line"><span class="comment">// This is the preferred method when looking for a (time) lag between two pulses on top of some background noise,</span></div>
<div class="line"><span class="comment">// but in case of a bad SNR, the results may become unreliable.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Note : The sampling (rate) of h has to be the same as for the loaded input data x[].</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The default values are hist=0, i1=0, i2=0, peak=0 and norm=&quot;NONE&quot;.</span></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html#l02402">2402</a> of file <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html">NcDSP.cxx</a>.</p>

</div>
</div>
<a id="a7b90651b703eba06ee4320d0107bbf00" name="a7b90651b703eba06ee4320d0107bbf00"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b90651b703eba06ee4320d0107bbf00">&#9670;&#160;</a></span>Cosine()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NcDSP::Cosine </td>
          <td>(</td>
          <td class="paramtype">Int_t</td>          <td class="paramname"><span class="paramname"><em>type</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TH1 *</td>          <td class="paramname"><span class="paramname"><em>hist</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TString</td>          <td class="paramname"><span class="paramname"><em>sel</em></span><span class="paramdefsep"> = </span><span class="paramdefval">&quot;none&quot;</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="comment">// Perform a normalized 1-dimensional Discrete Cosine Transformation (DCT).</span></div>
<div class="line"><span class="comment">// Actually, this is just a regular Discrete Fourier Transformation (DFT)</span></div>
<div class="line"><span class="comment">// with only real input values which contain an even symmetry.</span></div>
<div class="line"><span class="comment">// Consequently, the resulting transformed array is also only real with even symmetry.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Conventions :</span></div>
<div class="line"><span class="comment">// -------------</span></div>
<div class="line"><span class="comment">// N = The number of data elements</span></div>
<div class="line"><span class="comment">// Time domain array .... : X[]=X[0],...,X[N-1]</span></div>
<div class="line"><span class="comment">// Frequency domain array : Q[]=Q[0],...,Q[N-1]</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Cosine transform type 1 : Q[k]=(1/sqrt(2*(N-1)))*[X[0]+pow(-1,k)*X[N-1]+2*sum(n=1,n=N-2){X[n]*cos(pi*n*k/(N-1))}]</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Cosine transform type 2 : Q[k]=(1/sqrt(2N))*2*sum(n=0,n=N-1){X[n]*cos(pi*(n+0.5)*k/N)}]</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Cosine transform type 3 : Q[k]=(1/sqrt(2N))[X[0]+2*sum(n=0,n=N-1){X[n]*cos(pi*n*(k+0.5)/N)}]</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Cosine transform type 4 : Q[k]=(1/sqrt(2N))*2*sum(n=0,n=N-1){X[n]*cos(pi*(n+0.5)*(k+0.5)/N)}</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Notes :</span></div>
<div class="line"><span class="comment">// -------</span></div>
<div class="line"><span class="comment">// 1) The type 1 transformation is only defined for N&gt;1 and is its own inverse.</span></div>
<div class="line"><span class="comment">// 2) The type 4 transformation is its own inverse.</span></div>
<div class="line"><span class="comment">// 3) The type 3 transformation is the inverse of type 2 (and vice versa).</span></div>
<div class="line"><span class="comment">// 4) The type 2 transformation is often called &quot;the&quot; DCT.</span></div>
<div class="line"><span class="comment">// 5) The type 3 transformation id often called &quot;the&quot; inverse DCT (IDCT).   </span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Input arguments :</span></div>
<div class="line"><span class="comment">// -----------------</span></div>
<div class="line"><span class="comment">// type : The type of transformation (i.e. 1,2,3 or 4) to be performed</span></div>
<div class="line"><span class="comment">//        The inverse transformations are specified with the corresponding negative type value</span></div>
<div class="line"><span class="comment">// hist : (optional) Histogram with selected results</span></div>
<div class="line"><span class="comment">// sel  : String to specify the representation of the result histogram</span></div>
<div class="line"><span class="comment">//        &quot;k&quot;    --&gt; X-axis represents the index k in the frequency domain  </span></div>
<div class="line"><span class="comment">//        &quot;f&quot;    --&gt; X-axis represents the fraction f of the sampling rate in the frequency domain</span></div>
<div class="line"><span class="comment">//        &quot;Hz&quot;   --&gt; X-axis represents the actual frequency in Hz in the frequency domain</span></div>
<div class="line"><span class="comment">//        &quot;n&quot;    --&gt; X-axis represents the index n in the time domain  </span></div>
<div class="line"><span class="comment">//        &quot;t&quot;    --&gt; X-axis represents the actual time in seconds in the time domain</span></div>
<div class="line"><span class="comment">//        &quot;2&quot;    --&gt; X-axis spans the full number of data points, instead of the usual (N/2)+1</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Note : The options &quot;Hz&quot; and &quot;t&quot; can only be used if the actual data acquisition sampling rate</span></div>
<div class="line"><span class="comment">//        has been provided via the Load() memberfunction.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Examples :</span></div>
<div class="line"><span class="comment">// ----------</span></div>
<div class="line"><span class="comment">// sel=&quot;f&quot; will show the (N/2)+1 amplitudes as a function of the fractional sampling rate.</span></div>
<div class="line"><span class="comment">// sel=&quot;k 2&quot; will show all N amplitudes as a function of the index k in the frequency domain.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The default values are hist=0 and sel=&quot;none&quot;</span></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html#l01334">1334</a> of file <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html">NcDSP.cxx</a>.</p>

</div>
</div>
<a id="aa0e67f9ac1058ceacfe6111eb7688d0a" name="aa0e67f9ac1058ceacfe6111eb7688d0a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0e67f9ac1058ceacfe6111eb7688d0a">&#9670;&#160;</a></span>DAC()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TArrayD NcDSP::DAC </td>
          <td>(</td>
          <td class="paramtype">Int_t</td>          <td class="paramname"><span class="paramname"><em>nbits</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Double_t</td>          <td class="paramname"><span class="paramname"><em>range</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Double_t</td>          <td class="paramname"><span class="paramname"><em>Vbias</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TArray *</td>          <td class="paramname"><span class="paramname"><em>adcs</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TArray *</td>          <td class="paramname"><span class="paramname"><em>peds</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TH1 *</td>          <td class="paramname"><span class="paramname"><em>hist</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t</td>          <td class="paramname"><span class="paramname"><em>B</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t</td>          <td class="paramname"><span class="paramname"><em>C</em></span><span class="paramdefsep"> = </span><span class="paramdefval">3</span>&#160;) const</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="comment">// Processing of a Digital to Analog Converter (DAC). </span></div>
<div class="line"><span class="comment">// Reconstruct the analog signals based on the discrete quantized digital data from an &quot;nbits&quot; ADC,</span></div>
<div class="line"><span class="comment">// based on the &quot;range&quot; for the analog signal and a bias voltage &quot;Vbias&quot; or array &quot;peds&quot; of pedestal values (see below).</span></div>
<div class="line"><span class="comment">// The digital input signals may be provided by the (optional) TArray &quot;adcs&quot;.</span></div>
<div class="line"><span class="comment">// In case the array &quot;adcs&quot; is not provided, the stored waveform is used to provide the digital input signals.</span></div>
<div class="line"><span class="comment">// The resulting analog values are returned in a TArrayD object, without modification of the original waveform data.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Note : Make sure to use the same units for &quot;range&quot; and &quot;Vbias&quot;.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The number of digital quantization levels is given by N=2^|nbits|, of which the lowest</span></div>
<div class="line"><span class="comment">// level represents the value 0. This implies a range [0,N-1] for the various digital adc values.</span></div>
<div class="line"><span class="comment">// The correspondance of an analog input voltage (Vin) to one of the quantization levels depends on the</span></div>
<div class="line"><span class="comment">// specified &quot;range&quot; and &quot;Vbias&quot; and whether we have a linear or Log DAC (see below).</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// As outlined below, the range of the analog input voltage can be specified as the Full Scale</span></div>
<div class="line"><span class="comment">// voltage range (Vfs) corresponding to adc=N-1 or as the Reference voltage (Vref) corresponding to</span></div>
<div class="line"><span class="comment">// the hypothetical adc=N.</span></div>
<div class="line"><span class="comment">// </span></div>
<div class="line"><span class="comment">// The Least Significant Bit (LSB) represents the smallest analog input voltage interval</span></div>
<div class="line"><span class="comment">// that can reliably be resolved. In other words LSB=Voltage(adc=1)-Voltage(adc=0).</span></div>
<div class="line"><span class="comment">// For a linear DAC we have : LSB=Vfs/(N-1) or equivalently LSB=Vref/N.</span></div>
<div class="line"><span class="comment">// For a Log_B DAC (see below) we have : LSB=Vref*pow(B,-C)*(pow(B,C/N)-1).</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The formulas for the adc-&gt;Vin mapping with Vin=(Vbias+Vsig) are :</span></div>
<div class="line"><span class="comment">// Linear DAC : Vin=adc*LSB.</span></div>
<div class="line"><span class="comment">// Log_B DAC (see below) : Vin=Vref*pow(B,-C)*pow(B,C*adc/N)</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Which implies the following relations between Vref and Vfs : </span></div>
<div class="line"><span class="comment">// Linear DAC : Vref=Vfs+LSB.</span></div>
<div class="line"><span class="comment">// Log_B DAC (see below) : Vfs=Vref*pow(B,-C)*pow(B,C*(N-1)/N).</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The Dynamic Range (DR) is defined as the ratio of the largest and smallest analog voltages</span></div>
<div class="line"><span class="comment">// that can reliably be resolved.</span></div>
<div class="line"><span class="comment">// Expressed in decibel we have : DR=20*log_10(Vfs/LSB) dB.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// For details about the procedure, please refer to the excellent textbook :</span></div>
<div class="line"><span class="comment">// &quot;The Scientist and Engineer&#39;s Guide to Digital Signal Processing&quot; by Steven W. Smith,</span></div>
<div class="line"><span class="comment">// which is online available at http://www.dspguide.com/pdfbook.htm</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// and the publication by Y. Sundarasaradula et al. :</span></div>
<div class="line"><span class="comment">// &quot;A 6-bit, Two-step, Successive Approximation Logarithmic ADC for Biomedical Applications&quot;</span></div>
<div class="line"><span class="comment">// which is online available at https://spiral.imperial.ac.uk/bitstream/10044/1/44156/2/2016_ICECS_LogADC_Camera.pdf.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Input arguments :</span></div>
<div class="line"><span class="comment">// -----------------</span></div>
<div class="line"><span class="comment">// nbits    : Digitial quantization was performed using an nbits ADC.</span></div>
<div class="line"><span class="comment">// range &gt;0 : The full scale voltage range (Vfs) of the analog signal that corresponds to adc=N-1. </span></div>
<div class="line"><span class="comment">//       &lt;0 : |range| is the reference voltage (Vref) of the analog signal that corresponds to the hypothetical adc=N.</span></div>
<div class="line"><span class="comment">// Vbias    : The bias voltage that was added to the analog input signal before digitization.</span></div>
<div class="line"><span class="comment">//            If specified, the resulting analog signals will be corrected for the bias voltage.</span></div>
<div class="line"><span class="comment">//            For a linear DAC the correction via Vbias will only be performed if no pedestal array &quot;peds&quot;</span></div>
<div class="line"><span class="comment">//            is specified (see below). If the array &quot;peds&quot; is specified, Vbias will be ignored for a linear DAC.</span></div>
<div class="line"><span class="comment">//            For a Log DAC the pedestal values will never be used and bias correction may only be obtained via Vbias.</span></div>
<div class="line"><span class="comment">// adcs     : (Optional) array to contain the digital input signals.</span></div>
<div class="line"><span class="comment">// peds     : (Optional) array to contain the pedestal values for the individual digital input signals.</span></div>
<div class="line"><span class="comment">//            The array &quot;peds&quot; must contain (at least) the same number of values as the number of digital input signals.</span></div>
<div class="line"><span class="comment">//            If the array &quot;peds&quot; is specified, the pedestals will be subtracted from the corresponding digital input signals</span></div>
<div class="line"><span class="comment">//            before the conversion to analog signals is performed in case of a linear DAC.</span></div>
<div class="line"><span class="comment">//            For a Log DAC the pedestal values will never be used and bias correction may only be obtained via Vbias.</span></div>
<div class="line"><span class="comment">// B     &gt;1 : Base for a Log DAC (e.g. B=10 emulates a Log_10 DAC).</span></div>
<div class="line"><span class="comment">//       =0 : The DAC will be linear</span></div>
<div class="line"><span class="comment">//       =1 : The DAC will be a Log_e DAC.</span></div>
<div class="line"><span class="comment">// C        : Code efficiency factor that was used for a Log ADC.</span></div>
<div class="line"><span class="comment">//            Rule of thumb : pow(B,-C) is about the smallest signal/|range| ratio that can be resolved.</span></div>
<div class="line"><span class="comment">//            So, for a Log_10 ADC with C=3, the smallest signal that can be resolved is about |range|/1000.</span></div>
<div class="line"><span class="comment">//            Note : It is required that C&gt;0.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Optional output arguments :</span></div>
<div class="line"><span class="comment">// ---------------------------</span></div>
<div class="line"><span class="comment">// hist  : Histogram with the analog result</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Notes :</span></div>
<div class="line"><span class="comment">// -------</span></div>
<div class="line"><span class="comment">// 1) In case no &quot;adcs&quot; array is provided and no waveform is present, just the DAC specs will be printed</span></div>
<div class="line"><span class="comment">//    and in the TArrayD only the adc value corresponding to Vbias is returned.</span></div>
<div class="line"><span class="comment">//    This allows to quickly investigate various scenarios without any data treatment.</span></div>
<div class="line"><span class="comment">//         </span></div>
<div class="line"><span class="comment">// The maximum number of bits that is supported is 60 to guarantee identical functioning</span></div>
<div class="line"><span class="comment">// on all machines.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// In case of inconsistent input parameters, no processing is performed and an empty TArrayD is returned.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The default values are Vbias=0, adcs=0, peds=0, hist=0, B=0 and C=3.</span></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html#l03025">3025</a> of file <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html">NcDSP.cxx</a>.</p>

</div>
</div>
<a id="a8e0119bb2ee8d82d8cf6447f1bb60c9f" name="a8e0119bb2ee8d82d8cf6447f1bb60c9f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e0119bb2ee8d82d8cf6447f1bb60c9f">&#9670;&#160;</a></span>Digitize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TArrayD NcDSP::Digitize </td>
          <td>(</td>
          <td class="paramtype">Int_t</td>          <td class="paramname"><span class="paramname"><em>nbits</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Double_t</td>          <td class="paramname"><span class="paramname"><em>vcal</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t</td>          <td class="paramname"><span class="paramname"><em>mode</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TH1 *</td>          <td class="paramname"><span class="paramname"><em>hist</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Double_t *</td>          <td class="paramname"><span class="paramname"><em>stp</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Double_t *</td>          <td class="paramname"><span class="paramname"><em>scale</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>&#160;) const</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="comment">// **************************************************************************************</span></div>
<div class="line"><span class="comment">// *** This function has become obsolete and is only kept for backward compatibility. ***</span></div>
<div class="line"><span class="comment">// *** Please refer to the new, more flexible memberfunction Transmit().              ***</span></div>
<div class="line"><span class="comment">// *** The user can also invoke the ADC and DAC processors individually by means of   ***</span></div>
<div class="line"><span class="comment">// *** the corresponding memberfunctions ADC() and DAC().                             ***</span></div>
<div class="line"><span class="comment">// **************************************************************************************</span></div>
<div class="line"><span class="comment">// </span></div>
<div class="line"><span class="comment">// Digitize the values of the stored waveform according to an &quot;nbits&quot; ADC.</span></div>
<div class="line"><span class="comment">// The resulting digitized values are returned in a TArrayD object,</span></div>
<div class="line"><span class="comment">// without modification of the original waveform data.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// For details about the procedure, please refer to the excellent textbook :</span></div>
<div class="line"><span class="comment">// &quot;The Scientist and Engineer&#39;s Guide to Digital Signal Processing&quot; by Steven W. Smith,</span></div>
<div class="line"><span class="comment">// which is online available at http://www.dspguide.com/pdfbook.htm</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Input arguments :</span></div>
<div class="line"><span class="comment">// -----------------</span></div>
<div class="line"><span class="comment">// nbits &gt;0 : Digitization of the values will be performed using nbits.</span></div>
<div class="line"><span class="comment">//       &lt;0 : Digitization of the Log10 of the values will be performed using |nbits|.</span></div>
<div class="line"><span class="comment">//            After digitization of the Log10 value, the digitized result (digval) is</span></div>
<div class="line"><span class="comment">//            used to store the corresponding linear value via value=pow(10,digval).</span></div>
<div class="line"><span class="comment">//            So, nbits&lt;0 emulates a Log10 ADC to enhance the dynamic range.</span></div>
<div class="line"><span class="comment">//            Note : When nbits&lt;0 all values to be digitized should be positive.</span></div>
<div class="line"><span class="comment">// vcal     : Range calibration value of the ADC according to &quot;mode&quot; as indicated below.</span></div>
<div class="line"><span class="comment">// mode  =0 : Range for the digitized result (digval) will be set to [0,vcal] (or [vcal,0] if vcal&lt;0).</span></div>
<div class="line"><span class="comment">//        1 : Full scale range for the digitized result (digval) will be set to [-|vcal|,|vcal|].</span></div>
<div class="line"><span class="comment">//        2 : A step size of |vcal| is used providing a digval interval of [0,scale] (or [-scale,0] if vcal&lt;0).</span></div>
<div class="line"><span class="comment">//        3 : A step size of |vcal| is used providing a digval interval of [-scale,scale].</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Optional output arguments :</span></div>
<div class="line"><span class="comment">// ---------------------------</span></div>
<div class="line"><span class="comment">// hist  : Histogram with the digitized result</span></div>
<div class="line"><span class="comment">// stp   : The value of &quot;step size&quot;.</span></div>
<div class="line"><span class="comment">// scale : The value of &quot;scale&quot;.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Notes :</span></div>
<div class="line"><span class="comment">// -------</span></div>
<div class="line"><span class="comment">// 1) The step size corresponds closely to the Least Significant Bit (LSB) precision for the</span></div>
<div class="line"><span class="comment">//    digitized result (digval).</span></div>
<div class="line"><span class="comment">//    For an n-bit ADC we have stepsize=range/(-1+2^n), whereas LSB=1/(2^n).</span></div>
<div class="line"><span class="comment">// 2) In case of a Log10 ADC, the value of &quot;vcal&quot; relates to the Log10 values.</span></div>
<div class="line"><span class="comment">//    So, for a Log10 ADC, the &quot;vcal&quot; interval [-2,2] represents linear values [0.01,100].</span></div>
<div class="line"><span class="comment">//    A step size of 0.0315 for an 8-bit Log10 ADC provides a Log10 interval of [-4,4]</span></div>
<div class="line"><span class="comment">//    for mode=3, which corresponds to a linear value interval of [0.0001,10000].</span></div>
<div class="line"><span class="comment">//    For mode=2 this would result in a Log10 interval of [0,8.0325], which corresponds</span></div>
<div class="line"><span class="comment">//    to a linear value interval of [1,1.0777e8].</span></div>
<div class="line"><span class="comment">//    A step size of 0.01 between the Log10 values corresponds to a multiplication factor</span></div>
<div class="line"><span class="comment">//    of 10^0.01 (i.e. about 1.023) for the linear values at each step. </span></div>
<div class="line"><span class="comment">// 3) In case no waveform is present, just the specs of the specified ADC performance will be printed,</span></div>
<div class="line"><span class="comment">//    but no digitization is performed.</span></div>
<div class="line"><span class="comment">//    This allows to quickly investigate various scenarios without any data treatment.</span></div>
<div class="line"><span class="comment">//         </span></div>
<div class="line"><span class="comment">// The maximum number of bits that is supported is 60 to guarantee identical functioning</span></div>
<div class="line"><span class="comment">// on all machines.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// In case of inconsistent input parameters, no digitization is performed and an empty TArrayD is returned.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The default values are hist=0, stp=0 and scale=0.</span></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html#l02577">2577</a> of file <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html">NcDSP.cxx</a>.</p>

</div>
</div>
<a id="aefcde9f30432748f529637ee3da3a2f1" name="aefcde9f30432748f529637ee3da3a2f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aefcde9f30432748f529637ee3da3a2f1">&#9670;&#160;</a></span>FilterBandPass()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TArrayD NcDSP::FilterBandPass </td>
          <td>(</td>
          <td class="paramtype">Double_t</td>          <td class="paramname"><span class="paramname"><em>f1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Double_t</td>          <td class="paramname"><span class="paramname"><em>f2</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TH1 *</td>          <td class="paramname"><span class="paramname"><em>hisf</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Bool_t</td>          <td class="paramname"><span class="paramname"><em>dB</em></span><span class="paramdefsep"> = </span><span class="paramdefval">kTRUE</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TH1 *</td>          <td class="paramname"><span class="paramname"><em>hist</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t *</td>          <td class="paramname"><span class="paramname"><em>i1</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t *</td>          <td class="paramname"><span class="paramname"><em>i2</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Bool_t</td>          <td class="paramname"><span class="paramname"><em>adaptn</em></span><span class="paramdefsep"> = </span><span class="paramdefval">kTRUE</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="comment">// Perform a Band Pass filter on the loaded input data x[] in the frequency band</span></div>
<div class="line"><span class="comment">// specified by &quot;f1&quot; and &quot;f2&quot; (see below) and a filter kernel consisting of &quot;n&quot; points (see below).</span></div>
<div class="line"><span class="comment">// The time domain result is returned in a TArrayD object and (optionally) in the histogram &quot;hist&quot;,</span></div>
<div class="line"><span class="comment">// whereas the frequency domain result is returned in the (optional) histogram &quot;hisf&quot;.</span></div>
<div class="line"><span class="comment">// The &quot;hisf&quot; amplitudes may be represented in decibel (dB=kTRUE) or linear (dB=kFALSE).</span></div>
<div class="line"><span class="comment">// The original input data x[] are not modified.</span></div>
<div class="line"><span class="comment">// The input data x[] have to be entered as real numbers by one of the Load() member functions.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Note :</span></div>
<div class="line"><span class="comment">// ------</span></div>
<div class="line"><span class="comment">// When the input data x[] contains en even (odd) number of samples, then an odd (even) value of &quot;n&quot;</span></div>
<div class="line"><span class="comment">// will result again in an even (odd) number of samples for the filtered data in the time domain.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The implementation here is based on a combination of Blackman windowed-sinc Low Pass and High Pass filters,</span></div>
<div class="line"><span class="comment">// which is spectrally inverted.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// A Blackman Band Pass filter is an excellent frequency domain filter for passing</span></div>
<div class="line"><span class="comment">// only a certain band of frequencies.</span></div>
<div class="line"><span class="comment">// Large values of &quot;n&quot; will result in sharp transitions at the edges of the pass band,</span></div>
<div class="line"><span class="comment">// but may result in long(er) computation times.</span></div>
<div class="line"><span class="comment">// On the contrary, small values of &quot;n&quot; will result in less sharp transitions at the edges</span></div>
<div class="line"><span class="comment">// of the pass band, but result in short(er) computation times.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Rule of thumb :</span></div>
<div class="line"><span class="comment">// ---------------</span></div>
<div class="line"><span class="comment">// The transition bandwidth (BW) at the edges of the pass band (aka roll-off)</span></div>
<div class="line"><span class="comment">// may be approximated as BW=4/n, where BW is expressed as a fraction of the sampling frequency.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Notes :</span></div>
<div class="line"><span class="comment">// -------</span></div>
<div class="line"><span class="comment">// 1) The returned TArrayD contains the filtered time domain data,</span></div>
<div class="line"><span class="comment">//    which can be directly used as input for subsequent DSP processing.</span></div>
<div class="line"><span class="comment">// 2) Repeated application of this filter will further decrease the amplitudes outside the selected band.</span></div>
<div class="line"><span class="comment">// 3) Actually this filter represents a convolution with a time domain filter kernel</span></div>
<div class="line"><span class="comment">//    that consists of a sinc pulse window of &quot;n&quot; points and an area of 1.</span></div>
<div class="line"><span class="comment">// 4) The performance in the time domain is very poor, since the (inverse) Fourier transform</span></div>
<div class="line"><span class="comment">//    of a frequency domain rectangular pulse filter kernel results in a sinc function.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// For details about the procedure, please refer to the excellent textbook :</span></div>
<div class="line"><span class="comment">// &quot;The Scientist and Engineer&#39;s Guide to Digital Signal Processing&quot; by Steven W. Smith,</span></div>
<div class="line"><span class="comment">// which is online available at http://www.dspguide.com/pdfbook.htm</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Input arguments :</span></div>
<div class="line"><span class="comment">// -----------------</span></div>
<div class="line"><span class="comment">// f1     : The lower bound of the frequency band expressed as a fraction of the sampling frequency</span></div>
<div class="line"><span class="comment">// f2     : The upper bound of the frequency band expressed as a fraction of the sampling frequency</span></div>
<div class="line"><span class="comment">//          For proper functionality one should choose 0&lt;f1&lt;0.5 and 0&lt;f2&lt;0.5, because of the</span></div>
<div class="line"><span class="comment">//          underlying Fourier transform.</span></div>
<div class="line"><span class="comment">// n      : The number of values in the filter kernel</span></div>
<div class="line"><span class="comment">//          For best functionality this must be an odd integer (see adaptn below).</span></div>
<div class="line"><span class="comment">// hisf   : (optional) Histogram with the filtered result (amplitudes) in the frequency domain</span></div>
<div class="line"><span class="comment">// dB     : Amplitudes of &quot;hisf&quot; are represented in decibel (kTRUE) or linear (kFALSE) </span></div>
<div class="line"><span class="comment">// hist   : (optional) Histogram with the filtered result in the time domain</span></div>
<div class="line"><span class="comment">// adaptn : If adaptn=kTRUE an even value of &quot;n&quot; will be increased by 1 to obtain an odd value </span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The (optional) arguments i1 and i2 provide the range [i1,i2] in the</span></div>
<div class="line"><span class="comment">// resulting filtered data array for which the filter kernel was fully immersed</span></div>
<div class="line"><span class="comment">// in the input (signal) data.</span></div>
<div class="line"><span class="comment">// These values i1 and i2 (if requested) are indicated by vertical</span></div>
<div class="line"><span class="comment">// dashed blue lines in the time domain histogram.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The default values are hisf=0, dB=kTRUE, hist=0, i1=0, i2=0 and adaptn=TRUE.</span></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html#l04236">4236</a> of file <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html">NcDSP.cxx</a>.</p>

</div>
</div>
<a id="a9b1b310255c5a22e6c58839cd0dcf9c2" name="a9b1b310255c5a22e6c58839cd0dcf9c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b1b310255c5a22e6c58839cd0dcf9c2">&#9670;&#160;</a></span>FilterBandReject()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TArrayD NcDSP::FilterBandReject </td>
          <td>(</td>
          <td class="paramtype">Double_t</td>          <td class="paramname"><span class="paramname"><em>f1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Double_t</td>          <td class="paramname"><span class="paramname"><em>f2</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TH1 *</td>          <td class="paramname"><span class="paramname"><em>hisf</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Bool_t</td>          <td class="paramname"><span class="paramname"><em>dB</em></span><span class="paramdefsep"> = </span><span class="paramdefval">kTRUE</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TH1 *</td>          <td class="paramname"><span class="paramname"><em>hist</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t *</td>          <td class="paramname"><span class="paramname"><em>i1</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t *</td>          <td class="paramname"><span class="paramname"><em>i2</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Bool_t</td>          <td class="paramname"><span class="paramname"><em>adaptn</em></span><span class="paramdefsep"> = </span><span class="paramdefval">kTRUE</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="comment">// Perform a Band Reject filter on the loaded input data x[] in the frequency band</span></div>
<div class="line"><span class="comment">// specified by &quot;f1&quot; and &quot;f2&quot; (see below) and a filter kernel consisting of &quot;n&quot; points (see below).</span></div>
<div class="line"><span class="comment">// The time domain result is returned in a TArrayD object and (optionally) in the histogram &quot;hist&quot;,</span></div>
<div class="line"><span class="comment">// whereas the frequency domain result is returned in the (optional) histogram &quot;hisf&quot;.</span></div>
<div class="line"><span class="comment">// The &quot;hisf&quot; amplitudes may be represented in decibel (dB=kTRUE) or linear (dB=kFALSE).</span></div>
<div class="line"><span class="comment">// The original input data x[] are not modified.</span></div>
<div class="line"><span class="comment">// The input data x[] have to be entered as real numbers by one of the Load() member functions.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Note :</span></div>
<div class="line"><span class="comment">// ------</span></div>
<div class="line"><span class="comment">// When the input data x[] contains en even (odd) number of samples, then an odd (even) value of &quot;n&quot;</span></div>
<div class="line"><span class="comment">// will result again in an even (odd) number of samples for the filtered data in the time domain.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The implementation here is based on a combination of Blackman windowed-sinc Low Pass and High Pass filters.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// A Blackman Band Reject filter is an excellent frequency domain filter for suppressing</span></div>
<div class="line"><span class="comment">// a certain band of frequencies.</span></div>
<div class="line"><span class="comment">// Large values of &quot;n&quot; will result in sharp transitions at the edges of the rejected band,</span></div>
<div class="line"><span class="comment">// but may result in long(er) computation times.</span></div>
<div class="line"><span class="comment">// On the contrary, small values of &quot;n&quot; will result in less sharp transitions at the edges</span></div>
<div class="line"><span class="comment">// of the rejected band, but result in short(er) computation times.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Rule of thumb :</span></div>
<div class="line"><span class="comment">// ---------------</span></div>
<div class="line"><span class="comment">// The transition bandwidth (BW) at the edges of the rejected band (aka roll-off)</span></div>
<div class="line"><span class="comment">// may be approximated as BW=4/n, where BW is expressed as a fraction of the sampling frequency.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Notes :</span></div>
<div class="line"><span class="comment">// -------</span></div>
<div class="line"><span class="comment">// 1) The returned TArrayD contains the filtered time domain data,</span></div>
<div class="line"><span class="comment">//    which can be directly used as input for subsequent DSP processing.</span></div>
<div class="line"><span class="comment">// 2) Repeated application of this filter will further decrease the amplitudes inside the selected band.</span></div>
<div class="line"><span class="comment">// 3) Actually this filter represents a convolution with a time domain filter kernel</span></div>
<div class="line"><span class="comment">//    that consists of a sinc pulse window of &quot;n&quot; points and an area of 1.</span></div>
<div class="line"><span class="comment">// 4) The performance in the time domain is very poor, since the (inverse) Fourier transform</span></div>
<div class="line"><span class="comment">//    of a frequency domain rectangular pulse filter kernel results in a sinc function.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// For details about the procedure, please refer to the excellent textbook :</span></div>
<div class="line"><span class="comment">// &quot;The Scientist and Engineer&#39;s Guide to Digital Signal Processing&quot; by Steven W. Smith,</span></div>
<div class="line"><span class="comment">// which is online available at http://www.dspguide.com/pdfbook.htm</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Input arguments :</span></div>
<div class="line"><span class="comment">// -----------------</span></div>
<div class="line"><span class="comment">// f1     : The lower bound of the frequency band expressed as a fraction of the sampling frequency</span></div>
<div class="line"><span class="comment">// f2     : The upper bound of the frequency band expressed as a fraction of the sampling frequency</span></div>
<div class="line"><span class="comment">//          For proper functionality one should choose 0&lt;f1&lt;0.5 and 0&lt;f2&lt;0.5, because of the</span></div>
<div class="line"><span class="comment">//          underlying Fourier transform.</span></div>
<div class="line"><span class="comment">// n      : The number of values in the filter kernel</span></div>
<div class="line"><span class="comment">//          For best functionality this must be an odd integer (see adaptn below).</span></div>
<div class="line"><span class="comment">// hisf   : (optional) Histogram with the filtered result (amplitudes) in the frequency domain</span></div>
<div class="line"><span class="comment">// dB     : Amplitudes of &quot;hisf&quot; are represented in decibel (kTRUE) or linear (kFALSE) </span></div>
<div class="line"><span class="comment">// hist   : (optional) Histogram with the filtered result in the time domain</span></div>
<div class="line"><span class="comment">// adaptn : If adaptn=kTRUE an even value of &quot;n&quot; will be increased by 1 to obtain an odd value </span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The (optional) arguments i1 and i2 provide the range [i1,i2] in the</span></div>
<div class="line"><span class="comment">// resulting filtered data array for which the filter kernel was fully immersed</span></div>
<div class="line"><span class="comment">// in the input (signal) data.</span></div>
<div class="line"><span class="comment">// These values i1 and i2 (if requested) are indicated by vertical</span></div>
<div class="line"><span class="comment">// dashed blue lines in the time domain histogram.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The default values are hisf=0, dB=kTRUE, hist=0, i1=0, i2=0 and adaptn=kTRUE.</span></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html#l04385">4385</a> of file <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html">NcDSP.cxx</a>.</p>

</div>
</div>
<a id="a66948496d9a3a99604e3ac4d5761c96e" name="a66948496d9a3a99604e3ac4d5761c96e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a66948496d9a3a99604e3ac4d5761c96e">&#9670;&#160;</a></span>FilterHighPass()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TArrayD NcDSP::FilterHighPass </td>
          <td>(</td>
          <td class="paramtype">Double_t</td>          <td class="paramname"><span class="paramname"><em>fcut</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TH1 *</td>          <td class="paramname"><span class="paramname"><em>hisf</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Bool_t</td>          <td class="paramname"><span class="paramname"><em>dB</em></span><span class="paramdefsep"> = </span><span class="paramdefval">kTRUE</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TH1 *</td>          <td class="paramname"><span class="paramname"><em>hist</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t *</td>          <td class="paramname"><span class="paramname"><em>i1</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t *</td>          <td class="paramname"><span class="paramname"><em>i2</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Bool_t</td>          <td class="paramname"><span class="paramname"><em>adaptn</em></span><span class="paramdefsep"> = </span><span class="paramdefval">kTRUE</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="comment">// Perform a High Pass filter on the loaded input data x[] with a frequency cut-off</span></div>
<div class="line"><span class="comment">// specified by &quot;fcut&quot; (see below) and a filter kernel consisting of &quot;n&quot; points (see below).</span></div>
<div class="line"><span class="comment">// The time domain result is returned in a TArrayD object and (optionally) in the histogram &quot;hist&quot;,</span></div>
<div class="line"><span class="comment">// whereas the frequency domain result is returned in the (optional) histogram &quot;hisf&quot;.</span></div>
<div class="line"><span class="comment">// The &quot;hisf&quot; amplitudes may be represented in decibel (dB=kTRUE) or linear (dB=kFALSE).</span></div>
<div class="line"><span class="comment">// The original input data x[] are not modified.</span></div>
<div class="line"><span class="comment">// The input data x[] have to be entered as real numbers by one of the Load() member functions.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Note :</span></div>
<div class="line"><span class="comment">// ------</span></div>
<div class="line"><span class="comment">// When the input data x[] contains en even (odd) number of samples, then an odd (even) value of &quot;n&quot;</span></div>
<div class="line"><span class="comment">// will result again in an even (odd) number of samples for the filtered data in the time domain.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The implementation here is based on a spectrally inverted Blackman windowed-sinc Low Pass filter.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// A Blackman High Pass filter is an excellent frequency domain filter for seperating</span></div>
<div class="line"><span class="comment">// one band of frequencies from another.</span></div>
<div class="line"><span class="comment">// Large values of &quot;n&quot; will result in a sharp transition between the pass band and the stop band,</span></div>
<div class="line"><span class="comment">// but may result in long(er) computation times.</span></div>
<div class="line"><span class="comment">// On the contrary, small values of &quot;n&quot; will result in a less sharp transition between the</span></div>
<div class="line"><span class="comment">// pass band and the stop band, but result in short(er) computation times.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Rule of thumb :</span></div>
<div class="line"><span class="comment">// ---------------</span></div>
<div class="line"><span class="comment">// The transition bandwidth (BW) between the pass band and the stop band (aka roll-off)</span></div>
<div class="line"><span class="comment">// may be approximated as BW=4/n, where BW is expressed as a fraction of the sampling frequency.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Notes :</span></div>
<div class="line"><span class="comment">// -------</span></div>
<div class="line"><span class="comment">// 1) The returned TArrayD contains the filtered time domain data,</span></div>
<div class="line"><span class="comment">//    which can be directly used as input for subsequent DSP processing.</span></div>
<div class="line"><span class="comment">// 2) Repeated application of this filter will further decrease the amplitudes in the stop band.</span></div>
<div class="line"><span class="comment">// 3) Actually this filter represents a convolution with a time domain filter kernel</span></div>
<div class="line"><span class="comment">//    that consists of a sinc pulse window of &quot;n&quot; points and an area of 1.</span></div>
<div class="line"><span class="comment">// 4) The performance in the time domain is very poor, since the (inverse) Fourier transform</span></div>
<div class="line"><span class="comment">//    of the frequency domain step pulse filter kernel results in a sinc function.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// For details about the procedure, please refer to the excellent textbook :</span></div>
<div class="line"><span class="comment">// &quot;The Scientist and Engineer&#39;s Guide to Digital Signal Processing&quot; by Steven W. Smith,</span></div>
<div class="line"><span class="comment">// which is online available at http://www.dspguide.com/pdfbook.htm</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Input arguments :</span></div>
<div class="line"><span class="comment">// -----------------</span></div>
<div class="line"><span class="comment">// fcut   : The cut-off frequency expressed as a fraction of the sampling frequency</span></div>
<div class="line"><span class="comment">//          For proper functionality one should choose 0&lt;fcut&lt;0.5, because of the</span></div>
<div class="line"><span class="comment">//          underlying Fourier transform.</span></div>
<div class="line"><span class="comment">// n      : The number of values in the filter kernel</span></div>
<div class="line"><span class="comment">//          For best functionality this must be an odd integer (see adaptn below).</span></div>
<div class="line"><span class="comment">// hisf   : (optional) Histogram with the filtered result (amplitudes) in the frequency domain</span></div>
<div class="line"><span class="comment">// dB     : Amplitudes of &quot;hisf&quot; are represented in decibel (kTRUE) or linear (kFALSE) </span></div>
<div class="line"><span class="comment">// hist   : (optional) Histogram with the filtered result in the time domain</span></div>
<div class="line"><span class="comment">// adaptn : If adaptn=kTRUE an even value of &quot;n&quot; will be increased by 1 to obtain an odd value </span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The (optional) arguments i1 and i2 provide the range [i1,i2] in the</span></div>
<div class="line"><span class="comment">// resulting filtered data array for which the filter kernel was fully immersed</span></div>
<div class="line"><span class="comment">// in the input (signal) data.</span></div>
<div class="line"><span class="comment">// These values i1 and i2 (if requested) are indicated by vertical</span></div>
<div class="line"><span class="comment">// dashed blue lines in the time domain histogram.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The default values are hisf=0, dB=kTRUE, hist=0, i1=0, i2=0 and adaptn=kTRUE.</span></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html#l04091">4091</a> of file <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html">NcDSP.cxx</a>.</p>

</div>
</div>
<a id="a24c382cba3b7bc94eedfbfe9c543734a" name="a24c382cba3b7bc94eedfbfe9c543734a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a24c382cba3b7bc94eedfbfe9c543734a">&#9670;&#160;</a></span>FilterLowPass()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TArrayD NcDSP::FilterLowPass </td>
          <td>(</td>
          <td class="paramtype">Double_t</td>          <td class="paramname"><span class="paramname"><em>fcut</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TH1 *</td>          <td class="paramname"><span class="paramname"><em>hisf</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Bool_t</td>          <td class="paramname"><span class="paramname"><em>dB</em></span><span class="paramdefsep"> = </span><span class="paramdefval">kTRUE</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TH1 *</td>          <td class="paramname"><span class="paramname"><em>hist</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t *</td>          <td class="paramname"><span class="paramname"><em>i1</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t *</td>          <td class="paramname"><span class="paramname"><em>i2</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Bool_t</td>          <td class="paramname"><span class="paramname"><em>adaptn</em></span><span class="paramdefsep"> = </span><span class="paramdefval">kTRUE</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="comment">// Perform a Low Pass filter on the loaded input data x[] with a frequency cut-off</span></div>
<div class="line"><span class="comment">// specified by &quot;fcut&quot; (see below) and a filter kernel consisting of &quot;n&quot; points (see below).</span></div>
<div class="line"><span class="comment">// The time domain result is returned in a TArrayD object and (optionally) in the histogram &quot;hist&quot;,</span></div>
<div class="line"><span class="comment">// whereas the frequency domain result is returned in the (optional) histogram &quot;hisf&quot;.</span></div>
<div class="line"><span class="comment">// The &quot;hisf&quot; amplitudes may be represented in decibel (dB=kTRUE) or linear (dB=kFALSE).</span></div>
<div class="line"><span class="comment">// The original input data x[] are not modified.</span></div>
<div class="line"><span class="comment">// The input data x[] have to be entered as real numbers by one of the Load() member functions.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Note :</span></div>
<div class="line"><span class="comment">// ------</span></div>
<div class="line"><span class="comment">// When the input data x[] contains en even (odd) number of samples, then an odd (even) value of &quot;n&quot;</span></div>
<div class="line"><span class="comment">// will result again in an even (odd) number of samples for the filtered data in the time domain.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The implementation here is based on the Blackman windowed-sinc filtering procedure.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// A Blackman Low Pass filter is an excellent frequency domain filter for seperating</span></div>
<div class="line"><span class="comment">// one band of frequencies from another.</span></div>
<div class="line"><span class="comment">// Large values of &quot;n&quot; will result in a sharp transition between the pass band and the stop band,</span></div>
<div class="line"><span class="comment">// but may result in long(er) computation times.</span></div>
<div class="line"><span class="comment">// On the contrary, small values of &quot;n&quot; will result in a less sharp transition between the</span></div>
<div class="line"><span class="comment">// pass band and the stop band, but result in short(er) computation times.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Rule of thumb :</span></div>
<div class="line"><span class="comment">// ---------------</span></div>
<div class="line"><span class="comment">// The transition bandwidth (BW) between the pass band and the stop band (aka roll-off)</span></div>
<div class="line"><span class="comment">// may be approximated as BW=4/n, where BW is expressed as a fraction of the sampling frequency.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Notes :</span></div>
<div class="line"><span class="comment">// -------</span></div>
<div class="line"><span class="comment">// 1) The returned TArrayD contains the filtered time domain data,</span></div>
<div class="line"><span class="comment">//    which can be directly used as input for subsequent DSP processing.</span></div>
<div class="line"><span class="comment">// 2) Repeated application of this filter will further decrease the amplitudes in the stop band.</span></div>
<div class="line"><span class="comment">// 3) Actually this filter represents a convolution with a time domain filter kernel</span></div>
<div class="line"><span class="comment">//    that consists of a sinc pulse window of &quot;n&quot; points and an area of 1.</span></div>
<div class="line"><span class="comment">// 4) The performance in the time domain is very poor, since the (inverse) Fourier transform</span></div>
<div class="line"><span class="comment">//    of the frequency domain step pulse filter kernel results in a sinc function.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// For details about the procedure, please refer to the excellent textbook :</span></div>
<div class="line"><span class="comment">// &quot;The Scientist and Engineer&#39;s Guide to Digital Signal Processing&quot; by Steven W. Smith,</span></div>
<div class="line"><span class="comment">// which is online available at http://www.dspguide.com/pdfbook.htm</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Input arguments :</span></div>
<div class="line"><span class="comment">// -----------------</span></div>
<div class="line"><span class="comment">// fcut   : The cut-off frequency expressed as a fraction of the sampling frequency</span></div>
<div class="line"><span class="comment">//          For proper functionality one should choose 0&lt;fcut&lt;0.5, because of the</span></div>
<div class="line"><span class="comment">//          underlying Fourier transform.</span></div>
<div class="line"><span class="comment">// n      : The number of values in the filter kernel</span></div>
<div class="line"><span class="comment">//          For best functionality this must be an odd integer (see adaptn below)</span></div>
<div class="line"><span class="comment">// hisf   : (optional) Histogram with the filtered result (amplitudes) in the frequency domain</span></div>
<div class="line"><span class="comment">// dB     : Amplitudes of &quot;hisf&quot; are represented in decibel (kTRUE) or linear (kFALSE) </span></div>
<div class="line"><span class="comment">// hist   : (optional) Histogram with the filtered result in the time domain</span></div>
<div class="line"><span class="comment">// adaptn : If adaptn=kTRUE an even value of &quot;n&quot; will be increased by 1 to obtain an odd value </span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The (optional) arguments i1 and i2 provide the range [i1,i2] in the</span></div>
<div class="line"><span class="comment">// resulting filtered data array for which the filter kernel was fully immersed</span></div>
<div class="line"><span class="comment">// in the input (signal) data.</span></div>
<div class="line"><span class="comment">// These values i1 and i2 (if requested) are indicated by vertical</span></div>
<div class="line"><span class="comment">// dashed blue lines in the time domain histogram.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The default values are hisf=0, dB-kTRUE, hist=0, i1=0, i2=0 and adaptn=kTRUE.</span></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html#l03946">3946</a> of file <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html">NcDSP.cxx</a>.</p>

</div>
</div>
<a id="a8bbb9fd73ba629c831f41538c639c978" name="a8bbb9fd73ba629c831f41538c639c978"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8bbb9fd73ba629c831f41538c639c978">&#9670;&#160;</a></span>FilterMovingAverage()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TArrayD NcDSP::FilterMovingAverage </td>
          <td>(</td>
          <td class="paramtype">Int_t</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TString</td>          <td class="paramname"><span class="paramname"><em>mode</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TH1 *</td>          <td class="paramname"><span class="paramname"><em>hist</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t *</td>          <td class="paramname"><span class="paramname"><em>i1</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t *</td>          <td class="paramname"><span class="paramname"><em>i2</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TH1 *</td>          <td class="paramname"><span class="paramname"><em>hisf</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Bool_t</td>          <td class="paramname"><span class="paramname"><em>dB</em></span><span class="paramdefsep"> = </span><span class="paramdefval">kTRUE</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="comment">// Perform a Moving Average filter on the loaded input data x[] with averaging over &quot;n&quot; samples.</span></div>
<div class="line"><span class="comment">// The time domain result is returned in a TArrayD object and (optionally) in the histogram &quot;hist&quot;.</span></div>
<div class="line"><span class="comment">// The frequency domain result is returned in the (optional) histogram &quot;hisf&quot;, for which</span></div>
<div class="line"><span class="comment">// the amplitudes may be represented in decibel (dB=kTRUE) or linear (dB=kFALSE).</span></div>
<div class="line"><span class="comment">// The original input data x[] are not modified.</span></div>
<div class="line"><span class="comment">// The input data x[] have to be entered as real numbers by one of the Load() member functions.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// A Moving Average filter is the optimal time domain filter for reducing random (noise) fluctuations,</span></div>
<div class="line"><span class="comment">// while retaining sharp step responses.</span></div>
<div class="line"><span class="comment">// Large values of &quot;n&quot; will result in a large noise reduction, but the edges of the steps</span></div>
<div class="line"><span class="comment">// become less sharp.</span></div>
<div class="line"><span class="comment">// On the contrary, small values of &quot;n&quot; will result in sharp step edges, but less noise reduction.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Rule of thumb :</span></div>
<div class="line"><span class="comment">// ---------------</span></div>
<div class="line"><span class="comment">// The noise is reduced by a factor of sqrt(n) and the rise or fall of an edge</span></div>
<div class="line"><span class="comment">// is smeared over &quot;n&quot; samples.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// This filter may be invoked in two different modes, namely Recursion or Convolution.</span></div>
<div class="line"><span class="comment">// The resulting time domain data are equivalent, but are contained in TArrayD objects</span></div>
<div class="line"><span class="comment">// of different length, as outlined below..</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The Recursion mode :</span></div>
<div class="line"><span class="comment">// --------------------</span></div>
<div class="line"><span class="comment">// The straightforward procedure is expressed as :</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//    y[i]=(1/n)*Sum(j=0,n-1){x[i+j]}  (1)</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// To reduce rounding errors and computational speed, the following recursion relation is used :</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//    y[k]=y[k-1]-(x[k-1]/n)+(x[k+n-1]/n)  (2)</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// whereby the first term y[0] is calulated via equation (1).</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// In case the number of elements of x[] is m, the number of elements of y[] will &quot;only&quot; be (m-n+1),</span></div>
<div class="line"><span class="comment">// such that the last element of y[] still has been completely computed from all corresponding &quot;n&quot; values of x[].</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The Convolution mode :</span></div>
<div class="line"><span class="comment">// ----------------------</span></div>
<div class="line"><span class="comment">// Based on the above, this filter actually represents a convolution with a filter kernel</span></div>
<div class="line"><span class="comment">// that consists of a rectangular pulse of &quot;n&quot; points of height 1/n (i.e. an area of 1).</span></div>
<div class="line"><span class="comment">// In this respect we can regard this filtering as a convolution y[]=x[]*h[] where h[]</span></div>
<div class="line"><span class="comment">// represents the &quot;n&quot; point rectangular pulse filter kernel.</span></div>
<div class="line"><span class="comment">// In this mode, an array x[] with m elements, will result in an array y[] of (m+n-1) elements.</span></div>
<div class="line"><span class="comment">// For further details see the documentation of Convolve().</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// For details about the procedure, please refer to the excellent textbook :</span></div>
<div class="line"><span class="comment">// &quot;The Scientist and Engineer&#39;s Guide to Digital Signal Processing&quot; by Steven W. Smith,</span></div>
<div class="line"><span class="comment">// which is online available at http://www.dspguide.com/pdfbook.htm</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Input arguments :</span></div>
<div class="line"><span class="comment">// -----------------</span></div>
<div class="line"><span class="comment">// n    : The number of samples that will be averaged over</span></div>
<div class="line"><span class="comment">// mode : To invoke Recursion (mode=&quot;rec&quot;) or Convolution (mode=&quot;conv&quot;) processing.</span></div>
<div class="line"><span class="comment">// hist : (optional) Histogram with the filtered result in the time domain</span></div>
<div class="line"><span class="comment">// i1   : Optional argument (see below)</span></div>
<div class="line"><span class="comment">// i2   : Optional argument (see below)</span></div>
<div class="line"><span class="comment">// hisf : (optional) Histogram with the filtered result (amplitudes) in the frequency domain</span></div>
<div class="line"><span class="comment">// dB   : Amplitudes of &quot;hisf&quot; are represented in decibel (kTRUE) or linear (kFALSE) </span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The (optional) arguments i1 and i2 provide the range [i1,i2] in the</span></div>
<div class="line"><span class="comment">// resulting filtered data array for which the filter kernel was fully immersed</span></div>
<div class="line"><span class="comment">// in the input (signal) data x[].</span></div>
<div class="line"><span class="comment">// In other words : The indices range [i1,i2] in the resulting filtered data array y[]</span></div>
<div class="line"><span class="comment">// corresponds to all the y[] elements for which the averaging was completely performed</span></div>
<div class="line"><span class="comment">// over all &quot;n&quot; samples.</span></div>
<div class="line"><span class="comment">// So, values of y[j] with j&lt;i1 or j&gt;i2 contain incomplete summations, and as such should not</span></div>
<div class="line"><span class="comment">// be considered as reliable, especially when x[] contains large variations.</span></div>
<div class="line"><span class="comment">// For an absolute comparison between the x[] and y[] values, one should realize that </span></div>
<div class="line"><span class="comment">// the array sizes of x[] and y[] are different and that x[k] should be compared with y[k+i1].</span></div>
<div class="line"><span class="comment">// The values i1 and i2 (if requested) are indicated by vertical dashed blue lines</span></div>
<div class="line"><span class="comment">// in the time domain histogram.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Notes :</span></div>
<div class="line"><span class="comment">// -------</span></div>
<div class="line"><span class="comment">// 1) The returned TArrayD contains the filtered time domain data,</span></div>
<div class="line"><span class="comment">//    which can be directly used as input for subsequent DSP processing.</span></div>
<div class="line"><span class="comment">// 2) The performance in the frequency domain is very poor, since the Fourier transform</span></div>
<div class="line"><span class="comment">//    of the time domain rectangular pulse filter kernel results in a sinc function.</span></div>
<div class="line"><span class="comment">// 3) A Bayesian Block analysis (see the class NcBlocks) in general provides</span></div>
<div class="line"><span class="comment">//    even better results by allowing &quot;n&quot; to vary dynamically based on the data pattern.</span></div>
<div class="line"><span class="comment">//    However, the computation time involved for a Bayesian Block analysis</span></div>
<div class="line"><span class="comment">//    is vastly larger than for a Moving Average filter.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The default values are hist=0, i1=0 i2=0, hisf=0 and dB=kTRUE.</span></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html#l03698">3698</a> of file <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html">NcDSP.cxx</a>.</p>

</div>
</div>
<a id="a0ae44f29a31ddda09119ef82d49acee9" name="a0ae44f29a31ddda09119ef82d49acee9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ae44f29a31ddda09119ef82d49acee9">&#9670;&#160;</a></span>FilterMultiBand()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TArrayD NcDSP::FilterMultiBand </td>
          <td>(</td>
          <td class="paramtype">TArray &amp;</td>          <td class="paramname"><span class="paramname"><em>freqs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TH1 *</td>          <td class="paramname"><span class="paramname"><em>hisf</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Bool_t</td>          <td class="paramname"><span class="paramname"><em>dB</em></span><span class="paramdefsep"> = </span><span class="paramdefval">kTRUE</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TH1 *</td>          <td class="paramname"><span class="paramname"><em>hist</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t *</td>          <td class="paramname"><span class="paramname"><em>i1</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t *</td>          <td class="paramname"><span class="paramname"><em>i2</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Bool_t</td>          <td class="paramname"><span class="paramname"><em>adaptn</em></span><span class="paramdefsep"> = </span><span class="paramdefval">kTRUE</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="comment">// Perform a MultiBand filter on the loaded input data x[] in various frequency bands as</span></div>
<div class="line"><span class="comment">// specified by the array &quot;freqs&quot; (see below) and filter kernels consisting of &quot;n&quot; points (see below).</span></div>
<div class="line"><span class="comment">// The time domain result is returned in a TArrayD object and (optionally) in the histogram &quot;hist&quot;,</span></div>
<div class="line"><span class="comment">// whereas the frequency domain result is returned in the (optional) histogram &quot;hisf&quot;.</span></div>
<div class="line"><span class="comment">// The &quot;hisf&quot; amplitudes may be represented in decibel (dB=kTRUE) or linear (dB=kFALSE).</span></div>
<div class="line"><span class="comment">// The original input data x[] are not modified.</span></div>
<div class="line"><span class="comment">// The input data x[] have to be entered as real numbers by one of the Load() member functions.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Note :</span></div>
<div class="line"><span class="comment">// ------</span></div>
<div class="line"><span class="comment">// When the input data x[] contains en even (odd) number of samples, then an odd (even) value of &quot;n&quot;</span></div>
<div class="line"><span class="comment">// will result again in an even (odd) number of samples for the filtered data in the time domain.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The procedure is based on a convolution of the various provided Blackman</span></div>
<div class="line"><span class="comment">// single Low Pass and/or High Pass and/or Band Pass and/or Band Reject filters.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Large values of &quot;n&quot; will result in sharp transitions at the edges of the specified bands,</span></div>
<div class="line"><span class="comment">// but may result in long(er) computation times.</span></div>
<div class="line"><span class="comment">// On the contrary, small values of &quot;n&quot; will result in less sharp transitions at the edges</span></div>
<div class="line"><span class="comment">// of the specified bands, but result in short(er) computation times.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Rule of thumb :</span></div>
<div class="line"><span class="comment">// ---------------</span></div>
<div class="line"><span class="comment">// The transition bandwidth (BW) at the edges of the specified bands (aka roll-off)</span></div>
<div class="line"><span class="comment">// may be approximated as BW=4/n, where BW is expressed as a fraction of the sampling frequency.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Notes :</span></div>
<div class="line"><span class="comment">// -------</span></div>
<div class="line"><span class="comment">// 1) The size of the TArrayD &quot;freqs&quot; should match exactly twice the number of</span></div>
<div class="line"><span class="comment">//    frequency bands to be specified (see below).</span></div>
<div class="line"><span class="comment">// 2) The returned TArrayD contains the filtered time domain data,</span></div>
<div class="line"><span class="comment">//    which can be directly used as input for subsequent DSP processing.</span></div>
<div class="line"><span class="comment">// 3) Specifying the same frequency band more than once will further suppress the unwanted frequencies. </span></div>
<div class="line"><span class="comment">// 4) The performance in the time domain is very poor, since the (inverse) Fourier transform</span></div>
<div class="line"><span class="comment">//    of a frequency domain rectangular pulse filter kernel results in a sinc function.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// For details about the procedure, please refer to the excellent textbook :</span></div>
<div class="line"><span class="comment">// &quot;The Scientist and Engineer&#39;s Guide to Digital Signal Processing&quot; by Steven W. Smith,</span></div>
<div class="line"><span class="comment">// which is online available at http://www.dspguide.com/pdfbook.htm</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Input arguments :</span></div>
<div class="line"><span class="comment">// -----------------</span></div>
<div class="line"><span class="comment">// freqs  : Array containing the lower and upper bounds of the frequency bands expressed as</span></div>
<div class="line"><span class="comment">//          fractions of the sampling frequency.</span></div>
<div class="line"><span class="comment">//          The array elements represent the various pairs [flow,fup] to define the frequency bands,</span></div>
<div class="line"><span class="comment">//          ordered as (f1low,f1up,f2low,f2up,...).</span></div>
<div class="line"><span class="comment">//          The following conventions are used :</span></div>
<div class="line"><span class="comment">//          flow&gt;0 and fup&gt;0 --&gt; Apply a Band Pass filter over [flow,fup]</span></div>
<div class="line"><span class="comment">//          flow&lt;0 and fup&lt;0 --&gt; Apply a Band Reject filter over [|flow|,|fup|]</span></div>
<div class="line"><span class="comment">//          flow&lt;0 and fup&gt;0 --&gt; Apply a Low Pass filter with fcut=fup</span></div>
<div class="line"><span class="comment">//          flow&gt;0 and fup&lt;0 --&gt; Apply a High Pass filter with fcut=flow</span></div>
<div class="line"><span class="comment">// n      : The number of values in the corresponding filter kernels</span></div>
<div class="line"><span class="comment">//          For best functionality this must be an odd integer (see adaptn below).</span></div>
<div class="line"><span class="comment">// hisf   : (optional) Histogram with the filtered result (amplitudes) in the frequency domain</span></div>
<div class="line"><span class="comment">// dB     : Amplitudes of &quot;hisf&quot; are represented in decibel (kTRUE) or linear (kFALSE) </span></div>
<div class="line"><span class="comment">// hist   : (optional) Histogram with the filtered result in the time domain</span></div>
<div class="line"><span class="comment">// adaptn : If adaptn=kTRUE an even value of &quot;n&quot; will be increased by 1 to obtain an odd value </span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The (optional) arguments i1 and i2 provide the range [i1,i2] in the</span></div>
<div class="line"><span class="comment">// resulting filtered data array for which the filter kernel was fully immersed</span></div>
<div class="line"><span class="comment">// in the input (signal) data.</span></div>
<div class="line"><span class="comment">// These values i1 and i2 (if requested) are indicated by vertical</span></div>
<div class="line"><span class="comment">// dashed blue lines in the time domain histogram.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The default values are hisf=0, dB=kTRUE, hist=0, i1=0, i2=0 and adaptn=kTRUE.</span></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html#l04533">4533</a> of file <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html">NcDSP.cxx</a>.</p>

</div>
</div>
<a id="a62d6ef8baf2426d10c55e5e8786315c3" name="a62d6ef8baf2426d10c55e5e8786315c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62d6ef8baf2426d10c55e5e8786315c3">&#9670;&#160;</a></span>Fourier()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NcDSP::Fourier </td>
          <td>(</td>
          <td class="paramtype">TString</td>          <td class="paramname"><span class="paramname"><em>mode</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TH1 *</td>          <td class="paramname"><span class="paramname"><em>hist</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TString</td>          <td class="paramname"><span class="paramname"><em>sel</em></span><span class="paramdefsep"> = </span><span class="paramdefval">&quot;none&quot;</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="comment">// Perform a normalized 1-dimensional Discrete Fourier Transformation (DFT).</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Conventions :</span></div>
<div class="line"><span class="comment">// -------------</span></div>
<div class="line"><span class="comment">// N = The number of data elements</span></div>
<div class="line"><span class="comment">// Time domain array : X[]=X[0],...,X[N-1]</span></div>
<div class="line"><span class="comment">// Frequency domain array : Q[]=Q[0],...,Q[N-1]</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Fourier transform : Q[k]=(1/sqrt(N))*sum(n=0,n=N-1){X[n]*exp(-i*2pi*(k/N)*n)}</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Inverse Fourier transform : X[n]=(1/sqrt(N))*sum(k=0,k=N-1){Q[k]*exp(i*2pi*(n/N)*k)}</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Input arguments :</span></div>
<div class="line"><span class="comment">// -----------------</span></div>
<div class="line"><span class="comment">// mode : &quot;R2C&quot;  --&gt; Perform a real-input to complex-output discrete Fourier transformation</span></div>
<div class="line"><span class="comment">//        &quot;C2R&quot;  --&gt; Perform the inverse transformation of &quot;R2C&quot;</span></div>
<div class="line"><span class="comment">//        &quot;C2C&quot;  --&gt; Perform a complex-input to complex-output discrete Fourier transformation</span></div>
<div class="line"><span class="comment">//        &quot;C2CI&quot; --&gt; Perform the inverse of &quot;C2C&quot;</span></div>
<div class="line"><span class="comment">// hist : (optional) Histogram with selected results</span></div>
<div class="line"><span class="comment">// sel  : String to specify the contents and representation of the result histogram</span></div>
<div class="line"><span class="comment">//        &quot;RE&quot;   --&gt; Y-axis shows the values of the real (re) components</span></div>
<div class="line"><span class="comment">//        &quot;IM&quot;   --&gt; Y-axis shows the values of the imaginary (im) components</span></div>
<div class="line"><span class="comment">//        &quot;AMP&quot;  --&gt; Y-axis shows the values of the amplitudes, i.e. sqrt(re*re+im*im)</span></div>
<div class="line"><span class="comment">//        &quot;dB&quot;   --&gt; Y-axis shows the values of the amplitudes, i.e. sqrt(re*re+im*im), in decibel</span></div>
<div class="line"><span class="comment">//        &quot;PHIR&quot; --&gt; Y-axis shows the values of the phases, i.e. arctan(im/re), in radians</span></div>
<div class="line"><span class="comment">//        &quot;PHID&quot; --&gt; Y-axis shows the values of the phases, i.e. arctan(im/re), in degrees</span></div>
<div class="line"><span class="comment">//        &quot;CPHI&quot; --&gt; Y-axis shows the values of cos(phase), i.e. cos(arctan(im/re))</span></div>
<div class="line"><span class="comment">//        &quot;SPHI&quot; --&gt; Y-axis shows the values of sin(phase), i.e. sin(arctan(im/re))</span></div>
<div class="line"><span class="comment">//        &quot;k&quot;    --&gt; X-axis represents the index k in the frequency domain  </span></div>
<div class="line"><span class="comment">//        &quot;f&quot;    --&gt; X-axis represents the fraction f of the sampling rate in the frequency domain</span></div>
<div class="line"><span class="comment">//        &quot;Hz&quot;   --&gt; X-axis represents the actual frequency in Hz in the frequency domain</span></div>
<div class="line"><span class="comment">//        &quot;n&quot;    --&gt; X-axis represents the index n in the time domain  </span></div>
<div class="line"><span class="comment">//        &quot;t&quot;    --&gt; X-axis represents the actual time in seconds in the time domain</span></div>
<div class="line"><span class="comment">//        &quot;2&quot;    --&gt; X-axis spans the full number of data points, instead of the usual (N/2)+1</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Note : The options &quot;Hz&quot; and &quot;t&quot; can only be used if the actual data acquisition sampling rate</span></div>
<div class="line"><span class="comment">//        has been provided via the Load() memberfunction.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Examples :</span></div>
<div class="line"><span class="comment">// ----------</span></div>
<div class="line"><span class="comment">// sel=&quot;AMP f&quot;  will show the (N/2)+1 amplitudes as a function of the fractional sampling rate.</span></div>
<div class="line"><span class="comment">// sel=&quot;dB f&quot;   will show the (N/2)+1 amplitudes in dB as a function of the fractional sampling rate.</span></div>
<div class="line"><span class="comment">// sel=&quot;RE k 2&quot; will show all N real components as a function of the index k in the frequency domain.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Note : If only the X-axis variable is specified, the Y-axis will show &quot;RE&quot; in the corresponding domain.</span></div>
<div class="line"><span class="comment">// So, sel=&quot;t&quot; is equivalent to sel=&quot;RE t&quot; etc... </span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The default values are hist=0 and sel=&quot;none&quot;.</span></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html#l01092">1092</a> of file <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html">NcDSP.cxx</a>.</p>

</div>
</div>
<a id="af82b12df8da7719258c97bdab1337701" name="af82b12df8da7719258c97bdab1337701"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af82b12df8da7719258c97bdab1337701">&#9670;&#160;</a></span>GetBandPassKernel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TArrayD NcDSP::GetBandPassKernel </td>
          <td>(</td>
          <td class="paramtype">Double_t</td>          <td class="paramname"><span class="paramname"><em>f1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Double_t</td>          <td class="paramname"><span class="paramname"><em>f2</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TH1 *</td>          <td class="paramname"><span class="paramname"><em>hisf</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Bool_t</td>          <td class="paramname"><span class="paramname"><em>dB</em></span><span class="paramdefsep"> = </span><span class="paramdefval">kTRUE</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TH1 *</td>          <td class="paramname"><span class="paramname"><em>hist</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Bool_t</td>          <td class="paramname"><span class="paramname"><em>adaptn</em></span><span class="paramdefsep"> = </span><span class="paramdefval">kTRUE</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="comment">// Provide via the returned TArrayD an n-point time domain Band Pass Filter kernel</span></div>
<div class="line"><span class="comment">// for the frequency band [f1,f2] expressed as fractions of the sampling frequency.</span></div>
<div class="line"><span class="comment">// The optional argument &quot;hisf&quot; may be used to obtain a histogram of the kernel</span></div>
<div class="line"><span class="comment">// in the frequency domain with the amplitude in decibel (dB=kTRUE) or linear (dB=kFALSE).</span></div>
<div class="line"><span class="comment">// The optional argument &quot;hist&quot; may be used to obtain a (zero padded) histogram of the time domain kernel.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The implementation here is based on a combination of Blackman windowed-sinc Low Pass and High Pass filters,</span></div>
<div class="line"><span class="comment">// which is spectrally inverted.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// A Blackman Band Pass filter is an excellent frequency domain filter for passing</span></div>
<div class="line"><span class="comment">// only a certain band of frequencies.</span></div>
<div class="line"><span class="comment">// Large values of &quot;n&quot; will result in sharp transitions at the edges of the pass band,</span></div>
<div class="line"><span class="comment">// but may result in long(er) computation times.</span></div>
<div class="line"><span class="comment">// On the contrary, small values of &quot;n&quot; will result in less sharp transitions at the edges</span></div>
<div class="line"><span class="comment">// of the pass band, but result in short(er) computation times.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Rule of thumb :</span></div>
<div class="line"><span class="comment">// ---------------</span></div>
<div class="line"><span class="comment">// The transition bandwidth (BW) at the edges of the pass band (aka roll-off)</span></div>
<div class="line"><span class="comment">// may be approximated as BW=4/n, where BW is expressed as a fraction of the sampling frequency.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Notes :</span></div>
<div class="line"><span class="comment">// -------</span></div>
<div class="line"><span class="comment">// 1) Repeated application of this filter will further decrease the amplitudes outside the selected band.</span></div>
<div class="line"><span class="comment">// 2) Actually this filter kernel consists of a time domain sinc pulse window of &quot;n&quot; points</span></div>
<div class="line"><span class="comment">//    and an area of 1.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// For details about the procedure, please refer to the excellent textbook :</span></div>
<div class="line"><span class="comment">// &quot;The Scientist and Engineer&#39;s Guide to Digital Signal Processing&quot; by Steven W. Smith,</span></div>
<div class="line"><span class="comment">// which is online available at http://www.dspguide.com/pdfbook.htm</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Input arguments :</span></div>
<div class="line"><span class="comment">// -----------------</span></div>
<div class="line"><span class="comment">// f1     : The lower bound of the frequency band expressed as a fraction of the sampling frequency</span></div>
<div class="line"><span class="comment">// f2     : The upper bound of the frequency band expressed as a fraction of the sampling frequency</span></div>
<div class="line"><span class="comment">//          For proper functionality one should choose 0&lt;f1&lt;0.5 and 0&lt;f2&lt;0.5, because of the</span></div>
<div class="line"><span class="comment">//          underlying Fourier transform.</span></div>
<div class="line"><span class="comment">// n      : The number of values in the filter kernel</span></div>
<div class="line"><span class="comment">//          For best functionality this must be an odd integer (see adaptn below).</span></div>
<div class="line"><span class="comment">// hisf   : (optional) Histogram with the filter kernel (amplitudes) in the frequency domain</span></div>
<div class="line"><span class="comment">// dB     : Amplitudes of &quot;hisf&quot; are represented in decibel (kTRUE) or linear (kFALSE) </span></div>
<div class="line"><span class="comment">// hist   : (optional) Histogram with the filter kernel in the time domain</span></div>
<div class="line"><span class="comment">// adaptn : If adaptn=kTRUE an even value of &quot;n&quot; will be increased by 1 to obtain an odd value </span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The default values are hisf=0, dB=kTRUE, hist=0 and adaptn=kTRUE.</span></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html#l05030">5030</a> of file <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html">NcDSP.cxx</a>.</p>

</div>
</div>
<a id="a69555899fb115f18c44c3d0103e38e45" name="a69555899fb115f18c44c3d0103e38e45"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a69555899fb115f18c44c3d0103e38e45">&#9670;&#160;</a></span>GetBandRejectKernel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TArrayD NcDSP::GetBandRejectKernel </td>
          <td>(</td>
          <td class="paramtype">Double_t</td>          <td class="paramname"><span class="paramname"><em>f1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Double_t</td>          <td class="paramname"><span class="paramname"><em>f2</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TH1 *</td>          <td class="paramname"><span class="paramname"><em>hisf</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Bool_t</td>          <td class="paramname"><span class="paramname"><em>dB</em></span><span class="paramdefsep"> = </span><span class="paramdefval">kTRUE</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TH1 *</td>          <td class="paramname"><span class="paramname"><em>hist</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Bool_t</td>          <td class="paramname"><span class="paramname"><em>adaptn</em></span><span class="paramdefsep"> = </span><span class="paramdefval">kTRUE</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="comment">// Provide via the returned TArrayD an n-point time domain Band Reject Filter kernel</span></div>
<div class="line"><span class="comment">// for the frequency band [f1,f2] expressed as fractions of the sampling frequency.</span></div>
<div class="line"><span class="comment">// The optional argument &quot;hisf&quot; may be used to obtain a histogram of the kernel</span></div>
<div class="line"><span class="comment">// in the frequency domain with the amplitude in decibel (dB=kTRUE) or linear (dB=kFALSE).</span></div>
<div class="line"><span class="comment">// The optional argument &quot;hist&quot; may be used to obtain a (zero padded) histogram of the time domain kernel.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The implementation here is based on a combination of Blackman windowed-sinc Low Pass and High Pass filters.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// A Blackman Band Reject filter is an excellent frequency domain filter for suppressing</span></div>
<div class="line"><span class="comment">// a certain band of frequencies.</span></div>
<div class="line"><span class="comment">// Large values of &quot;n&quot; will result in sharp transitions at the edges of the rejected band,</span></div>
<div class="line"><span class="comment">// but may result in long(er) computation times.</span></div>
<div class="line"><span class="comment">// On the contrary, small values of &quot;n&quot; will result in less sharp transitions at the edges</span></div>
<div class="line"><span class="comment">// of the rejected band, but result in short(er) computation times.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Rule of thumb :</span></div>
<div class="line"><span class="comment">// ---------------</span></div>
<div class="line"><span class="comment">// The transition bandwidth (BW) at the edges of the rejected band (aka roll-off)</span></div>
<div class="line"><span class="comment">// may be approximated as BW=4/n, where BW is expressed as a fraction of the sampling frequency.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Notes :</span></div>
<div class="line"><span class="comment">// -------</span></div>
<div class="line"><span class="comment">// 1) Repeated application of this filter will further decrease the amplitudes inside the selected band.</span></div>
<div class="line"><span class="comment">// 2) Actually this filter kernel consists of a time domain sinc pulse window of &quot;n&quot; points</span></div>
<div class="line"><span class="comment">//    and an area of 1.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// For details about the procedure, please refer to the excellent textbook :</span></div>
<div class="line"><span class="comment">// &quot;The Scientist and Engineer&#39;s Guide to Digital Signal Processing&quot; by Steven W. Smith,</span></div>
<div class="line"><span class="comment">// which is online available at http://www.dspguide.com/pdfbook.htm</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Input arguments :</span></div>
<div class="line"><span class="comment">// -----------------</span></div>
<div class="line"><span class="comment">// f1     : The lower bound of the frequency band expressed as a fraction of the sampling frequency</span></div>
<div class="line"><span class="comment">// f2     : The upper bound of the frequency band expressed as a fraction of the sampling frequency</span></div>
<div class="line"><span class="comment">//          For proper functionality one should choose 0&lt;f1&lt;0.5 and 0&lt;f2&lt;0.5, because of the</span></div>
<div class="line"><span class="comment">//          underlying Fourier transform.</span></div>
<div class="line"><span class="comment">// n      : The number of values in the filter kernel</span></div>
<div class="line"><span class="comment">//          For best functionality this must be an odd integer.</span></div>
<div class="line"><span class="comment">// hisf   : (optional) Histogram with the filter kernel (amplitudes) in the frequency domain</span></div>
<div class="line"><span class="comment">// dB     : Amplitudes of &quot;hisf&quot; are represented in decibel (kTRUE) or linear (kFALSE) </span></div>
<div class="line"><span class="comment">// hist   : (optional) Histogram with the filter kernel in the time domain</span></div>
<div class="line"><span class="comment">// adaptn : If adaptn=kTRUE an even value of &quot;n&quot; will be increased by 1 to obtain an odd value </span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The default values are hisf=0, dB=kTRUE, hist=0 and adaptn=kTRUE.</span></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html#l05153">5153</a> of file <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html">NcDSP.cxx</a>.</p>

</div>
</div>
<a id="a8d672ab3cb4298ed53214d1147e03f35" name="a8d672ab3cb4298ed53214d1147e03f35"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d672ab3cb4298ed53214d1147e03f35">&#9670;&#160;</a></span>GetData()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TArrayD NcDSP::GetData </td>
          <td>(</td>
          <td class="paramtype">TString</td>          <td class="paramname"><span class="paramname"><em>mode</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="comment">// Provide a selected set of data.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Input argument :</span></div>
<div class="line"><span class="comment">// ----------------</span></div>
<div class="line"><span class="comment">// sel  : String to specify the contents of the provided data array</span></div>
<div class="line"><span class="comment">//        &quot;RE&quot;   --&gt; The values of the real (re) components</span></div>
<div class="line"><span class="comment">//        &quot;IM&quot;   --&gt; The values of the imaginary (im) components</span></div>
<div class="line"><span class="comment">//        &quot;AMP&quot;  --&gt; The amplitudes, i.e. sqrt(re*re+im*im)</span></div>
<div class="line"><span class="comment">//        &quot;PHIR&quot; --&gt; The phases, i.e. arctan(im/re), in radians</span></div>
<div class="line"><span class="comment">//        &quot;PHID&quot; --&gt; The phases, i.e. arctan(im/re), in degrees</span></div>
<div class="line"><span class="comment">//        &quot;in&quot;   --&gt; The values of the input data are provided</span></div>
<div class="line"><span class="comment">//        &quot;out&quot;  --&gt; The values of the output data are provided</span></div>
<div class="line"><span class="comment">//        &quot;Hist&quot; --&gt; The contents of the selected transformation histogram (if any) are provided.</span></div>
<div class="line"><span class="comment">//        &quot;Wave&quot; --&gt; The values of the stored (system response) waveform data are provided</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Examples :</span></div>
<div class="line"><span class="comment">// ----------</span></div>
<div class="line"><span class="comment">// sel=&quot;AMP out&quot; will provide all the N amplitudes of the resulting data after transformation.</span></div>
<div class="line"><span class="comment">// sel=&quot;RE in&quot; will provide all the N real components of the input data.</span></div>
<div class="line"><span class="comment">// sel=&quot;Wave&quot; will provide all the amplitudes of the stored (system response) waveform</span></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html#l01028">1028</a> of file <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html">NcDSP.cxx</a>.</p>

</div>
</div>
<a id="a8829a4cbc8de99cf6d442a1b784c875b" name="a8829a4cbc8de99cf6d442a1b784c875b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8829a4cbc8de99cf6d442a1b784c875b">&#9670;&#160;</a></span>GetHighPassKernel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TArrayD NcDSP::GetHighPassKernel </td>
          <td>(</td>
          <td class="paramtype">Double_t</td>          <td class="paramname"><span class="paramname"><em>fcut</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TH1 *</td>          <td class="paramname"><span class="paramname"><em>hisf</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Bool_t</td>          <td class="paramname"><span class="paramname"><em>dB</em></span><span class="paramdefsep"> = </span><span class="paramdefval">kTRUE</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TH1 *</td>          <td class="paramname"><span class="paramname"><em>hist</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Bool_t</td>          <td class="paramname"><span class="paramname"><em>adaptn</em></span><span class="paramdefsep"> = </span><span class="paramdefval">kTRUE</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="comment">// Provide via the returned TArrayD an n-point time domain High Pass Filter kernel</span></div>
<div class="line"><span class="comment">// with cut-off frequency &quot;fcut&quot; expressed as a fraction of the sampling frequency.</span></div>
<div class="line"><span class="comment">// The optional argument &quot;hisf&quot; may be used to obtain a histogram of the kernel</span></div>
<div class="line"><span class="comment">// in the frequency domain with the amplitude in decibel (dB=kTRUE) or linear (dB=kFALSE).</span></div>
<div class="line"><span class="comment">// The optional argument &quot;hist&quot; may be used to obtain a (zero padded) histogram of the time domain kernel.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The implementation here is based on a spectrally inverted Blackman windowed-sinc Low Pass filter.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// A Blackman High Pass filter is an excellent frequency domain filter for seperating</span></div>
<div class="line"><span class="comment">// one band of frequencies from another.</span></div>
<div class="line"><span class="comment">// Large values of &quot;n&quot; will result in a sharp transition between the pass band and the stop band,</span></div>
<div class="line"><span class="comment">// but may result in long(er) computation times.</span></div>
<div class="line"><span class="comment">// On the contrary, small values of &quot;n&quot; will result in a less sharp transition between the</span></div>
<div class="line"><span class="comment">// pass band and the stop band, but result in short(er) computation times.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Rule of thumb :</span></div>
<div class="line"><span class="comment">// ---------------</span></div>
<div class="line"><span class="comment">// The transition bandwidth (BW) between the pass band and the stop band (aka roll-off)</span></div>
<div class="line"><span class="comment">// may be approximated as BW=4/n, where BW is expressed as a fraction of the sampling frequency.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Notes :</span></div>
<div class="line"><span class="comment">// -------</span></div>
<div class="line"><span class="comment">// 1) Repeated application of this filter will further decrease the amplitudes in the stop band.</span></div>
<div class="line"><span class="comment">// 2) Actually this filter kernel consists of a time domain sinc pulse window of &quot;n&quot; points</span></div>
<div class="line"><span class="comment">//    and an area of 1.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// For details about the procedure, please refer to the excellent textbook :</span></div>
<div class="line"><span class="comment">// &quot;The Scientist and Engineer&#39;s Guide to Digital Signal Processing&quot; by Steven W. Smith,</span></div>
<div class="line"><span class="comment">// which is online available at http://www.dspguide.com/pdfbook.htm</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Input arguments :</span></div>
<div class="line"><span class="comment">// -----------------</span></div>
<div class="line"><span class="comment">// fcut   : The cut-off frequency expressed as a fraction of the sampling frequency</span></div>
<div class="line"><span class="comment">//          For proper functionality one should choose 0&lt;fcut&lt;0.5, because of the</span></div>
<div class="line"><span class="comment">//          underlying Fourier transform.</span></div>
<div class="line"><span class="comment">// n      : The number of values in the filter kernel</span></div>
<div class="line"><span class="comment">//          For best functionality this must be an odd integer (see adaptn below).</span></div>
<div class="line"><span class="comment">// hisf   : (optional) Histogram with the filter kernel (amplitudes) in the frequency domain</span></div>
<div class="line"><span class="comment">// dB     : Amplitudes of &quot;hisf&quot; are represented in decibel (kTRUE) or linear (kFALSE) </span></div>
<div class="line"><span class="comment">// hist   : (optional) Histogram with the filter kernel in the time domain</span></div>
<div class="line"><span class="comment">// adaptn : If adaptn=kTRUE an even value of &quot;n&quot; will be increased by 1 to obtain an odd value </span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The default values are hisf=0, dB=kTRUE, hist=0 and adaptn=kTRUE.</span></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html#l04911">4911</a> of file <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html">NcDSP.cxx</a>.</p>

</div>
</div>
<a id="aacd75a5e0c6ff58406ed592ee34c5af9" name="aacd75a5e0c6ff58406ed592ee34c5af9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aacd75a5e0c6ff58406ed592ee34c5af9">&#9670;&#160;</a></span>GetLowPassKernel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TArrayD NcDSP::GetLowPassKernel </td>
          <td>(</td>
          <td class="paramtype">Double_t</td>          <td class="paramname"><span class="paramname"><em>fcut</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TH1 *</td>          <td class="paramname"><span class="paramname"><em>hisf</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Bool_t</td>          <td class="paramname"><span class="paramname"><em>dB</em></span><span class="paramdefsep"> = </span><span class="paramdefval">kTRUE</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TH1 *</td>          <td class="paramname"><span class="paramname"><em>hist</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Bool_t</td>          <td class="paramname"><span class="paramname"><em>adaptn</em></span><span class="paramdefsep"> = </span><span class="paramdefval">kTRUE</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="comment">// Provide via the returned TArrayD an n-point time domain Low Pass Filter kernel</span></div>
<div class="line"><span class="comment">// with cut-off frequency &quot;fcut&quot; expressed as a fraction of the sampling frequency.</span></div>
<div class="line"><span class="comment">// The optional argument &quot;hisf&quot; may be used to obtain a histogram of the kernel</span></div>
<div class="line"><span class="comment">// in the frequency domain with the amplitude in decibel (dB=kTRUE) or linear (dB=kFALSE).</span></div>
<div class="line"><span class="comment">// The optional argument &quot;hist&quot; may be used to obtain a (zero padded) histogram of the time domain kernel.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The implementation here is based on the Blackman windowed-sinc filtering procedure.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// A Blackman Low Pass filter is an excellent frequency domain filter for seperating</span></div>
<div class="line"><span class="comment">// one band of frequencies from another.</span></div>
<div class="line"><span class="comment">// Large values of &quot;n&quot; will result in a sharp transition between the pass band and the stop band,</span></div>
<div class="line"><span class="comment">// but may result in long(er) computation times.</span></div>
<div class="line"><span class="comment">// On the contrary, small values of &quot;n&quot; will result in a less sharp transition between the</span></div>
<div class="line"><span class="comment">// pass band and the stop band, but result in short(er) computation times.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Rule of thumb :</span></div>
<div class="line"><span class="comment">// ---------------</span></div>
<div class="line"><span class="comment">// The transition bandwidth (BW) between the pass band and the stop band (aka roll-off)</span></div>
<div class="line"><span class="comment">// may be approximated as BW=4/n, where BW is expressed as a fraction of the sampling frequency.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Notes :</span></div>
<div class="line"><span class="comment">// -------</span></div>
<div class="line"><span class="comment">// 1) Repeated application of this filter will further decrease the amplitudes in the stop band.</span></div>
<div class="line"><span class="comment">// 2) Actually this filter kernel consists of a time domain sinc pulse window of &quot;n&quot; points</span></div>
<div class="line"><span class="comment">//    and an area of 1.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// For details about the procedure, please refer to the excellent textbook :</span></div>
<div class="line"><span class="comment">// &quot;The Scientist and Engineer&#39;s Guide to Digital Signal Processing&quot; by Steven W. Smith,</span></div>
<div class="line"><span class="comment">// which is online available at http://www.dspguide.com/pdfbook.htm</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Input arguments :</span></div>
<div class="line"><span class="comment">// -----------------</span></div>
<div class="line"><span class="comment">// fcut   : The cut-off frequency expressed as a fraction of the sampling frequency</span></div>
<div class="line"><span class="comment">//          For proper functionality one should choose 0&lt;fcut&lt;0.5, because of the</span></div>
<div class="line"><span class="comment">//          underlying Fourier transform.</span></div>
<div class="line"><span class="comment">// n      : The number of values in the filter kernel</span></div>
<div class="line"><span class="comment">//          For best functionality this must be an odd integer (see adaptn below)</span></div>
<div class="line"><span class="comment">// hisf   : (optional) Histogram with the filter kernel (amplitudes) in the frequency domain</span></div>
<div class="line"><span class="comment">// dB     : Amplitudes of &quot;hisf&quot; are represented in decibel (kTRUE) or linear (kFALSE) </span></div>
<div class="line"><span class="comment">// hist   : (optional) Histogram with the filter kernel in the time domain</span></div>
<div class="line"><span class="comment">// adaptn : If adaptn=kTRUE an even value of &quot;n&quot; will be increased by 1 to obtain an odd value </span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The default values are hisf=0, dB=kTRUE, hist=0 and adaptn=kTRUE.</span></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html#l04776">4776</a> of file <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html">NcDSP.cxx</a>.</p>

</div>
</div>
<a id="ab403e51f2b327b1edd31a16eb0f1e625" name="ab403e51f2b327b1edd31a16eb0f1e625"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab403e51f2b327b1edd31a16eb0f1e625">&#9670;&#160;</a></span>GetMovingAverageKernel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TArrayD NcDSP::GetMovingAverageKernel </td>
          <td>(</td>
          <td class="paramtype">Int_t</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TH1 *</td>          <td class="paramname"><span class="paramname"><em>hisf</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Bool_t</td>          <td class="paramname"><span class="paramname"><em>dB</em></span><span class="paramdefsep"> = </span><span class="paramdefval">kTRUE</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TH1 *</td>          <td class="paramname"><span class="paramname"><em>hist</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="comment">// Provide via the returned TArrayD an n-point time domain Moving Average Filter kernel.</span></div>
<div class="line"><span class="comment">// The optional argument &quot;hisf&quot; may be used to obtain a histogram of the frequency domain kernel</span></div>
<div class="line"><span class="comment">// with the amplitude in decibel (dB=kTRUE) or linear (dB=kFALSE).</span></div>
<div class="line"><span class="comment">// The optional argument &quot;hist&quot; may be used to obtain a (zero padded) histogram of the time domain kernel.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// A Moving Average filter is the optimal time domain filter for reducing random (noise) fluctuations,</span></div>
<div class="line"><span class="comment">// while retaining sharp step responses.</span></div>
<div class="line"><span class="comment">// Large values of &quot;n&quot; will result in a large noise reduction, but the edges of the steps</span></div>
<div class="line"><span class="comment">// become less sharp.</span></div>
<div class="line"><span class="comment">// On the contrary, small values of &quot;n&quot; will result in sharp step edges, but less noise reduction.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Rule of thumb :</span></div>
<div class="line"><span class="comment">// ---------------</span></div>
<div class="line"><span class="comment">// The noise is reduced by a factor of sqrt(n) and the rise or fall of an edge</span></div>
<div class="line"><span class="comment">// is smeared over &quot;n&quot; samples.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Notes :</span></div>
<div class="line"><span class="comment">// -------</span></div>
<div class="line"><span class="comment">// 1) Actually this filter kernel consists of a time domain rectangular pulse of &quot;n&quot; points</span></div>
<div class="line"><span class="comment">//    and an area of 1.</span></div>
<div class="line"><span class="comment">// 2) The performance in the frequency domain is very poor, since the Fourier transform</span></div>
<div class="line"><span class="comment">//    of the time domain rectangular pulse filter kernel results in a sinc function.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// For details about the procedure, please refer to the excellent textbook :</span></div>
<div class="line"><span class="comment">// &quot;The Scientist and Engineer&#39;s Guide to Digital Signal Processing&quot; by Steven W. Smith,</span></div>
<div class="line"><span class="comment">// which is online available at http://www.dspguide.com/pdfbook.htm</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Input arguments :</span></div>
<div class="line"><span class="comment">// -----------------</span></div>
<div class="line"><span class="comment">// n    : The number of samples that will be averaged over</span></div>
<div class="line"><span class="comment">// hisf : (optional) Histogram with the filter kernel (amplitudes) in the frequency domain</span></div>
<div class="line"><span class="comment">// dB   : Amplitudes of &quot;hisf&quot; are represented in decibel (kTRUE) or linear (kFALSE) </span></div>
<div class="line"><span class="comment">// hist : (optional) Histogram with the filter kernel in the time domain</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The default values are hisf=0, dB=kTRUE and hist=0.</span></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html#l04688">4688</a> of file <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html">NcDSP.cxx</a>.</p>

</div>
</div>
<a id="a3fb8f355038b2a8e3a3cbea599e38a0c" name="a3fb8f355038b2a8e3a3cbea599e38a0c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3fb8f355038b2a8e3a3cbea599e38a0c">&#9670;&#160;</a></span>GetMultiBandKernel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TArrayD NcDSP::GetMultiBandKernel </td>
          <td>(</td>
          <td class="paramtype">TArray &amp;</td>          <td class="paramname"><span class="paramname"><em>freqs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TH1 *</td>          <td class="paramname"><span class="paramname"><em>hisf</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Bool_t</td>          <td class="paramname"><span class="paramname"><em>dB</em></span><span class="paramdefsep"> = </span><span class="paramdefval">kTRUE</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TH1 *</td>          <td class="paramname"><span class="paramname"><em>hist</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Bool_t</td>          <td class="paramname"><span class="paramname"><em>adaptn</em></span><span class="paramdefsep"> = </span><span class="paramdefval">kTRUE</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="comment">// Provide via the returned TArrayD a time domain Multi Band Filter kernel in various frequency bands</span></div>
<div class="line"><span class="comment">// specified by the array &quot;freqs&quot; (see below) and filter kernels consisting of &quot;n&quot; points each (see below).</span></div>
<div class="line"><span class="comment">// The optional argument &quot;hisf&quot; may be used to obtain a histogram of the kernel</span></div>
<div class="line"><span class="comment">// in the frequency domain with the amplitude in decibel (dB=kTRUE) or linear (dB=kFALSE).</span></div>
<div class="line"><span class="comment">// The optional argument &quot;hist&quot; may be used to obtain a (zero padded) histogram of the time domain kernel.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The procedure is based on a convolution of the various provided Blackman</span></div>
<div class="line"><span class="comment">// single Low Pass and/or High Pass and/or Band Pass and/or Band Reject filters.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Large values of &quot;n&quot; will result in sharp transitions at the edges of the specified bands,</span></div>
<div class="line"><span class="comment">// but may result in long(er) computation times.</span></div>
<div class="line"><span class="comment">// On the contrary, small values of &quot;n&quot; will result in less sharp transitions at the edges</span></div>
<div class="line"><span class="comment">// of the specified bands, but result in short(er) computation times.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Rule of thumb :</span></div>
<div class="line"><span class="comment">// ---------------</span></div>
<div class="line"><span class="comment">// The transition bandwidth (BW) at the edges of the specified bands (aka roll-off)</span></div>
<div class="line"><span class="comment">// may be approximated as BW=4/n, where BW is expressed as a fraction of the sampling frequency.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Notes :</span></div>
<div class="line"><span class="comment">// -------</span></div>
<div class="line"><span class="comment">// 1) The size of the TArrayD &quot;freqs&quot; should match exactly twice the number of</span></div>
<div class="line"><span class="comment">//    frequency bands to be specified (see below).</span></div>
<div class="line"><span class="comment">// 2) Specifying the same frequency band more than once will further suppress the unwanted frequencies. </span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// For details about the procedure, please refer to the excellent textbook :</span></div>
<div class="line"><span class="comment">// &quot;The Scientist and Engineer&#39;s Guide to Digital Signal Processing&quot; by Steven W. Smith,</span></div>
<div class="line"><span class="comment">// which is online available at http://www.dspguide.com/pdfbook.htm</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Input arguments :</span></div>
<div class="line"><span class="comment">// -----------------</span></div>
<div class="line"><span class="comment">// freqs  : Array containing the lower and upper bounds of the frequency bands expressed as</span></div>
<div class="line"><span class="comment">//          fractions of the sampling frequency.</span></div>
<div class="line"><span class="comment">//          The array elements represent the various pairs [flow,fup] to define the frequency bands,</span></div>
<div class="line"><span class="comment">//          ordered as (f1low,f1up,f2low,f2up,...).</span></div>
<div class="line"><span class="comment">//          The following conventions are used :</span></div>
<div class="line"><span class="comment">//          flow&gt;0 and fup&gt;0 --&gt; Apply a Band Pass filter over [flow,fup]</span></div>
<div class="line"><span class="comment">//          flow&lt;0 and fup&lt;0 --&gt; Apply a Band Reject filter over [|flow|,|fup|]</span></div>
<div class="line"><span class="comment">//          flow&lt;0 and fup&gt;0 --&gt; Apply a Low Pass filter with fcut=fup</span></div>
<div class="line"><span class="comment">//          flow&gt;0 and fup&lt;0 --&gt; Apply a High Pass filter with fcut=flow</span></div>
<div class="line"><span class="comment">//          In case flow=0 or fup=0 the pair [flow,fup] is neglected.</span></div>
<div class="line"><span class="comment">// n      : The number of points in the corresponding filter kernels</span></div>
<div class="line"><span class="comment">//          For best functionality this must be an odd integer (see adaptn below)</span></div>
<div class="line"><span class="comment">// hisf   : (optional) Histogram with the filter kernel (amplitudes) in the frequency domain</span></div>
<div class="line"><span class="comment">// dB     : Amplitudes of &quot;hisf&quot; are represented in decibel (kTRUE) or linear (kFALSE) </span></div>
<div class="line"><span class="comment">// hist   : (optional) Histogram with the filter kernel in the time domain</span></div>
<div class="line"><span class="comment">// adaptn : If adaptn=kTRUE an even value of &quot;n&quot; will be increased by 1 to obtain an odd value </span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The default values are hisf=0, dB=kTRUE, hist=0 and adaptn=kTRUE.</span></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html#l05278">5278</a> of file <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html">NcDSP.cxx</a>.</p>

</div>
</div>
<a id="a09897f6df6a8ba077a86b24714400aaf" name="a09897f6df6a8ba077a86b24714400aaf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09897f6df6a8ba077a86b24714400aaf">&#9670;&#160;</a></span>GetN()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Int_t NcDSP::GetN </td>
          <td>(</td>
          <td class="paramtype">Int_t</td>          <td class="paramname"><span class="paramname"><em>mode</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="comment">// Provide the number of data elements (to be) processed.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// mode : 0 --&gt; Provide the number of input data elements entered via Load()</span></div>
<div class="line"><span class="comment">//        1 --&gt; Provide the number of input data elements entered via SetWaveform()</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The default value is mode=0 for backward compatibility.</span></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html#l01008">1008</a> of file <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html">NcDSP.cxx</a>.</p>

</div>
</div>
<a id="acb599c179a7c300ddd455fc53c9ebd54" name="acb599c179a7c300ddd455fc53c9ebd54"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb599c179a7c300ddd455fc53c9ebd54">&#9670;&#160;</a></span>GetSamplingFrequency()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Float_t NcDSP::GetSamplingFrequency </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="comment">// Provide the current value of the DAQ sampling frequency in Hz.</span></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html#l00384">384</a> of file <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html">NcDSP.cxx</a>.</p>

</div>
</div>
<a id="a8c2608c32bb15409daef231f43648e1a" name="a8c2608c32bb15409daef231f43648e1a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c2608c32bb15409daef231f43648e1a">&#9670;&#160;</a></span>Hartley()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NcDSP::Hartley </td>
          <td>(</td>
          <td class="paramtype">Int_t</td>          <td class="paramname"><span class="paramname"><em>mode</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TH1 *</td>          <td class="paramname"><span class="paramname"><em>hist</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TString</td>          <td class="paramname"><span class="paramname"><em>sel</em></span><span class="paramdefsep"> = </span><span class="paramdefval">&quot;none&quot;</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="comment">// Perform a normalized 1-dimensional Discrete Hartley Transformation (DHT).</span></div>
<div class="line"><span class="comment">// Actually, a DHT is closely related to a Discrete Fourier Transformation (DFT)</span></div>
<div class="line"><span class="comment">// with only real input values.</span></div>
<div class="line"><span class="comment">// Consequently, the resulting transformed array is also only real.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Indicating in the frequency domain the DHT data elements by H[k] and the </span></div>
<div class="line"><span class="comment">// DFT data elements by F[k], we have the following relations :</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// 1) Re(F[k])=(H[k]+H[N-k])/2 and Im(F[k])=(H[N-k]-H[k])/2</span></div>
<div class="line"><span class="comment">// 2) H[k]=Re((1+i)*F[k])</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Conventions :</span></div>
<div class="line"><span class="comment">// -------------</span></div>
<div class="line"><span class="comment">// N = The number of data elements</span></div>
<div class="line"><span class="comment">// Time domain array : X[]=X[0],...,X[N-1]</span></div>
<div class="line"><span class="comment">// Frequency domain array : Q[]=Q[0],...,Q[N-1]</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Hartley transform : Q[k]=(1/sqrt(N))*sum(n=0,n=N-1){X[n]*[cos(2pi*(k/N)*n)+sin(2pi*(k/N)*n)]}</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Inverse Hartley transform : X[n]=(1/sqrt(N))*sum(n=0,k=N-1){Q[k]*[cos(2pi*(n/N)*k)+sin(2pi*(n/N)*k)]}</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// So, it is seen that the Hartley transform is its own inverse.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Input arguments :</span></div>
<div class="line"><span class="comment">// -----------------</span></div>
<div class="line"><span class="comment">// mode : &gt;0     --&gt; Perform the forward X[n]-&gt;Q[k] Hartley transformation</span></div>
<div class="line"><span class="comment">//        &lt;0     --&gt; Perform the backward Q[k]-&gt;X[n] Hartley transformation</span></div>
<div class="line"><span class="comment">// hist : (optional) Histogram with selected results</span></div>
<div class="line"><span class="comment">// sel  : String to specify the representation of the result histogram</span></div>
<div class="line"><span class="comment">//        &quot;k&quot;    --&gt; X-axis represents the index k in the frequency domain  </span></div>
<div class="line"><span class="comment">//        &quot;f&quot;    --&gt; X-axis represents the fraction f of the sampling rate in the frequency domain</span></div>
<div class="line"><span class="comment">//        &quot;Hz&quot;   --&gt; X-axis represents the actual frequency in Hz in the frequency domain</span></div>
<div class="line"><span class="comment">//        &quot;n&quot;    --&gt; X-axis represents the index n in the time domain  </span></div>
<div class="line"><span class="comment">//        &quot;t&quot;    --&gt; X-axis represents the actual time in seconds in the time domain</span></div>
<div class="line"><span class="comment">//        &quot;2&quot;    --&gt; X-axis spans the full number of data points, instead of the usual (N/2)+1</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Note : The options &quot;Hz&quot; and &quot;t&quot; can only be used if the actual data acquisition sampling rate</span></div>
<div class="line"><span class="comment">//        has been provided via the Load() memberfunction.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Examples :</span></div>
<div class="line"><span class="comment">// ----------</span></div>
<div class="line"><span class="comment">// sel=&quot;f&quot; will show the (N/2)+1 amplitudes as a function of the fractional sampling rate in the frequency domain.</span></div>
<div class="line"><span class="comment">// sel=&quot;k 2&quot; will show all N amplitudes as a function of the index k in the frequency domain.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The default values are hist=0 and sel=&quot;none&quot;</span></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html#l01240">1240</a> of file <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html">NcDSP.cxx</a>.</p>

</div>
</div>
<a id="a5e9923feba6dd30ff1de67d849cdf678" name="a5e9923feba6dd30ff1de67d849cdf678"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e9923feba6dd30ff1de67d849cdf678">&#9670;&#160;</a></span>Hilbert()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NcDSP::Hilbert </td>
          <td>(</td>
          <td class="paramtype">Int_t</td>          <td class="paramname"><span class="paramname"><em>mode</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TH1 *</td>          <td class="paramname"><span class="paramname"><em>hist</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TString</td>          <td class="paramname"><span class="paramname"><em>sel</em></span><span class="paramdefsep"> = </span><span class="paramdefval">&quot;none&quot;</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="comment">// Perform a 1-dimensional Discrete Hilbert Transformation (DHIT).</span></div>
<div class="line"><span class="comment">// Actually, a DHIT is closely related to a Discrete Fourier Transformation (DFT)</span></div>
<div class="line"><span class="comment">// with only real input values, followed by a phase shift and inverse DFT.</span></div>
<div class="line"><span class="comment">// Consequently, the transformation results in a time domain array of only real values.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Practical application :</span></div>
<div class="line"><span class="comment">// -----------------------</span></div>
<div class="line"><span class="comment">// Since the time domain input consists only of real values, the input signal can</span></div>
<div class="line"><span class="comment">// be fully described by cos() terms only.</span></div>
<div class="line"><span class="comment">// Consider in the time domain the following time series (x) that results from</span></div>
<div class="line"><span class="comment">// a carrier wave that is modulated both in amplitude (A) and phase (P) :</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//             x(t)=A(t)cos(P(t))</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The Hilbert transformation allows to extract A(t) and P(t) from the time series x(t)</span></div>
<div class="line"><span class="comment">// via the so called complex analytic signal Z[] as outlined below.</span></div>
<div class="line"><span class="comment">// The values of A(t) provide the so-called the Hilbert envelope, and will always by positive or 0.</span></div>
<div class="line"><span class="comment">// The instantaneous angular frequency omega(t) is obtained via omega(t)=dP(t)/dt, whereas</span></div>
<div class="line"><span class="comment">// the values of cos(P(t)) provide the so-called Temporal Fine Structure (TFS).</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Conventions :</span></div>
<div class="line"><span class="comment">// -------------</span></div>
<div class="line"><span class="comment">// N = The number of data elements</span></div>
<div class="line"><span class="comment">// Time domain input array .............................. : X[]=X[0],...,X[N-1]</span></div>
<div class="line"><span class="comment">// Fourier transform array DFT(X) in the frequency domain : Q[]=Q[0],...,Q[N-1]</span></div>
<div class="line"><span class="comment">// Hilbert transform array DHIT(X) in the time domain ... : HT[]=HT[0],...,HT[N-1]</span></div>
<div class="line"><span class="comment">// Analytic signal array in the time domain ............. : Z[]=Z[0],...,Z[N-1]</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// In this memberfunction, the Hilbert transformation action is executed in the frequency domain,</span></div>
<div class="line"><span class="comment">// after which the time domain result HT[] is obtained via an inverse Fourier transformation.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Indicating in the frequency domain the (intermediate) DHIT data elements by H[k],</span></div>
<div class="line"><span class="comment">// we have the following relations :</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// H[k] = -i*Q[k] for positive frequencies (which in our convention corresponds to 1&lt;=k&lt;=N/2)</span></div>
<div class="line"><span class="comment">//         0      for frequency 0          (which in our convention corresponds to k=0)</span></div>
<div class="line"><span class="comment">//         i*Q[k] for negative frequencies (which in our convention corresponds to k&gt;N/2)</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// In other words : If Q[k] is represented as Q[k]=a+b*i then we have :</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// H[k] =  b-a*i for positive frequencies</span></div>
<div class="line"><span class="comment">//         0     for frequency 0</span></div>
<div class="line"><span class="comment">//        -b+a*i for negative frequencies</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// From this we obtain via an inverse DFT on H[k] the Hilbert transform HT[n] in the time domain.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The instantaneous amplitude A(t) and phase P(t) can be obtained via the so-called analytic signal Z(t) :</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Z[n]=X[n]+i*HT[n] which can be represented as Z[n]=c+d*i</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// where A[n]=|Z[n]|=sqrt(c*c+d*d) and P[n]=arctan(d/c).</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Inverse transformation :</span></div>
<div class="line"><span class="comment">// ------------------------</span></div>
<div class="line"><span class="comment">// From the above procedure it is seen that DHIT(HT[])=-X[], which is used to perform the inverse transformation HT[]-&gt;X[].</span></div>
<div class="line"><span class="comment">// For the result of the inverse transformation HT[]-&gt;X[] we keep the definition Z[n]=X[n]+i*HT[n], which allows</span></div>
<div class="line"><span class="comment">// to also extract the instantaneous amplitude A(t) and phase P(t) from the inverse transformation result. </span></div>
<div class="line"><span class="comment">// The inverse Hilbert transformation has been implemented for completeness, but in practice this will not be used often.</span></div>
<div class="line"><span class="comment">// </span></div>
<div class="line"><span class="comment">// Input arguments :</span></div>
<div class="line"><span class="comment">// -----------------</span></div>
<div class="line"><span class="comment">// mode : &gt;0      --&gt; Perform the forward X[n]-&gt;Z[n] Hilbert transformation</span></div>
<div class="line"><span class="comment">//        &lt;0      --&gt; Perform the backward HT[n]-&gt;X[n] Hilbert transformation</span></div>
<div class="line"><span class="comment">// hist : (optional)  Histogram with selected results</span></div>
<div class="line"><span class="comment">// sel  : String to specify the representation of the result histogram</span></div>
<div class="line"><span class="comment">//        &quot;X&quot;     --&gt; Y-axis shows the values of the real X[] components</span></div>
<div class="line"><span class="comment">//        &quot;HT&quot;    --&gt; Y-axis shows the values of the real HT[] components</span></div>
<div class="line"><span class="comment">//        &quot;AMP&quot;   --&gt; Y-axis shows the values of the amplitudes, i.e. sqrt(re*re+im*im)</span></div>
<div class="line"><span class="comment">//        &quot;dB&quot;    --&gt; Y-axis shows the values of the amplitudes, i.e. sqrt(re*re+im*im), in decibel</span></div>
<div class="line"><span class="comment">//        &quot;PHIR&quot;  --&gt; Y-axis shows the values of the phases, i.e. arctan(im/re), in radians</span></div>
<div class="line"><span class="comment">//        &quot;PHID&quot;  --&gt; Y-axis shows the values of the phases, i.e. arctan(im/re), in degrees</span></div>
<div class="line"><span class="comment">//        &quot;CPHI&quot;  --&gt; Y axis shows the values of cos(phase), i.e. cos(arctan(im/re))</span></div>
<div class="line"><span class="comment">//                    This is also called the Temporal Fine Structure (TFS).   </span></div>
<div class="line"><span class="comment">//        &quot;OMEGA&quot; --&gt; Y axis shows the values of angular frequency in rad/sec, i.e. d(arctan(im/re))/dt</span></div>
<div class="line"><span class="comment">//        &quot;n&quot;     --&gt; X-axis represents the index n in the time domain  </span></div>
<div class="line"><span class="comment">//        &quot;t&quot;     --&gt; X-axis represents the actual time in seconds in the time domain</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Note : The option &quot;t&quot; can only be used if the actual data acquisition sampling rate</span></div>
<div class="line"><span class="comment">//        has been provided via the Load() memberfunction.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Examples :</span></div>
<div class="line"><span class="comment">// ----------</span></div>
<div class="line"><span class="comment">// sel=&quot;AMP t&quot; will show the amplitudes as a function of the actual time in seconds.</span></div>
<div class="line"><span class="comment">// sel=&quot;PHID n&quot; will show the phases in degrees as a function of the index n in the time domain.</span></div>
<div class="line"><span class="comment">// sel=&quot;HT n&quot; will show the values of HT[] as a function of the index n in the time domain.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Note :</span></div>
<div class="line"><span class="comment">// ------</span></div>
<div class="line"><span class="comment">// sel=&quot;t&quot; for the forward transformation is equivalent to sel=&quot;HT t&quot;</span></div>
<div class="line"><span class="comment">// sel=&quot;t&quot; for the inverse transformation is equivalent to sel=&quot;X t&quot;</span></div>
<div class="line"><span class="comment">// sel=&quot;n&quot; for the forward transformation is equivalent to sel=&quot;HT n&quot;</span></div>
<div class="line"><span class="comment">// sel=&quot;n&quot; for the inverse transformation is equivalent to sel=&quot;X n&quot;</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The default values are hist=0 and sel=&quot;none&quot;</span></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html#l01568">1568</a> of file <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html">NcDSP.cxx</a>.</p>

</div>
</div>
<a id="a9fdac328a320753b02f4afe7cced73a5" name="a9fdac328a320753b02f4afe7cced73a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9fdac328a320753b02f4afe7cced73a5">&#9670;&#160;</a></span>HistogramFilterFFT()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void NcDSP::HistogramFilterFFT </td>
          <td>(</td>
          <td class="paramtype">TArray *</td>          <td class="paramname"><span class="paramname"><em>h</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TH1 *</td>          <td class="paramname"><span class="paramname"><em>hisf</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Bool_t</td>          <td class="paramname"><span class="paramname"><em>dB</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Bool_t</td>          <td class="paramname"><span class="paramname"><em>kernel</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TH1 *</td>          <td class="paramname"><span class="paramname"><em>hist</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="comment">// Internal member function to provide a filter kernel or filter result histogram in the frequency domain,</span></div>
<div class="line"><span class="comment">// based on the time domain filter kernel or time domain filter result data contained in &quot;h&quot;. </span></div>
<div class="line"><span class="comment">// The amplitude may be represented in decibel (dB=kTRUE) or linear (dB=kFALSE).</span></div>
<div class="line"><span class="comment">// In case of filter kernel data (kernel=kTRUE), the histogram will be rescaled</span></div>
<div class="line"><span class="comment">// such that the maximum value is at 1 for linear amplitudes or 0 for amplitudes in dB. </span></div>
<div class="line"><span class="comment">// The optional argument &quot;hist&quot; may be used to obtain a (zero padded) histogram of the time domain kernel.</span></div>
<div class="line"><span class="comment">// However, in case kernel=kFALSE, the &quot;hist&quot; histogram will be left empty.</span></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html#l05420">5420</a> of file <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html">NcDSP.cxx</a>.</p>

</div>
</div>
<a id="a575237089eac623bf91975837386563f" name="a575237089eac623bf91975837386563f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a575237089eac623bf91975837386563f">&#9670;&#160;</a></span>HistogramTrafoResult()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void NcDSP::HistogramTrafoResult </td>
          <td>(</td>
          <td class="paramtype">TString</td>          <td class="paramname"><span class="paramname"><em>name</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t</td>          <td class="paramname"><span class="paramname"><em>mode</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TH1 *</td>          <td class="paramname"><span class="paramname"><em>hist</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TString</td>          <td class="paramname"><span class="paramname"><em>sel</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="comment">// Internal memberfunction to provide a histogram with the requested transformation result.</span></div>
<div class="line"><span class="comment">// The histogram contents are stored in the fHisto array, which can be accessed via GetData().</span></div>
<div class="line"><span class="comment">// </span></div>
<div class="line"><span class="comment">// Input arguments :</span></div>
<div class="line"><span class="comment">// -----------------</span></div>
<div class="line"><span class="comment">// mode : &gt;0      --&gt; Result of a forward transformation</span></div>
<div class="line"><span class="comment">//        &lt;0      --&gt; Result of a backward transformation</span></div>
<div class="line"><span class="comment">// hist :             Histogram with selected results</span></div>
<div class="line"><span class="comment">// sel  : String to specify the representation of the result histogram</span></div>
<div class="line"><span class="comment">//        &quot;RE&quot;    --&gt; Y-axis shows the values of the real (re) components</span></div>
<div class="line"><span class="comment">//        &quot;IM&quot;    --&gt; Y-axis shows the values of the imaginary (im) components</span></div>
<div class="line"><span class="comment">//        &quot;AMP&quot;   --&gt; Y-axis shows the values of the amplitudes, i.e. sqrt(re*re+im*im)</span></div>
<div class="line"><span class="comment">//        &quot;dB&quot;    --&gt; Y-axis shows the values of the amplitudes, i.e. sqrt(re*re+im*im), in decibel</span></div>
<div class="line"><span class="comment">//        &quot;PHIR&quot;  --&gt; Y-axis shows the values of the phases, i.e. arctan(im/re), in radians</span></div>
<div class="line"><span class="comment">//        &quot;PHID&quot;  --&gt; Y-axis shows the values of the phases, i.e. arctan(im/re), in degrees</span></div>
<div class="line"><span class="comment">//        &quot;CPHI&quot;  --&gt; Y axis shows the values of cos(phase), i.e. cos(arctan(im/re))</span></div>
<div class="line"><span class="comment">//        &quot;SPHI&quot;  --&gt; Y axis shows the values of cos(phase), i.e. cos(arctan(im/re))</span></div>
<div class="line"><span class="comment">//        &quot;OMEGA&quot; --&gt; Y axis shows the values of the angular frequency in rad/sec, i.e. d(arctan(im/re))/dt</span></div>
<div class="line"><span class="comment">//        &quot;k&quot;     --&gt; X-axis represents the index k in the frequency domain  </span></div>
<div class="line"><span class="comment">//        &quot;f&quot;     --&gt; X-axis represents the fraction f of the sampling rate in the frequency domain</span></div>
<div class="line"><span class="comment">//        &quot;Hz&quot;    --&gt; X-axis represents the actual frequency in Hz in the frequency domain</span></div>
<div class="line"><span class="comment">//        &quot;n&quot;     --&gt; X-axis represents the index n in the time domain  </span></div>
<div class="line"><span class="comment">//        &quot;t&quot;     --&gt; X-axis represents the actual time in seconds in the time domain</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Note : The options &quot;Hz&quot;, &quot;t&quot; and &quot;OMEGA&quot; can only be used if the actual data acquisition sampling rate</span></div>
<div class="line"><span class="comment">//        has been provided via the Load() memberfunction.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Examples :</span></div>
<div class="line"><span class="comment">// ----------</span></div>
<div class="line"><span class="comment">// sel=&quot;AMP t&quot; will show the amplitudes as a function of the actual time in seconds.</span></div>
<div class="line"><span class="comment">// sel=&quot;PHID n&quot; will show the phases in degrees as a function of the index n in the time domain.</span></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html#l01768">1768</a> of file <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html">NcDSP.cxx</a>.</p>

</div>
</div>
<a id="aeed9635f232bec20b1b8a8d64cfd2b0a" name="aeed9635f232bec20b1b8a8d64cfd2b0a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeed9635f232bec20b1b8a8d64cfd2b0a">&#9670;&#160;</a></span>Load() <span class="overload">[1/6]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NcDSP::Load </td>
          <td>(</td>
          <td class="paramtype">Int_t</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Double_t *</td>          <td class="paramname"><span class="paramname"><em>re</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Double_t *</td>          <td class="paramname"><span class="paramname"><em>im</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Float_t</td>          <td class="paramname"><span class="paramname"><em>f</em></span><span class="paramdefsep"> = </span><span class="paramdefval">-1</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="comment">// Provide new input data to be processed and reset the FFTW processor.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Note : The (optional) waveform data stored via SetWaveform() will not be modified.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Input arguments :</span></div>
<div class="line"><span class="comment">// -----------------</span></div>
<div class="line"><span class="comment">// n  : The number of data elements</span></div>
<div class="line"><span class="comment">// re : Array with real data elements</span></div>
<div class="line"><span class="comment">// im : Array with imaginary data elements</span></div>
<div class="line"><span class="comment">// f  : (optional) Actual data acquisition sampling frequency in Hz</span></div>
<div class="line"><span class="comment">//      In case f&lt;0 the current sampling frequency is not modified.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// If provided, the array size must be at least of dimension &quot;n&quot;.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The defaults are im=0 and f=-1.</span></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html#l00395">395</a> of file <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html">NcDSP.cxx</a>.</p>

</div>
</div>
<a id="a8c6f7585b1c6b5c672ef86e4c62bd950" name="a8c6f7585b1c6b5c672ef86e4c62bd950"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c6f7585b1c6b5c672ef86e4c62bd950">&#9670;&#160;</a></span>Load() <span class="overload">[2/6]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NcDSP::Load </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/dcd/class_nc_sample.html">NcSample</a> *</td>          <td class="paramname"><span class="paramname"><em>s</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t</td>          <td class="paramname"><span class="paramname"><em>i</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Float_t</td>          <td class="paramname"><span class="paramname"><em>f</em></span><span class="paramdefsep"> = </span><span class="paramdefval">-1</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="comment">// Provide new input data from the NcSample &quot;s&quot; to be processed and reset the FFTW processor.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Note : The (optional) waveform data stored via SetWaveform() will not be modified.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Input arguments :</span></div>
<div class="line"><span class="comment">// -----------------</span></div>
<div class="line"><span class="comment">// i : The data of the i-th variable (1=first) of the NcSample are used</span></div>
<div class="line"><span class="comment">// f : (optional) Actual data acquisition sampling frequency in Hz</span></div>
<div class="line"><span class="comment">//      In case f&lt;0 the current sampling frequency is not modified.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Note : The Store Mode of the NcSample must be activated. </span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The default value is f=-1.</span></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html#l00493">493</a> of file <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html">NcDSP.cxx</a>.</p>

</div>
</div>
<a id="a323a1fda4a45e3d8b5e2b8f13bc4caf7" name="a323a1fda4a45e3d8b5e2b8f13bc4caf7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a323a1fda4a45e3d8b5e2b8f13bc4caf7">&#9670;&#160;</a></span>Load() <span class="overload">[3/6]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NcDSP::Load </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/dcd/class_nc_sample.html">NcSample</a> *</td>          <td class="paramname"><span class="paramname"><em>s</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TString</td>          <td class="paramname"><span class="paramname"><em>name</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Float_t</td>          <td class="paramname"><span class="paramname"><em>f</em></span><span class="paramdefsep"> = </span><span class="paramdefval">-1</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="comment">// Provide new input data from the NcSample &quot;s&quot; to be processed and reset the FFTW processor.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Note : The (optional) waveform data stored via SetWaveform() will not be modified.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Input arguments :</span></div>
<div class="line"><span class="comment">// -----------------</span></div>
<div class="line"><span class="comment">// name : Name of the NcSample variable of which the data are used</span></div>
<div class="line"><span class="comment">// f    : (optional) Actual data acquisition sampling frequency in Hz</span></div>
<div class="line"><span class="comment">//        In case f&lt;0 the current sampling frequency is not modified.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Note : The Store Mode of the NcSample must be activated. </span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The default value is f=-1.</span></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html#l00545">545</a> of file <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html">NcDSP.cxx</a>.</p>

</div>
</div>
<a id="a5e81a3a697134fc57f888fce42197e9d" name="a5e81a3a697134fc57f888fce42197e9d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e81a3a697134fc57f888fce42197e9d">&#9670;&#160;</a></span>Load() <span class="overload">[4/6]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NcDSP::Load </td>
          <td>(</td>
          <td class="paramtype">TArray *</td>          <td class="paramname"><span class="paramname"><em>re</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TArray *</td>          <td class="paramname"><span class="paramname"><em>im</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Float_t</td>          <td class="paramname"><span class="paramname"><em>f</em></span><span class="paramdefsep"> = </span><span class="paramdefval">-1</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="comment">// Provide new input data to be processed and reset the FFTW processor.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Note : The (optional) waveform data stored via SetWaveform() will not be modified.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Input arguments :</span></div>
<div class="line"><span class="comment">// -----------------</span></div>
<div class="line"><span class="comment">// re : Array with real data elements</span></div>
<div class="line"><span class="comment">// im : Array with imaginary data elements</span></div>
<div class="line"><span class="comment">// f  : (optional) Actual data acquisition sampling frequency in Hz</span></div>
<div class="line"><span class="comment">//      In case f&lt;0 the current sampling frequency is not modified.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// If both arrays are provided, the size of the smallest non-empty array</span></div>
<div class="line"><span class="comment">// will be used to compose the input data.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The defaults are im=0 and f=-1.</span></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html#l00434">434</a> of file <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html">NcDSP.cxx</a>.</p>

</div>
</div>
<a id="ab872cea8f749c9d878a3addfd6923ad7" name="ab872cea8f749c9d878a3addfd6923ad7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab872cea8f749c9d878a3addfd6923ad7">&#9670;&#160;</a></span>Load() <span class="overload">[5/6]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NcDSP::Load </td>
          <td>(</td>
          <td class="paramtype">TGraph *</td>          <td class="paramname"><span class="paramname"><em>gr</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Float_t</td>          <td class="paramname"><span class="paramname"><em>f</em></span><span class="paramdefsep"> = </span><span class="paramdefval">-1</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="comment">// Provide new input data from a TGraph object to be processed and reset the FFTW processor.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Note : The (optional) waveform data stored via SetWaveform() will not be modified.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Input arguments :</span></div>
<div class="line"><span class="comment">// -----------------</span></div>
<div class="line"><span class="comment">// gr : Pointer to the TGraph object of which the bin contents are used</span></div>
<div class="line"><span class="comment">// f  : (optional) Actual data acquisition sampling frequency in Hz</span></div>
<div class="line"><span class="comment">//      In case f&lt;0 the current sampling frequency is not modified.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The default value is f=-1.</span></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html#l00640">640</a> of file <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html">NcDSP.cxx</a>.</p>

</div>
</div>
<a id="a33355ba7cd7a534f275c5ea45f24d716" name="a33355ba7cd7a534f275c5ea45f24d716"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a33355ba7cd7a534f275c5ea45f24d716">&#9670;&#160;</a></span>Load() <span class="overload">[6/6]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NcDSP::Load </td>
          <td>(</td>
          <td class="paramtype">TH1 *</td>          <td class="paramname"><span class="paramname"><em>h</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Float_t</td>          <td class="paramname"><span class="paramname"><em>f</em></span><span class="paramdefsep"> = </span><span class="paramdefval">-1</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="comment">// Provide new input data from a 1-Dimensional histogram to be processed and reset the FFTW processor.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Note : The (optional) waveform data stored via SetWaveform() will not be modified.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Input arguments :</span></div>
<div class="line"><span class="comment">// -----------------</span></div>
<div class="line"><span class="comment">// h : Pointer to the 1-D histogram of which the bin contents are used</span></div>
<div class="line"><span class="comment">// f : (optional) Actual data acquisition sampling frequency in Hz</span></div>
<div class="line"><span class="comment">//     In case f&lt;0 the current sampling frequency is not modified.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The default value is f=-1.</span></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html#l00591">591</a> of file <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html">NcDSP.cxx</a>.</p>

</div>
</div>
<a id="a0251f481e659a9d8aea78b76dc311a33" name="a0251f481e659a9d8aea78b76dc311a33"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0251f481e659a9d8aea78b76dc311a33">&#9670;&#160;</a></span>LoadResult()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NcDSP::LoadResult </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="comment">// Load the current transformation result as new input data in order to enable</span></div>
<div class="line"><span class="comment">// inverse transformations acting on previous transformation results.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Notes :</span></div>
<div class="line"><span class="comment">// -------</span></div>
<div class="line"><span class="comment">// 1) Invokation of this memberfunction will reset all output arrays, so that </span></div>
<div class="line"><span class="comment">//    previously obtained results will internally be lost.</span></div>
<div class="line"><span class="comment">//    Use the GetData() memberfunction to retrieve data that might be needed later again. </span></div>
<div class="line"><span class="comment">// 2) Invokation of one of the other Load() memberfunctions will also reset the input arrays.</span></div>
<div class="line"><span class="comment">//    Use the GetData() memberfunction to retrieve data that might be needed later again. </span></div>
<div class="line"><span class="comment">// 3) The (optional) waveform data stored via SetWaveform() will not be modified.</span></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html#l00691">691</a> of file <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html">NcDSP.cxx</a>.</p>

</div>
</div>
<a id="af9d6afad52d8b8cf9ec43e851f63bf03" name="af9d6afad52d8b8cf9ec43e851f63bf03"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9d6afad52d8b8cf9ec43e851f63bf03">&#9670;&#160;</a></span>Reset()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void NcDSP::Reset </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="comment">// Internal member function to reset all data and the FFTW processor. </span></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html#l00344">344</a> of file <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html">NcDSP.cxx</a>.</p>

</div>
</div>
<a id="a93c6598a165c81a817c66d8d33b7af6a" name="a93c6598a165c81a817c66d8d33b7af6a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a93c6598a165c81a817c66d8d33b7af6a">&#9670;&#160;</a></span>SampleAndHold() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TArrayD NcDSP::SampleAndHold </td>
          <td>(</td>
          <td class="paramtype">Int_t</td>          <td class="paramname"><span class="paramname"><em>ns</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TH1 *</td>          <td class="paramname"><span class="paramname"><em>hist</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t</td>          <td class="paramname"><span class="paramname"><em>loc</em></span><span class="paramdefsep"> = </span><span class="paramdefval">-1</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t</td>          <td class="paramname"><span class="paramname"><em>jmin</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t</td>          <td class="paramname"><span class="paramname"><em>jmax</em></span><span class="paramdefsep"> = </span><span class="paramdefval">-1</span>&#160;) const</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="comment">// Perform a Sample-And-Hold operation on the data contained in the stored waveform</span></div>
<div class="line"><span class="comment">// over the sampled interval [jmin,jmax], using &quot;n&quot; original samples as the new sampling step size.</span></div>
<div class="line"><span class="comment">// By convention, the first sample is at j=0.</span></div>
<div class="line"><span class="comment">// The result is returned in a TArrayD object and (optionally) in the histogram &quot;hist&quot;,</span></div>
<div class="line"><span class="comment">// without modification of the original waveform data.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// If the waveform can be regarded as a pulse generator in time, this mimics a </span></div>
<div class="line"><span class="comment">// sample and hold device with a lock time of &quot;n&quot; time units,</span></div>
<div class="line"><span class="comment">// or equivalently a sampling frequency which is reduced by a factor 1/n.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The input argument &quot;loc&quot; determines whether the resulting data</span></div>
<div class="line"><span class="comment">// will be recorded at the start (loc&lt;0), center (loc=0) or end (loc&gt;0)</span></div>
<div class="line"><span class="comment">// of the new sampling step size.</span></div>
<div class="line"><span class="comment">// However, in case the recording location of the last sampling step would</span></div>
<div class="line"><span class="comment">// exceed &quot;jmax&quot;, the data will be recorded at the value of &quot;jmax&quot;.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// If jmax&lt;=jmin the full data array of the stored waveform will be used.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The default values are hist=0, loc=-1, jmin=0 and jmax=-1.</span></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html#l03430">3430</a> of file <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html">NcDSP.cxx</a>.</p>

</div>
</div>
<a id="ac85fe915d2a3bcd806ea3968a73c53be" name="ac85fe915d2a3bcd806ea3968a73c53be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac85fe915d2a3bcd806ea3968a73c53be">&#9670;&#160;</a></span>SampleAndHold() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TArrayD NcDSP::SampleAndHold </td>
          <td>(</td>
          <td class="paramtype">TF1</td>          <td class="paramname"><span class="paramname"><em>f</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Double_t</td>          <td class="paramname"><span class="paramname"><em>step</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Double_t</td>          <td class="paramname"><span class="paramname"><em>vmin</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Double_t</td>          <td class="paramname"><span class="paramname"><em>vmax</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TH1 *</td>          <td class="paramname"><span class="paramname"><em>hist</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t</td>          <td class="paramname"><span class="paramname"><em>loc</em></span><span class="paramdefsep"> = </span><span class="paramdefval">-1</span>&#160;) const</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="comment">// Perform a Sample-And-Hold operation on the specified function &quot;f&quot;</span></div>
<div class="line"><span class="comment">// in the interval [vmin,vmax], using &quot;step&quot; as the sampling step size.</span></div>
<div class="line"><span class="comment">// The result is returned in a TArrayD object and (optionally) in the histogram &quot;hist&quot;.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// If &quot;f&quot; can be regarded as a pulse generator in time, this mimics a </span></div>
<div class="line"><span class="comment">// sample and hold device with a lock time of &quot;step&quot; time units,</span></div>
<div class="line"><span class="comment">// or equivalently a sampling frequency of 1/step.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The input argument &quot;loc&quot; determines whether the resulting data</span></div>
<div class="line"><span class="comment">// will be recorded at the start (loc&lt;0), center (loc=0) or end (loc&gt;0)</span></div>
<div class="line"><span class="comment">// of the sampling step size.</span></div>
<div class="line"><span class="comment">// However, in case the recording location of the last sampling step would</span></div>
<div class="line"><span class="comment">// exceed &quot;vmax&quot;, the data will be recorded at the value of &quot;vmax&quot;.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The default values are hist=0 and loc=-1.</span></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html#l03357">3357</a> of file <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html">NcDSP.cxx</a>.</p>

</div>
</div>
<a id="affa7aa3764900c07a15b09b9020caf05" name="affa7aa3764900c07a15b09b9020caf05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#affa7aa3764900c07a15b09b9020caf05">&#9670;&#160;</a></span>SampleAndSum() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TArrayD NcDSP::SampleAndSum </td>
          <td>(</td>
          <td class="paramtype">Int_t</td>          <td class="paramname"><span class="paramname"><em>ns</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TH1 *</td>          <td class="paramname"><span class="paramname"><em>hist</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t</td>          <td class="paramname"><span class="paramname"><em>jmin</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t</td>          <td class="paramname"><span class="paramname"><em>jmax</em></span><span class="paramdefsep"> = </span><span class="paramdefval">-1</span>&#160;) const</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="comment">// Perform a Sample-And-Sum operation on the data contained in the stored waveform</span></div>
<div class="line"><span class="comment">// over the sampled interval [jmin,jmax], using &quot;n&quot; original samples as the new sampling step size.</span></div>
<div class="line"><span class="comment">// By convention, the first sample is at j=0.</span></div>
<div class="line"><span class="comment">// The result is returned in a TArrayD object and (optionally) in the histogram &quot;hist&quot;,</span></div>
<div class="line"><span class="comment">// without modification of the original waveform data.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// This procedure resembles a Sample-And-Hold operation, but instead of locking</span></div>
<div class="line"><span class="comment">// the data recording during the stepsize of &quot;n&quot; samplings, the data that appear</span></div>
<div class="line"><span class="comment">// within &quot;n&quot; samplings are summed.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// If the waveform data can be regarded as sampling in time, this mimics a </span></div>
<div class="line"><span class="comment">// Switched Capacitor Array (SCA) with a time gate of &quot;n&quot; time units,</span></div>
<div class="line"><span class="comment">// or equivalently a sampling frequency which is reduced by a factor 1/n.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// If jmax&lt;=jmin the full data array of the stored waveform will be used.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The default values are hist=0, jmin=0 and jmax=-1.</span></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html#l03604">3604</a> of file <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html">NcDSP.cxx</a>.</p>

</div>
</div>
<a id="ae5421ce4995ad4d99d6e9cba90f850e5" name="ae5421ce4995ad4d99d6e9cba90f850e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5421ce4995ad4d99d6e9cba90f850e5">&#9670;&#160;</a></span>SampleAndSum() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TArrayD NcDSP::SampleAndSum </td>
          <td>(</td>
          <td class="paramtype">TF1</td>          <td class="paramname"><span class="paramname"><em>f</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Double_t</td>          <td class="paramname"><span class="paramname"><em>step</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Double_t</td>          <td class="paramname"><span class="paramname"><em>vmin</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Double_t</td>          <td class="paramname"><span class="paramname"><em>vmax</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TH1 *</td>          <td class="paramname"><span class="paramname"><em>hist</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>&#160;) const</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="comment">// Perform a Sample-And-Sum operation on the specified function &quot;f&quot;</span></div>
<div class="line"><span class="comment">// in the interval [vmin,vmax], using &quot;step&quot; as the sampling step size.</span></div>
<div class="line"><span class="comment">// The result is returned in a TArrayD object and (optionally) in the histogram &quot;hist&quot;.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// This procedure resembles a Sample-And-Hold operation, but instead of locking</span></div>
<div class="line"><span class="comment">// the data recording during the stepsize, the data that appear within &quot;step&quot;</span></div>
<div class="line"><span class="comment">// are summed c.q. integrated.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// If &quot;f&quot; can be regarded as sampling in time, this mimics a </span></div>
<div class="line"><span class="comment">// Switched Capacitor Array (SCA) with a time gate of &quot;step&quot; time units,</span></div>
<div class="line"><span class="comment">// or equivalently a sampling frequency which is reduced by a factor 1/step.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The default value is hist=0.</span></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html#l03534">3534</a> of file <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html">NcDSP.cxx</a>.</p>

</div>
</div>
<a id="a1301f9e36ac0292108a475a7fc62f889" name="a1301f9e36ac0292108a475a7fc62f889"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1301f9e36ac0292108a475a7fc62f889">&#9670;&#160;</a></span>SetSamplingFrequency()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NcDSP::SetSamplingFrequency </td>
          <td>(</td>
          <td class="paramtype">Float_t</td>          <td class="paramname"><span class="paramname"><em>f</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="comment">// Set the actual DAQ sampling frequency in Hz.</span></div>
<div class="line"><span class="comment">// This sampling frequency may be overwritten by invokation of</span></div>
<div class="line"><span class="comment">// one of the various Load() member functions.</span></div>
<div class="line"><span class="comment">// The sampling frequency is set to 0 in the constructor of this class.</span></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html#l00370">370</a> of file <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html">NcDSP.cxx</a>.</p>

</div>
</div>
<a id="a63d66c347ca2cdc882b590940e7ac175" name="a63d66c347ca2cdc882b590940e7ac175"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63d66c347ca2cdc882b590940e7ac175">&#9670;&#160;</a></span>SetWaveform() <span class="overload">[1/6]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NcDSP::SetWaveform </td>
          <td>(</td>
          <td class="paramtype">Int_t</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Double_t *</td>          <td class="paramname"><span class="paramname"><em>h</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Float_t</td>          <td class="paramname"><span class="paramname"><em>f</em></span><span class="paramdefsep"> = </span><span class="paramdefval">-1</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="comment">// Set the (system response) waveform for Convolution, Correlation etc.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Note : The input data stored via Load() will not be modified.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Input arguments :</span></div>
<div class="line"><span class="comment">// -----------------</span></div>
<div class="line"><span class="comment">// n : The number of data elements</span></div>
<div class="line"><span class="comment">// h : Array with the waveform data</span></div>
<div class="line"><span class="comment">// f : (optional) Actual data acquisition sampling frequency in Hz</span></div>
<div class="line"><span class="comment">//     In case f&lt;0 the current sampling frequency is not modified.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The array size of &quot;h&quot; must be at least of dimension &quot;n&quot;.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The default value is f=-1.</span></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html#l00716">716</a> of file <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html">NcDSP.cxx</a>.</p>

</div>
</div>
<a id="a4397b2e0eee2e9b40748771f4476a990" name="a4397b2e0eee2e9b40748771f4476a990"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4397b2e0eee2e9b40748771f4476a990">&#9670;&#160;</a></span>SetWaveform() <span class="overload">[2/6]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NcDSP::SetWaveform </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/dcd/class_nc_sample.html">NcSample</a> *</td>          <td class="paramname"><span class="paramname"><em>s</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t</td>          <td class="paramname"><span class="paramname"><em>i</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Float_t</td>          <td class="paramname"><span class="paramname"><em>f</em></span><span class="paramdefsep"> = </span><span class="paramdefval">-1</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="comment">// Set the (system response) waveform for Convolution, Correlation etc.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Note : The input data stored via Load() will not be modified.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Input arguments :</span></div>
<div class="line"><span class="comment">// -----------------</span></div>
<div class="line"><span class="comment">// s : NcSample with the waveform data</span></div>
<div class="line"><span class="comment">// i : The data of the i-th variable (1=first) of the NcSample are used</span></div>
<div class="line"><span class="comment">// f : (optional) Actual data acquisition sampling frequency in Hz</span></div>
<div class="line"><span class="comment">//      In case f&lt;0 the current sampling frequency is not modified.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Note : The Store Mode of the NcSample must be activated. </span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The default value is f=-1.</span></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html#l00804">804</a> of file <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html">NcDSP.cxx</a>.</p>

</div>
</div>
<a id="a08921a1001ce0ed9064a359795e66d0c" name="a08921a1001ce0ed9064a359795e66d0c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a08921a1001ce0ed9064a359795e66d0c">&#9670;&#160;</a></span>SetWaveform() <span class="overload">[3/6]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NcDSP::SetWaveform </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/dcd/class_nc_sample.html">NcSample</a> *</td>          <td class="paramname"><span class="paramname"><em>s</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TString</td>          <td class="paramname"><span class="paramname"><em>name</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Float_t</td>          <td class="paramname"><span class="paramname"><em>f</em></span><span class="paramdefsep"> = </span><span class="paramdefval">-1</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="comment">// Set the (system response) waveform for Convolution, Correlation etc.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Note : The input data stored via Load() will not be modified.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Input arguments :</span></div>
<div class="line"><span class="comment">// -----------------</span></div>
<div class="line"><span class="comment">// s    : NcSample with the waveform data</span></div>
<div class="line"><span class="comment">// name : Name of the NcSample variable of which the data are used</span></div>
<div class="line"><span class="comment">// f    : (optional) Actual data acquisition sampling frequency in Hz</span></div>
<div class="line"><span class="comment">//        In case f&lt;0 the current sampling frequency is not modified.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Note : The Store Mode of the NcSample must be activated. </span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The default value is f=-1.</span></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html#l00858">858</a> of file <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html">NcDSP.cxx</a>.</p>

</div>
</div>
<a id="a8763e48cf48629eddd304cfc44c2ed6c" name="a8763e48cf48629eddd304cfc44c2ed6c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8763e48cf48629eddd304cfc44c2ed6c">&#9670;&#160;</a></span>SetWaveform() <span class="overload">[4/6]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NcDSP::SetWaveform </td>
          <td>(</td>
          <td class="paramtype">TArray *</td>          <td class="paramname"><span class="paramname"><em>h</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Float_t</td>          <td class="paramname"><span class="paramname"><em>f</em></span><span class="paramdefsep"> = </span><span class="paramdefval">-1</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="comment">// Set the (system response) waveform for Convolution, Correlation etc.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Note : The input data stored via Load() will not be modified.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Input arguments :</span></div>
<div class="line"><span class="comment">// -----------------</span></div>
<div class="line"><span class="comment">// h : Array with the waveform data</span></div>
<div class="line"><span class="comment">// f : (optional) Actual data acquisition sampling frequency in Hz</span></div>
<div class="line"><span class="comment">//     In case f&lt;0 the current sampling frequency is not modified.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The default value is f=-1.</span></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html#l00759">759</a> of file <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html">NcDSP.cxx</a>.</p>

</div>
</div>
<a id="a4b9dfcb56cddda2b0ca6706def8ab27b" name="a4b9dfcb56cddda2b0ca6706def8ab27b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b9dfcb56cddda2b0ca6706def8ab27b">&#9670;&#160;</a></span>SetWaveform() <span class="overload">[5/6]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NcDSP::SetWaveform </td>
          <td>(</td>
          <td class="paramtype">TGraph *</td>          <td class="paramname"><span class="paramname"><em>gr</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Float_t</td>          <td class="paramname"><span class="paramname"><em>f</em></span><span class="paramdefsep"> = </span><span class="paramdefval">-1</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="comment">// Set the (system response) waveform for Convolution, Correlation etc.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Note : The input data stored via Load() will not be modified.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Input arguments :</span></div>
<div class="line"><span class="comment">// -----------------</span></div>
<div class="line"><span class="comment">// gr : Pointer to the TGraph object of which the bin contents are used for the waveform data</span></div>
<div class="line"><span class="comment">// f  : (optional) Actual data acquisition sampling frequency in Hz</span></div>
<div class="line"><span class="comment">//      In case f&lt;0 the current sampling frequency is not modified.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The default value is f=-1.</span></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html#l00956">956</a> of file <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html">NcDSP.cxx</a>.</p>

</div>
</div>
<a id="af38e23b504b608f3dc495a0fcfb40825" name="af38e23b504b608f3dc495a0fcfb40825"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af38e23b504b608f3dc495a0fcfb40825">&#9670;&#160;</a></span>SetWaveform() <span class="overload">[6/6]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NcDSP::SetWaveform </td>
          <td>(</td>
          <td class="paramtype">TH1 *</td>          <td class="paramname"><span class="paramname"><em>h</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Float_t</td>          <td class="paramname"><span class="paramname"><em>f</em></span><span class="paramdefsep"> = </span><span class="paramdefval">-1</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="comment">// Set the (system response) waveform for Convolution, Correlation etc.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Note : The input data stored via Load() will not be modified.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Input arguments :</span></div>
<div class="line"><span class="comment">// -----------------</span></div>
<div class="line"><span class="comment">// h : Pointer to the 1-D histogram of which the bin contents are used for the waveform data</span></div>
<div class="line"><span class="comment">// f : (optional) Actual data acquisition sampling frequency in Hz</span></div>
<div class="line"><span class="comment">//     In case f&lt;0 the current sampling frequency is not modified.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The default value is f=-1.</span></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html#l00906">906</a> of file <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html">NcDSP.cxx</a>.</p>

</div>
</div>
<a id="aeb13c3f3c536b0527aaccc44d4f5a8a1" name="aeb13c3f3c536b0527aaccc44d4f5a8a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb13c3f3c536b0527aaccc44d4f5a8a1">&#9670;&#160;</a></span>Sine()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NcDSP::Sine </td>
          <td>(</td>
          <td class="paramtype">Int_t</td>          <td class="paramname"><span class="paramname"><em>type</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TH1 *</td>          <td class="paramname"><span class="paramname"><em>hist</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TString</td>          <td class="paramname"><span class="paramname"><em>sel</em></span><span class="paramdefsep"> = </span><span class="paramdefval">&quot;none&quot;</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="comment">// Perform a normalized 1-dimensional Discrete Sine Transformation (DST).</span></div>
<div class="line"><span class="comment">// Actually, this is just a regular Discrete Fourier Transformation (DFT)</span></div>
<div class="line"><span class="comment">// with only real input values which contain an odd symmetry.</span></div>
<div class="line"><span class="comment">// Consequently, the resulting transformed array is also only real with odd symmetry.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Conventions :</span></div>
<div class="line"><span class="comment">// -------------</span></div>
<div class="line"><span class="comment">// N = The number of data elements</span></div>
<div class="line"><span class="comment">// Time domain array .... : X[]=X[0],...,X[N-1]</span></div>
<div class="line"><span class="comment">// Frequency domain array : Q[]=Q[0],...,Q[N-1]</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Sine transform type 1 : Q[k]=(1/sqrt(2*(N+1)))*[2*sum(n=0,n=N-1){X[n]*sin(pi*(n+1)*(k+1)/(N+1))}]</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Sine transform type 2 : Q[k]=(1/sqrt(2N))*2*sum(n=0,n=N-1){X[n]*sin(pi*(n+0.5)*(k+1)/N)}</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Sine transform type 3 : Q[k]=(1/sqrt(2N))*[pow(-1,k)*X[N-1]+2*sum(n=0,n=N-2){X[n]*sin(pi*(n+1)*(k+0.5)/N)}]</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Sine transform type 4 : Q[k]=(1/sqrt(2N))*2*sum(n=0,n=N-1){X[n]*sin(pi*(n+0.5)*(k+0.5)/N)}</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Notes :</span></div>
<div class="line"><span class="comment">// -------</span></div>
<div class="line"><span class="comment">// 1) The type 1 transformation is its own inverse.</span></div>
<div class="line"><span class="comment">// 2) The type 4 transformation is its own inverse.</span></div>
<div class="line"><span class="comment">// 3) The type 3 transformation is the inverse of type 2 (and vice versa).</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Input arguments :</span></div>
<div class="line"><span class="comment">// -----------------</span></div>
<div class="line"><span class="comment">// type : The type of transformation (i.e. 1,2,3 or 4) to be performed</span></div>
<div class="line"><span class="comment">//        The inverse transformations are specified with the corresponding negative type value</span></div>
<div class="line"><span class="comment">// hist : (optional) Histogram with selected results</span></div>
<div class="line"><span class="comment">// sel  : String to specify the representation of the result histogram</span></div>
<div class="line"><span class="comment">//        &quot;k&quot;    --&gt; X-axis represents the index k in the frequency domain  </span></div>
<div class="line"><span class="comment">//        &quot;f&quot;    --&gt; X-axis represents the fraction f of the sampling rate in the frequency domain</span></div>
<div class="line"><span class="comment">//        &quot;Hz&quot;   --&gt; X-axis represents the actual frequency in Hz in the frequency domain</span></div>
<div class="line"><span class="comment">//        &quot;n&quot;    --&gt; X-axis represents the index n in the time domain  </span></div>
<div class="line"><span class="comment">//        &quot;t&quot;    --&gt; X-axis represents the actual time in seconds in the time domain</span></div>
<div class="line"><span class="comment">//        &quot;2&quot;    --&gt; X-axis spans the full number of data points, instead of the usual (N/2)+1</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Note : The options &quot;Hz&quot; and &quot;t&quot; can only be used if the actual data acquisition sampling rate</span></div>
<div class="line"><span class="comment">//        has been provided via the Load() memberfunction.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Examples :</span></div>
<div class="line"><span class="comment">// ----------</span></div>
<div class="line"><span class="comment">// sel=&quot;f&quot; will show the (N/2)+1 amplitudes as a function of the fractional sampling rate.</span></div>
<div class="line"><span class="comment">// sel=&quot;k 2&quot; will show all N amplitudes as a function of the index k in the frequency domain.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The default values are hist=0 and sel=&quot;none&quot;</span></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html#l01452">1452</a> of file <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html">NcDSP.cxx</a>.</p>

</div>
</div>
<a id="afacc03640067b04d54f8e0a1a515886c" name="afacc03640067b04d54f8e0a1a515886c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afacc03640067b04d54f8e0a1a515886c">&#9670;&#160;</a></span>Transmit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TArrayD NcDSP::Transmit </td>
          <td>(</td>
          <td class="paramtype">Int_t</td>          <td class="paramname"><span class="paramname"><em>nbits</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Double_t</td>          <td class="paramname"><span class="paramname"><em>range</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Double_t</td>          <td class="paramname"><span class="paramname"><em>Vbias</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TArray *</td>          <td class="paramname"><span class="paramname"><em>Vsig</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TArray *</td>          <td class="paramname"><span class="paramname"><em>peds</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TH1 *</td>          <td class="paramname"><span class="paramname"><em>hist</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t</td>          <td class="paramname"><span class="paramname"><em>B</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t</td>          <td class="paramname"><span class="paramname"><em>C</em></span><span class="paramdefsep"> = </span><span class="paramdefval">3</span>&#160;) const</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="comment">// Mimic signal transmission according to an &quot;nbits&quot; ADC-DAC chain.</span></div>
<div class="line"><span class="comment">// Analog input signals are digitized via the discrete quantization levels of an &quot;nbits&quot; ADC,</span></div>
<div class="line"><span class="comment">// based on the &quot;range&quot; for the analog signal and a bias voltage &quot;Vbias&quot; or array &quot;peds&quot; of pedestal values (see below).</span></div>
<div class="line"><span class="comment">// The analog input signals may be provided by the (optional) TArray &quot;Vsig&quot;.</span></div>
<div class="line"><span class="comment">// In case the array &quot;Vsig&quot; is not provided, the stored waveform is used to provide the analog input signals.</span></div>
<div class="line"><span class="comment">// After digitization, the digital signals are converted into analog signals via the corresponding &quot;nbits&quot; DAC.</span></div>
<div class="line"><span class="comment">// In this way the effect of digitization on the original input signals can be investigated, and can provide</span></div>
<div class="line"><span class="comment">// a guideline in selecting the most suitable ADC-DAC system for data transmission.</span></div>
<div class="line"><span class="comment">// The resulting analog values are returned in a TArrayD object, without modification of the original waveform data.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Note : Make sure to use the same units for &quot;range&quot;, &quot;Vbias&quot; and the analog input signals.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// For further details, please refer to the documentation of the memberfunctions ADC() and DAC().</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Input arguments :</span></div>
<div class="line"><span class="comment">// -----------------</span></div>
<div class="line"><span class="comment">// nbits    : Digital quantization was performed using an nbits ADC.</span></div>
<div class="line"><span class="comment">// range &gt;0 : The full scale voltage range (Vfs) of the analog signal that corresponds to adc=N-1. </span></div>
<div class="line"><span class="comment">//       &lt;0 : |range| is the reference voltage (Vref) of the analog signal that corresponds to the hypothetical adc=N.</span></div>
<div class="line"><span class="comment">// Vbias    : The bias voltage that was added to the analog input signal before digitization.</span></div>
<div class="line"><span class="comment">//            If specified, the resulting analog signals will be corrected for the bias voltage.</span></div>
<div class="line"><span class="comment">//            For a linear DAC the correction via Vbias will only be performed if no pedestal array &quot;peds&quot;</span></div>
<div class="line"><span class="comment">//            is specified (see below). If the array &quot;peds&quot; is specified, Vbias will be ignored for a linear DAC.</span></div>
<div class="line"><span class="comment">//            For a Log DAC the pedestal values will never be used and bias correction may only be obtained via Vbias.</span></div>
<div class="line"><span class="comment">// Vsig     : (Optional) array to contain the digital input signals.</span></div>
<div class="line"><span class="comment">// peds     : (Optional) array to contain the pedestal values for the individual digital signals.</span></div>
<div class="line"><span class="comment">//            The array &quot;peds&quot; must contain (at least) the same number of values as the number of analog input signals.</span></div>
<div class="line"><span class="comment">//            If the array &quot;peds&quot; is specified, the pedestals will be subtracted from the corresponding digital signals</span></div>
<div class="line"><span class="comment">//            before the conversion to analog signals is performed in case of a linear DAC.</span></div>
<div class="line"><span class="comment">//            For a Log DAC the pedestal values will never be used and bias correction may only be obtained via Vbias.</span></div>
<div class="line"><span class="comment">// B     &gt;1 : Base for a log ADC (e.g. B=10 emulates a Log_10 ADC).</span></div>
<div class="line"><span class="comment">//       =0 : The ADC will be linear</span></div>
<div class="line"><span class="comment">//       =1 : The ADC will be a Log_e ADC.</span></div>
<div class="line"><span class="comment">//            Note : When B&gt;0 all (Vbias+Vsig) input values should be positive.</span></div>
<div class="line"><span class="comment">// C        : Code efficiency factor that was used for a Log ADC.</span></div>
<div class="line"><span class="comment">//            Rule of thumb : pow(B,-C) is about the smallest signal/|range| ratio that can be resolved.</span></div>
<div class="line"><span class="comment">//            So, for a Log_10 ADC with C=3, the smallest signal that can be resolved is about |range|/1000.</span></div>
<div class="line"><span class="comment">//            Note : It is required that C&gt;0.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Optional output arguments :</span></div>
<div class="line"><span class="comment">// ---------------------------</span></div>
<div class="line"><span class="comment">// hist  : Histogram with the analog result</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Note :</span></div>
<div class="line"><span class="comment">// ------</span></div>
<div class="line"><span class="comment">// In case no &quot;Vsig&quot; array is provided and no waveform is present, just the ADC and DAC specs will be printed</span></div>
<div class="line"><span class="comment">// and in the TArrayD only the adc value corresponding to Vbias is returned.</span></div>
<div class="line"><span class="comment">// This allows to quickly investigate various scenarios without any data treatment.</span></div>
<div class="line"><span class="comment">//         </span></div>
<div class="line"><span class="comment">// The maximum number of bits that is supported is 60 to guarantee identical functioning</span></div>
<div class="line"><span class="comment">// on all machines.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// In case of inconsistent input parameters, no processing is performed and an empty TArrayD is returned.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The default values are Vbias=0, Vsig=0, peds=0, hist=0, B=0 and C=3.</span></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html#l03265">3265</a> of file <a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html">NcDSP.cxx</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a69b54f8645cb90858a0135afd08e740c" name="a69b54f8645cb90858a0135afd08e740c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a69b54f8645cb90858a0135afd08e740c">&#9670;&#160;</a></span>fHisto</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TArrayD NcDSP::fHisto</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../db/da5/_nc_d_s_p_8h_source.html#l00079">79</a> of file <a class="el" href="../../db/da5/_nc_d_s_p_8h_source.html">NcDSP.h</a>.</p>

</div>
</div>
<a id="a34e5e42913d9623d72e9cee8b6858ae4" name="a34e5e42913d9623d72e9cee8b6858ae4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34e5e42913d9623d72e9cee8b6858ae4">&#9670;&#160;</a></span>fImIn</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TArrayD NcDSP::fImIn</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../db/da5/_nc_d_s_p_8h_source.html#l00076">76</a> of file <a class="el" href="../../db/da5/_nc_d_s_p_8h_source.html">NcDSP.h</a>.</p>

</div>
</div>
<a id="a6b8348e01bce8e11b8ea3c1216ccb020" name="a6b8348e01bce8e11b8ea3c1216ccb020"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b8348e01bce8e11b8ea3c1216ccb020">&#9670;&#160;</a></span>fImOut</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TArrayD NcDSP::fImOut</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../db/da5/_nc_d_s_p_8h_source.html#l00078">78</a> of file <a class="el" href="../../db/da5/_nc_d_s_p_8h_source.html">NcDSP.h</a>.</p>

</div>
</div>
<a id="aebe9cb538759a671784075e62ae7f799" name="aebe9cb538759a671784075e62ae7f799"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aebe9cb538759a671784075e62ae7f799">&#9670;&#160;</a></span>fKeepOutput</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Bool_t NcDSP::fKeepOutput</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../db/da5/_nc_d_s_p_8h_source.html#l00083">83</a> of file <a class="el" href="../../db/da5/_nc_d_s_p_8h_source.html">NcDSP.h</a>.</p>

</div>
</div>
<a id="a6f049e701e085d51118e339f80be5cdf" name="a6f049e701e085d51118e339f80be5cdf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f049e701e085d51118e339f80be5cdf">&#9670;&#160;</a></span>fN</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Int_t NcDSP::fN</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../db/da5/_nc_d_s_p_8h_source.html#l00073">73</a> of file <a class="el" href="../../db/da5/_nc_d_s_p_8h_source.html">NcDSP.h</a>.</p>

</div>
</div>
<a id="a8498148368a1c5fafca2ab544e326d91" name="a8498148368a1c5fafca2ab544e326d91"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8498148368a1c5fafca2ab544e326d91">&#9670;&#160;</a></span>fNorm</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TString NcDSP::fNorm</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../db/da5/_nc_d_s_p_8h_source.html#l00081">81</a> of file <a class="el" href="../../db/da5/_nc_d_s_p_8h_source.html">NcDSP.h</a>.</p>

</div>
</div>
<a id="ad105520e483dc48a2ee5ca221f4f5502" name="ad105520e483dc48a2ee5ca221f4f5502"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad105520e483dc48a2ee5ca221f4f5502">&#9670;&#160;</a></span>fNwf</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Int_t NcDSP::fNwf</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../db/da5/_nc_d_s_p_8h_source.html#l00074">74</a> of file <a class="el" href="../../db/da5/_nc_d_s_p_8h_source.html">NcDSP.h</a>.</p>

</div>
</div>
<a id="ab2dfa20010b5370a7c322f992d845c93" name="ab2dfa20010b5370a7c322f992d845c93"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab2dfa20010b5370a7c322f992d845c93">&#9670;&#160;</a></span>fProc</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TVirtualFFT* NcDSP::fProc</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../db/da5/_nc_d_s_p_8h_source.html#l00072">72</a> of file <a class="el" href="../../db/da5/_nc_d_s_p_8h_source.html">NcDSP.h</a>.</p>

</div>
</div>
<a id="ad11cc8c1e6213b72de4c28eea9981e07" name="ad11cc8c1e6213b72de4c28eea9981e07"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad11cc8c1e6213b72de4c28eea9981e07">&#9670;&#160;</a></span>fReIn</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TArrayD NcDSP::fReIn</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../db/da5/_nc_d_s_p_8h_source.html#l00075">75</a> of file <a class="el" href="../../db/da5/_nc_d_s_p_8h_source.html">NcDSP.h</a>.</p>

</div>
</div>
<a id="a920356d1a2bd3d00c4be0148e166d3b4" name="a920356d1a2bd3d00c4be0148e166d3b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a920356d1a2bd3d00c4be0148e166d3b4">&#9670;&#160;</a></span>fReOut</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TArrayD NcDSP::fReOut</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../db/da5/_nc_d_s_p_8h_source.html#l00077">77</a> of file <a class="el" href="../../db/da5/_nc_d_s_p_8h_source.html">NcDSP.h</a>.</p>

</div>
</div>
<a id="a5ff8680e1c66ca2defd7ac8a2e17c191" name="a5ff8680e1c66ca2defd7ac8a2e17c191"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ff8680e1c66ca2defd7ac8a2e17c191">&#9670;&#160;</a></span>fSample</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Float_t NcDSP::fSample</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../db/da5/_nc_d_s_p_8h_source.html#l00082">82</a> of file <a class="el" href="../../db/da5/_nc_d_s_p_8h_source.html">NcDSP.h</a>.</p>

</div>
</div>
<a id="a5d4532d92035792cda2b6bf57eb9687c" name="a5d4532d92035792cda2b6bf57eb9687c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d4532d92035792cda2b6bf57eb9687c">&#9670;&#160;</a></span>fWaveform</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TArrayD NcDSP::fWaveform</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../db/da5/_nc_d_s_p_8h_source.html#l00080">80</a> of file <a class="el" href="../../db/da5/_nc_d_s_p_8h_source.html">NcDSP.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>ncfspack/source/<a class="el" href="../../db/da5/_nc_d_s_p_8h_source.html">NcDSP.h</a></li>
<li>ncfspack/source/<a class="el" href="../../d6/d65/_nc_d_s_p_8cxx_source.html">NcDSP.cxx</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../d7/d8a/class_nc_d_s_p.html">NcDSP</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
