<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NCFS-Pack: NcSpectrum Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() { init_search(); });
/* @license-end */
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../ncfslogo.jpg"/></td>
  <td id="projectalign">
   <div id="projectname">NCFS-Pack
   </div>
   <div id="projectbrief">A generic (astro)particle physics analysis framework</div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(1); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('d1/d95/class_nc_spectrum.html','../../'); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="#pro-static-attribs">Static Protected Attributes</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="../../d2/d3a/class_nc_spectrum-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">NcSpectrum Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Facilities for advanced spectral analysis.  
 <a href="#details">More...</a></p>

<p><code>#include &quot;<a class="el" href="../../de/da1/_nc_spectrum_8h_source.html">NcSpectrum.h</a>&quot;</code></p>
<div class="dynheader">
Inheritance diagram for NcSpectrum:</div>
<div class="dyncontent">
 <div class="center">
  <img src="../../d1/d95/class_nc_spectrum.png" alt=""/>
 </div></div>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Facilities for advanced spectral analysis. </p>
<div class="fragment"><div class="line">Copyright (C) 1995-2006, Rene Brun and Fons Rademakers.               *</div>
<div class="line">All rights reserved.                                                  *</div>
<div class="line">                                                                      *</div>
<div class="line">For the licensing terms see $ROOTSYS/LICENSE.                         *</div>
<div class="line">For the list of contributors see $ROOTSYS/README/CREDITS.             *</div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="comment">// Class NcSpectrum</span></div>
<div class="line"><span class="comment">// Facilities for advanced spectral analysis.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// This class contains advanced spectra processing functions for:</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// One-dimensional background estimation</span></div>
<div class="line"><span class="comment">// One-dimensional smoothing</span></div>
<div class="line"><span class="comment">// One-dimensional deconvolution</span></div>
<div class="line"><span class="comment">// One-dimensional peak search</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Author:</span></div>
<div class="line"><span class="comment">// Miroslav Morhac</span></div>
<div class="line"><span class="comment">// Institute of Physics</span></div>
<div class="line"><span class="comment">// Slovak Academy of Sciences</span></div>
<div class="line"><span class="comment">// Dubravska cesta 9, 842 28 BRATISLAVA</span></div>
<div class="line"><span class="comment">// SLOVAKIA</span></div>
<div class="line"><span class="comment">// email:fyzimiro@savba.sk,    fax:+421 7 54772479</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The original code in C has been repackaged as a C++ class by R.Brun.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// The algorithms in this class have been published in the following references:</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Background elimination methods for multidimensional coincidence gamma-ray spectra.</span></div>
<div class="line"><span class="comment">// Nuclear Instruments and Methods in Physics Research A 401 (1997) 113-132.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Efficient one- and two-dimensional Gold deconvolution and its application to gamma-ray spectra decomposition.</span></div>
<div class="line"><span class="comment">// Nuclear Instruments and Methods in Physics Research A 401 (1997) 385-408.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Identification of peaks in multidimensional coincidence gamma-ray spectra.</span></div>
<div class="line"><span class="comment">// Nuclear Instruments and Methods in Research Physics A  443(2000), 108-125.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// This is a copy of the file TSpectrum.cxx from ROOT 5.34/38</span></div>
<div class="line"><span class="comment">// which was created by Miroslav Morhac (27/05/99).</span></div>
<div class="line"><span class="comment">// It has been introduced as NcSpectrum.cxx in order to provide compatible</span></div>
<div class="line"><span class="comment">// functionality within all ROOT versions, such that all the NCFS (based) code</span></div>
<div class="line"><span class="comment">// can remain unchanged, and as such 100% backward (and forward) compatible.</span></div>
<div class="line"><span class="comment">// The incompatibility that was introduced starting from ROOT6 consisted of</span></div>
<div class="line"><span class="comment">// the fact that the Float_t* return arguments were changed into Double_t*.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//- Modified: Nick van Eijndhoven, IIHE-VUB, Brussel, May 7, 2025  07:09Z</span></div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="../../de/da1/_nc_spectrum_8h_source.html#l00026">26</a> of file <a class="el" href="../../de/da1/_nc_spectrum_8h_source.html">NcSpectrum.h</a>.</p>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-types" name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a47d6385726be1ea3b5406485bf0d7dc7" id="r_a47d6385726be1ea3b5406485bf0d7dc7"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom">{ <br />
&#160;&#160;<a class="el" href="#a47d6385726be1ea3b5406485bf0d7dc7a35807771b45db73ad0211b5b80c583d0">kBackOrder2</a> =0
, <a class="el" href="#a47d6385726be1ea3b5406485bf0d7dc7a133139524d7b768d5e8c021afeea488c">kBackOrder4</a> =1
, <a class="el" href="#a47d6385726be1ea3b5406485bf0d7dc7ae9bf42c8575b64dbcb932af8028c2b93">kBackOrder6</a> =2
, <a class="el" href="#a47d6385726be1ea3b5406485bf0d7dc7ac436ed736f0592f694b5099e1aa29838">kBackOrder8</a> =3
, <br />
&#160;&#160;<a class="el" href="#a47d6385726be1ea3b5406485bf0d7dc7aa54ae562fb67e430b08a3f5898430e13">kBackIncreasingWindow</a> =0
, <a class="el" href="#a47d6385726be1ea3b5406485bf0d7dc7ab0218fbef0ebe9ad6d907aa4686596a4">kBackDecreasingWindow</a> =1
, <a class="el" href="#a47d6385726be1ea3b5406485bf0d7dc7ad7af090f39a3ef0a998beb000cbbdaf9">kBackSmoothing3</a> =3
, <a class="el" href="#a47d6385726be1ea3b5406485bf0d7dc7ad626d4c6822a6b8c42f88d01702044ed">kBackSmoothing5</a> =5
, <br />
&#160;&#160;<a class="el" href="#a47d6385726be1ea3b5406485bf0d7dc7a653c47c2eeb80a6e6f2c0d532072a141">kBackSmoothing7</a> =7
, <a class="el" href="#a47d6385726be1ea3b5406485bf0d7dc7a7ea6725442ccf5b35ce92bfb16bbcdd0">kBackSmoothing9</a> =9
, <a class="el" href="#a47d6385726be1ea3b5406485bf0d7dc7a08c185054fe88ee9b09231088c7d2d3f">kBackSmoothing11</a> =11
, <a class="el" href="#a47d6385726be1ea3b5406485bf0d7dc7a65c8eba52308421d1315aff788718d4a">kBackSmoothing13</a> =13
, <br />
&#160;&#160;<a class="el" href="#a47d6385726be1ea3b5406485bf0d7dc7a3e73bb787ca43dc90c00660d3c93e02e">kBackSmoothing15</a> =15
<br />
 }</td></tr>
<tr class="separator:a47d6385726be1ea3b5406485bf0d7dc7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a46379d70c47c5809dae910427b060582" id="r_a46379d70c47c5809dae910427b060582"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a46379d70c47c5809dae910427b060582">NcSpectrum</a> ()</td></tr>
<tr class="separator:a46379d70c47c5809dae910427b060582"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b011be938cbd4ea885544cdb3b3d842" id="r_a0b011be938cbd4ea885544cdb3b3d842"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0b011be938cbd4ea885544cdb3b3d842">NcSpectrum</a> (Int_t maxpositions, Float_t resolution=1)</td></tr>
<tr class="separator:a0b011be938cbd4ea885544cdb3b3d842"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54aa54aa118714871ec0919ac7bcccf7" id="r_a54aa54aa118714871ec0919ac7bcccf7"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a54aa54aa118714871ec0919ac7bcccf7">~NcSpectrum</a> ()</td></tr>
<tr class="separator:a54aa54aa118714871ec0919ac7bcccf7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5d9ebaa9aa85857148d9f36cd1ec33c" id="r_af5d9ebaa9aa85857148d9f36cd1ec33c"><td class="memItemLeft" align="right" valign="top">virtual TH1 *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af5d9ebaa9aa85857148d9f36cd1ec33c">Background</a> (const TH1 *hist, Int_t niter=20, Option_t *option=&quot;&quot;)</td></tr>
<tr class="separator:af5d9ebaa9aa85857148d9f36cd1ec33c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ac7ae787e1364a815f6317bb3409928" id="r_a5ac7ae787e1364a815f6317bb3409928"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5ac7ae787e1364a815f6317bb3409928">Background</a> (float *spectrum, Int_t ssize, Int_t numberIterations, Int_t direction, Int_t filterOrder, bool smoothing, Int_t smoothWindow, bool compton)</td></tr>
<tr class="separator:a5ac7ae787e1364a815f6317bb3409928"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5aa569c5a2d9583966f3566d35bd1e3d" id="r_a5aa569c5a2d9583966f3566d35bd1e3d"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5aa569c5a2d9583966f3566d35bd1e3d">Deconvolution</a> (float *source, const float *response, Int_t ssize, Int_t numberIterations, Int_t numberRepetitions, Double_t boost)</td></tr>
<tr class="separator:a5aa569c5a2d9583966f3566d35bd1e3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae756a0bbd2e82b246492c33407298137" id="r_ae756a0bbd2e82b246492c33407298137"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae756a0bbd2e82b246492c33407298137">DeconvolutionRL</a> (float *source, const float *response, Int_t ssize, Int_t numberIterations, Int_t numberRepetitions, Double_t boost)</td></tr>
<tr class="separator:ae756a0bbd2e82b246492c33407298137"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab11f1cc222e91eeccd410340774f75ea" id="r_ab11f1cc222e91eeccd410340774f75ea"><td class="memItemLeft" align="right" valign="top">TH1 *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab11f1cc222e91eeccd410340774f75ea">GetHistogram</a> () const</td></tr>
<tr class="separator:ab11f1cc222e91eeccd410340774f75ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7079586bed09ed52d5f4749d8d9b11a9" id="r_a7079586bed09ed52d5f4749d8d9b11a9"><td class="memItemLeft" align="right" valign="top">Int_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7079586bed09ed52d5f4749d8d9b11a9">GetNPeaks</a> () const</td></tr>
<tr class="separator:a7079586bed09ed52d5f4749d8d9b11a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88cc8f7cda94dd734bd9d48adc8a6518" id="r_a88cc8f7cda94dd734bd9d48adc8a6518"><td class="memItemLeft" align="right" valign="top">Float_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a88cc8f7cda94dd734bd9d48adc8a6518">GetPositionX</a> () const</td></tr>
<tr class="separator:a88cc8f7cda94dd734bd9d48adc8a6518"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae945bf75012c73653317c103205349e6" id="r_ae945bf75012c73653317c103205349e6"><td class="memItemLeft" align="right" valign="top">Float_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae945bf75012c73653317c103205349e6">GetPositionY</a> () const</td></tr>
<tr class="separator:ae945bf75012c73653317c103205349e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a923dd695cc8bbbae6cd03b49c47416df" id="r_a923dd695cc8bbbae6cd03b49c47416df"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a923dd695cc8bbbae6cd03b49c47416df">Print</a> (Option_t *option=&quot;&quot;) const</td></tr>
<tr class="separator:a923dd695cc8bbbae6cd03b49c47416df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26bb05ce59ac76a5798fd0c600d5a4f2" id="r_a26bb05ce59ac76a5798fd0c600d5a4f2"><td class="memItemLeft" align="right" valign="top">virtual Int_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a26bb05ce59ac76a5798fd0c600d5a4f2">Search</a> (const TH1 *hist, Double_t sigma=2, Option_t *option=&quot;&quot;, Double_t threshold=0.05)</td></tr>
<tr class="separator:a26bb05ce59ac76a5798fd0c600d5a4f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61bd2301f86a31488ab514878d29dbeb" id="r_a61bd2301f86a31488ab514878d29dbeb"><td class="memItemLeft" align="right" valign="top">Int_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a61bd2301f86a31488ab514878d29dbeb">Search1HighRes</a> (float *source, float *destVector, Int_t ssize, float sigma, Double_t threshold, bool backgroundRemove, Int_t deconIterations, bool markov, Int_t averWindow)</td></tr>
<tr class="separator:a61bd2301f86a31488ab514878d29dbeb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ef0ca3a8d6e596900bec773ec4ff508" id="r_a6ef0ca3a8d6e596900bec773ec4ff508"><td class="memItemLeft" align="right" valign="top">Int_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6ef0ca3a8d6e596900bec773ec4ff508">SearchHighRes</a> (float *source, float *destVector, Int_t ssize, float sigma, Double_t threshold, bool backgroundRemove, Int_t deconIterations, bool markov, Int_t averWindow)</td></tr>
<tr class="separator:a6ef0ca3a8d6e596900bec773ec4ff508"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adef98295d4872921c50584157e7bcbbd" id="r_adef98295d4872921c50584157e7bcbbd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adef98295d4872921c50584157e7bcbbd">SetResolution</a> (Float_t resolution=1)</td></tr>
<tr class="separator:adef98295d4872921c50584157e7bcbbd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adda88c99031602639b32a1d0df7e38be" id="r_adda88c99031602639b32a1d0df7e38be"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adda88c99031602639b32a1d0df7e38be">SmoothMarkov</a> (float *source, Int_t ssize, Int_t averWindow)</td></tr>
<tr class="separator:adda88c99031602639b32a1d0df7e38be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae735efe2ca607bce8d835ca928611bd9" id="r_ae735efe2ca607bce8d835ca928611bd9"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae735efe2ca607bce8d835ca928611bd9">Unfolding</a> (float *source, const float **respMatrix, Int_t ssizex, Int_t ssizey, Int_t numberIterations, Int_t numberRepetitions, Double_t boost)</td></tr>
<tr class="separator:ae735efe2ca607bce8d835ca928611bd9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-static-methods" name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:ab595c5f7ecd5ea0ecd12c49176e28212" id="r_ab595c5f7ecd5ea0ecd12c49176e28212"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab595c5f7ecd5ea0ecd12c49176e28212">SetAverageWindow</a> (Int_t w=3)</td></tr>
<tr class="separator:ab595c5f7ecd5ea0ecd12c49176e28212"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f4b1232eee5af4d41f7676d0dcd1233" id="r_a3f4b1232eee5af4d41f7676d0dcd1233"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3f4b1232eee5af4d41f7676d0dcd1233">SetDeconIterations</a> (Int_t n=3)</td></tr>
<tr class="separator:a3f4b1232eee5af4d41f7676d0dcd1233"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23e8c63f833c391897e38408cf8901d2" id="r_a23e8c63f833c391897e38408cf8901d2"><td class="memItemLeft" align="right" valign="top">static TH1 *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a23e8c63f833c391897e38408cf8901d2">StaticBackground</a> (const TH1 *hist, Int_t niter=20, Option_t *option=&quot;&quot;)</td></tr>
<tr class="separator:a23e8c63f833c391897e38408cf8901d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a247b66859a54abc62f3c42d2cad8fcaf" id="r_a247b66859a54abc62f3c42d2cad8fcaf"><td class="memItemLeft" align="right" valign="top">static Int_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a247b66859a54abc62f3c42d2cad8fcaf">StaticSearch</a> (const TH1 *hist, Double_t sigma=2, Option_t *option=&quot;goff&quot;, Double_t threshold=0.05)</td></tr>
<tr class="separator:a247b66859a54abc62f3c42d2cad8fcaf"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-attribs" name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:ae7736adfee8b27bdd733cce4e7235e32" id="r_ae7736adfee8b27bdd733cce4e7235e32"><td class="memItemLeft" align="right" valign="top">TH1 *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae7736adfee8b27bdd733cce4e7235e32">fHistogram</a></td></tr>
<tr class="separator:ae7736adfee8b27bdd733cce4e7235e32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba8972fa4f6284ce6dd6ca7a56d22358" id="r_aba8972fa4f6284ce6dd6ca7a56d22358"><td class="memItemLeft" align="right" valign="top">Int_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aba8972fa4f6284ce6dd6ca7a56d22358">fMaxPeaks</a></td></tr>
<tr class="separator:aba8972fa4f6284ce6dd6ca7a56d22358"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3dec61e8c65baf4804d2d1e56e402f0" id="r_af3dec61e8c65baf4804d2d1e56e402f0"><td class="memItemLeft" align="right" valign="top">Int_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af3dec61e8c65baf4804d2d1e56e402f0">fNPeaks</a></td></tr>
<tr class="separator:af3dec61e8c65baf4804d2d1e56e402f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74708032eb1a9796c7d6c978e026aee3" id="r_a74708032eb1a9796c7d6c978e026aee3"><td class="memItemLeft" align="right" valign="top">Float_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a74708032eb1a9796c7d6c978e026aee3">fPosition</a></td></tr>
<tr class="separator:a74708032eb1a9796c7d6c978e026aee3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39e1200c4fda52e4fbe249efe319417a" id="r_a39e1200c4fda52e4fbe249efe319417a"><td class="memItemLeft" align="right" valign="top">Float_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a39e1200c4fda52e4fbe249efe319417a">fPositionX</a></td></tr>
<tr class="separator:a39e1200c4fda52e4fbe249efe319417a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adca33b3120c85d8ab12aaee124cd210b" id="r_adca33b3120c85d8ab12aaee124cd210b"><td class="memItemLeft" align="right" valign="top">Float_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adca33b3120c85d8ab12aaee124cd210b">fPositionY</a></td></tr>
<tr class="separator:adca33b3120c85d8ab12aaee124cd210b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38f2353b9a3b30c608c5ec40167d2630" id="r_a38f2353b9a3b30c608c5ec40167d2630"><td class="memItemLeft" align="right" valign="top">Float_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a38f2353b9a3b30c608c5ec40167d2630">fResolution</a></td></tr>
<tr class="separator:a38f2353b9a3b30c608c5ec40167d2630"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-static-attribs" name="pro-static-attribs"></a>
Static Protected Attributes</h2></td></tr>
<tr class="memitem:a385d3be870dc7f18eefa2cbd761a3b20" id="r_a385d3be870dc7f18eefa2cbd761a3b20"><td class="memItemLeft" align="right" valign="top">static Int_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a385d3be870dc7f18eefa2cbd761a3b20">fgAverageWindow</a> = 3</td></tr>
<tr class="separator:a385d3be870dc7f18eefa2cbd761a3b20"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5eaccc50d73d4ca438fb9fa7ebd4b7c1" id="r_a5eaccc50d73d4ca438fb9fa7ebd4b7c1"><td class="memItemLeft" align="right" valign="top">static Int_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5eaccc50d73d4ca438fb9fa7ebd4b7c1">fgIterations</a> = 3</td></tr>
<tr class="separator:a5eaccc50d73d4ca438fb9fa7ebd4b7c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-methods" name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a778a593c5a748045e1f7fa56137cc827" id="r_a778a593c5a748045e1f7fa56137cc827"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a778a593c5a748045e1f7fa56137cc827">NcSpectrum</a> (const <a class="el" href="../../d1/d95/class_nc_spectrum.html">NcSpectrum</a> &amp;)</td></tr>
<tr class="separator:a778a593c5a748045e1f7fa56137cc827"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a353d75294b3b83b34de20b71f5623130" id="r_a353d75294b3b83b34de20b71f5623130"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d1/d95/class_nc_spectrum.html">NcSpectrum</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a353d75294b3b83b34de20b71f5623130">operator=</a> (const <a class="el" href="../../d1/d95/class_nc_spectrum.html">NcSpectrum</a> &amp;)</td></tr>
<tr class="separator:a353d75294b3b83b34de20b71f5623130"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Member Enumeration Documentation</h2>
<a id="a47d6385726be1ea3b5406485bf0d7dc7" name="a47d6385726be1ea3b5406485bf0d7dc7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a47d6385726be1ea3b5406485bf0d7dc7">&#9670;&#160;</a></span>anonymous enum</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">anonymous enum</td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a47d6385726be1ea3b5406485bf0d7dc7a35807771b45db73ad0211b5b80c583d0" name="a47d6385726be1ea3b5406485bf0d7dc7a35807771b45db73ad0211b5b80c583d0"></a>kBackOrder2&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a47d6385726be1ea3b5406485bf0d7dc7a133139524d7b768d5e8c021afeea488c" name="a47d6385726be1ea3b5406485bf0d7dc7a133139524d7b768d5e8c021afeea488c"></a>kBackOrder4&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a47d6385726be1ea3b5406485bf0d7dc7ae9bf42c8575b64dbcb932af8028c2b93" name="a47d6385726be1ea3b5406485bf0d7dc7ae9bf42c8575b64dbcb932af8028c2b93"></a>kBackOrder6&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a47d6385726be1ea3b5406485bf0d7dc7ac436ed736f0592f694b5099e1aa29838" name="a47d6385726be1ea3b5406485bf0d7dc7ac436ed736f0592f694b5099e1aa29838"></a>kBackOrder8&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a47d6385726be1ea3b5406485bf0d7dc7aa54ae562fb67e430b08a3f5898430e13" name="a47d6385726be1ea3b5406485bf0d7dc7aa54ae562fb67e430b08a3f5898430e13"></a>kBackIncreasingWindow&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a47d6385726be1ea3b5406485bf0d7dc7ab0218fbef0ebe9ad6d907aa4686596a4" name="a47d6385726be1ea3b5406485bf0d7dc7ab0218fbef0ebe9ad6d907aa4686596a4"></a>kBackDecreasingWindow&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a47d6385726be1ea3b5406485bf0d7dc7ad7af090f39a3ef0a998beb000cbbdaf9" name="a47d6385726be1ea3b5406485bf0d7dc7ad7af090f39a3ef0a998beb000cbbdaf9"></a>kBackSmoothing3&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a47d6385726be1ea3b5406485bf0d7dc7ad626d4c6822a6b8c42f88d01702044ed" name="a47d6385726be1ea3b5406485bf0d7dc7ad626d4c6822a6b8c42f88d01702044ed"></a>kBackSmoothing5&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a47d6385726be1ea3b5406485bf0d7dc7a653c47c2eeb80a6e6f2c0d532072a141" name="a47d6385726be1ea3b5406485bf0d7dc7a653c47c2eeb80a6e6f2c0d532072a141"></a>kBackSmoothing7&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a47d6385726be1ea3b5406485bf0d7dc7a7ea6725442ccf5b35ce92bfb16bbcdd0" name="a47d6385726be1ea3b5406485bf0d7dc7a7ea6725442ccf5b35ce92bfb16bbcdd0"></a>kBackSmoothing9&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a47d6385726be1ea3b5406485bf0d7dc7a08c185054fe88ee9b09231088c7d2d3f" name="a47d6385726be1ea3b5406485bf0d7dc7a08c185054fe88ee9b09231088c7d2d3f"></a>kBackSmoothing11&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a47d6385726be1ea3b5406485bf0d7dc7a65c8eba52308421d1315aff788718d4a" name="a47d6385726be1ea3b5406485bf0d7dc7a65c8eba52308421d1315aff788718d4a"></a>kBackSmoothing13&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a47d6385726be1ea3b5406485bf0d7dc7a3e73bb787ca43dc90c00660d3c93e02e" name="a47d6385726be1ea3b5406485bf0d7dc7a3e73bb787ca43dc90c00660d3c93e02e"></a>kBackSmoothing15&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="../../de/da1/_nc_spectrum_8h_source.html#l00044">44</a> of file <a class="el" href="../../de/da1/_nc_spectrum_8h_source.html">NcSpectrum.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a778a593c5a748045e1f7fa56137cc827" name="a778a593c5a748045e1f7fa56137cc827"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a778a593c5a748045e1f7fa56137cc827">&#9670;&#160;</a></span>NcSpectrum() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">NcSpectrum::NcSpectrum </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d1/d95/class_nc_spectrum.html">NcSpectrum</a> &amp;</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a46379d70c47c5809dae910427b060582" name="a46379d70c47c5809dae910427b060582"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a46379d70c47c5809dae910427b060582">&#9670;&#160;</a></span>NcSpectrum() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">NcSpectrum::NcSpectrum </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="comment">// Constructor.</span></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../df/dc3/_nc_spectrum_8cxx_source.html#l00083">83</a> of file <a class="el" href="../../df/dc3/_nc_spectrum_8cxx_source.html">NcSpectrum.cxx</a>.</p>

</div>
</div>
<a id="a0b011be938cbd4ea885544cdb3b3d842" name="a0b011be938cbd4ea885544cdb3b3d842"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b011be938cbd4ea885544cdb3b3d842">&#9670;&#160;</a></span>NcSpectrum() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">NcSpectrum::NcSpectrum </td>
          <td>(</td>
          <td class="paramtype">Int_t</td>          <td class="paramname"><span class="paramname"><em>maxpositions</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Float_t</td>          <td class="paramname"><span class="paramname"><em>resolution</em></span><span class="paramdefsep"> = </span><span class="paramdefval">1</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="comment">// maxpositions: maximum number of peaks</span></div>
<div class="line"><span class="comment">// resolution: determines resolution of the neighboring peaks</span></div>
<div class="line"><span class="comment">//             default value is 1 correspond to 3 sigma distance</span></div>
<div class="line"><span class="comment">//             between peaks. Higher values allow higher resolution</span></div>
<div class="line"><span class="comment">//             (smaller distance between peaks.</span></div>
<div class="line"><span class="comment">//             May be set later through SetResolution.</span></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../df/dc3/_nc_spectrum_8cxx_source.html#l00103">103</a> of file <a class="el" href="../../df/dc3/_nc_spectrum_8cxx_source.html">NcSpectrum.cxx</a>.</p>

</div>
</div>
<a id="a54aa54aa118714871ec0919ac7bcccf7" name="a54aa54aa118714871ec0919ac7bcccf7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a54aa54aa118714871ec0919ac7bcccf7">&#9670;&#160;</a></span>~NcSpectrum()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">NcSpectrum::~NcSpectrum </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel virtual">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="comment">// Destructor.</span></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../df/dc3/_nc_spectrum_8cxx_source.html#l00130">130</a> of file <a class="el" href="../../df/dc3/_nc_spectrum_8cxx_source.html">NcSpectrum.cxx</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="af5d9ebaa9aa85857148d9f36cd1ec33c" name="af5d9ebaa9aa85857148d9f36cd1ec33c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af5d9ebaa9aa85857148d9f36cd1ec33c">&#9670;&#160;</a></span>Background() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual TH1 * NcSpectrum::Background </td>
          <td>(</td>
          <td class="paramtype">const TH1 *</td>          <td class="paramname"><span class="paramname"><em>hist</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t</td>          <td class="paramname"><span class="paramname"><em>niter</em></span><span class="paramdefsep"> = </span><span class="paramdefval">20</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Option_t *</td>          <td class="paramname"><span class="paramname"><em>option</em></span><span class="paramdefsep"> = </span><span class="paramdefval">&quot;&quot;</span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel virtual">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a5ac7ae787e1364a815f6317bb3409928" name="a5ac7ae787e1364a815f6317bb3409928"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ac7ae787e1364a815f6317bb3409928">&#9670;&#160;</a></span>Background() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char * NcSpectrum::Background </td>
          <td>(</td>
          <td class="paramtype">float *</td>          <td class="paramname"><span class="paramname"><em>spectrum</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t</td>          <td class="paramname"><span class="paramname"><em>ssize</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t</td>          <td class="paramname"><span class="paramname"><em>numberIterations</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t</td>          <td class="paramname"><span class="paramname"><em>direction</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t</td>          <td class="paramname"><span class="paramname"><em>filterOrder</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>smoothing</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t</td>          <td class="paramname"><span class="paramname"><em>smoothWindow</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>compton</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a5aa569c5a2d9583966f3566d35bd1e3d" name="a5aa569c5a2d9583966f3566d35bd1e3d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5aa569c5a2d9583966f3566d35bd1e3d">&#9670;&#160;</a></span>Deconvolution()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char * NcSpectrum::Deconvolution </td>
          <td>(</td>
          <td class="paramtype">float *</td>          <td class="paramname"><span class="paramname"><em>source</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float *</td>          <td class="paramname"><span class="paramname"><em>response</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t</td>          <td class="paramname"><span class="paramname"><em>ssize</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t</td>          <td class="paramname"><span class="paramname"><em>numberIterations</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t</td>          <td class="paramname"><span class="paramname"><em>numberRepetitions</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Double_t</td>          <td class="paramname"><span class="paramname"><em>boost</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="comment">//   One-dimensional deconvolution function</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   This function calculates deconvolution from source spectrum according to</span></div>
<div class="line"><span class="comment">//   response spectrum using Gold deconvolution algorithm. The result is placed</span></div>
<div class="line"><span class="comment">//   in the vector pointed by source pointer. On successful completion it</span></div>
<div class="line"><span class="comment">//   returns 0. On error it returns pointer to the string describing error. If</span></div>
<div class="line"><span class="comment">//   desired after every numberIterations one can apply boosting operation</span></div>
<div class="line"><span class="comment">//   (exponential function with exponent given by boost coefficient) and repeat</span></div>
<div class="line"><span class="comment">//   it numberRepetitions times.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   Function parameters:</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   source:  pointer to the vector of source spectrum</span></div>
<div class="line"><span class="comment">//   response:     pointer to the vector of response spectrum</span></div>
<div class="line"><span class="comment">//   ssize:    length of source and response spectra</span></div>
<div class="line"><span class="comment">//   numberIterations, for details we refer to the reference given below</span></div>
<div class="line"><span class="comment">//   numberRepetitions, for repeated boosted deconvolution</span></div>
<div class="line"><span class="comment">//   boost, boosting coefficient</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   The goal of this function is the improvement of the resolution in spectra,</span></div>
<div class="line"><span class="comment">//   decomposition of multiplets. The mathematical formulation of</span></div>
<div class="line"><span class="comment">//   the convolution system is:</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   &lt;img width=585 height=84 src=&quot;gif/NcSpectrum_Deconvolution1.gif&quot;&gt;</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   where h(i) is the impulse response function, x, y are input and output</span></div>
<div class="line"><span class="comment">//   vectors, respectively, N is the length of x and h vectors. In matrix form</span></div>
<div class="line"><span class="comment">//   we have:</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   &lt;img width=597 height=360 src=&quot;gif/NcSpectrum_Deconvolution2.gif&quot;&gt;</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   Let us assume that we know the response and the output vector (spectrum) of</span></div>
<div class="line"><span class="comment">//   the above given system. The deconvolution represents solution of the</span></div>
<div class="line"><span class="comment">//   overdetermined system of linear equations, i.e., the calculation of the</span></div>
<div class="line"><span class="comment">//   vector x. From numerical stability point of view the operation of</span></div>
<div class="line"><span class="comment">//   deconvolution is extremely critical (ill-posed problem) as well as time</span></div>
<div class="line"><span class="comment">//   consuming operation. The Gold deconvolution algorithm proves to work very</span></div>
<div class="line"><span class="comment">//   well, other methods (Fourier, VanCittert etc) oscillate. It is suitable to</span></div>
<div class="line"><span class="comment">//   process positive definite data (e.g. histograms).</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   Gold deconvolution algorithm:</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   &lt;img width=551 height=233 src=&quot;gif/NcSpectrum_Deconvolution3.gif&quot;&gt;</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   Where L is given number of iterations (numberIterations parameter).</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   Boosted deconvolution:</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   Set the initial solution:</span></div>
<div class="line"><span class="comment">//   x^{(0)} = [1,1,...,1]^{T}</span></div>
<div class="line"><span class="comment">//   Set required number of repetitions R and iterations L.</span></div>
<div class="line"><span class="comment">//   Set r = 1.</span></div>
<div class="line"><span class="comment">//   Using Gold deconvolution algorithm for k=1,2,...,L find x^(L)</span></div>
<div class="line"><span class="comment">//   If r = R stop calculation, else</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   Apply boosting operation, i.e., set</span></div>
<div class="line"><span class="comment">//   x^{(0)}(i) = [x^{(L)}(i)]^{p}</span></div>
<div class="line"><span class="comment">//   i=0,1,...N-1 and p is boosting coefficient &amp;gt;0.</span></div>
<div class="line"><span class="comment">//   r = r + 1</span></div>
<div class="line"><span class="comment">//   continue in 4.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   References:</span></div>
<div class="line"><span class="comment">//   Gold R., ANL-6984, Argonne National Laboratories, Argonne Ill, 1964.</span></div>
<div class="line"><span class="comment">//   Coote G.E., Iterative smoothing and deconvolution of one- and two-dimensional</span></div>
<div class="line"><span class="comment">//   elemental distribution data, NIM B 130 (1997) 118.</span></div>
<div class="line"><span class="comment">//   Efficient one- and two-dimensional Gold deconvolution and</span></div>
<div class="line"><span class="comment">//   its application to gamma-ray spectra decomposition. NIM, A401 (1997) 385-408.</span></div>
<div class="line"><span class="comment">//   Efficient algorithm of multidimensional deconvolution and its application to nuclear data processing</span></div>
<div class="line"><span class="comment">//   Digital Signal Processing 13 (2003) 144.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   Example 8 - script Deconvolution.c :</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   response function (usually peak) should be shifted left to the first</span></div>
<div class="line"><span class="comment">//   non-zero channel (bin) (see Figure 9)</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   &lt;img width=600 height=340 src=&quot;gif/NcSpectrum_Deconvolution1.jpg&quot;&gt;</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   Figure 9 Response spectrum.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   &lt;img width=946 height=407 src=&quot;gif/NcSpectrum_Deconvolution2.jpg&quot;&gt;</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   Figure 10 Principle how the response matrix is composed inside of the</span></div>
<div class="line"><span class="comment">//   Deconvolution function.</span></div>
<div class="line"><span class="comment">//   &lt;img width=601 height=407 src=&quot;gif/NcSpectrum_Deconvolution3.jpg&quot;&gt;</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   Figure 11 Example of Gold deconvolution. The original source spectrum is</span></div>
<div class="line"><span class="comment">//   drawn with black color, the spectrum after the deconvolution (10000</span></div>
<div class="line"><span class="comment">//   iterations) with red color.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   Script:</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Example to illustrate deconvolution function (class NcSpectrum).</span></div>
<div class="line"><span class="comment">// To execute this example, do</span></div>
<div class="line"><span class="comment">// root &gt; .x Deconvolution.C</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   #include &lt;NcSpectrum&gt;</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   void Deconvolution() {</span></div>
<div class="line"><span class="comment">//      Int_t i;</span></div>
<div class="line"><span class="comment">//      Double_t nbins = 256;</span></div>
<div class="line"><span class="comment">//      Double_t xmin  = 0;</span></div>
<div class="line"><span class="comment">//      Double_t xmax  = (Double_t)nbins;</span></div>
<div class="line"><span class="comment">//      Float_t * source = new float[nbins];</span></div>
<div class="line"><span class="comment">//      Float_t * response = new float[nbins];</span></div>
<div class="line"><span class="comment">//      TH1F *h = new TH1F(&quot;h&quot;,&quot;Deconvolution&quot;,nbins,xmin,xmax);</span></div>
<div class="line"><span class="comment">//      TH1F *d = new TH1F(&quot;d&quot;,&quot;&quot;,nbins,xmin,xmax);</span></div>
<div class="line"><span class="comment">//      TFile *f = new TFile(&quot;spectra\\NcSpectrum.root&quot;);</span></div>
<div class="line"><span class="comment">//      h=(TH1F*) f-&gt;Get(&quot;decon1;1&quot;);</span></div>
<div class="line"><span class="comment">//      TFile *fr = new TFile(&quot;spectra\\NcSpectrum.root&quot;);</span></div>
<div class="line"><span class="comment">//      d=(TH1F*) fr-&gt;Get(&quot;decon_response;1&quot;);</span></div>
<div class="line"><span class="comment">//      for (i = 0; i &lt; nbins; i++) source[i]=h-&gt;GetBinContent(i + 1);</span></div>
<div class="line"><span class="comment">//      for (i = 0; i &lt; nbins; i++) response[i]=d-&gt;GetBinContent(i + 1);</span></div>
<div class="line"><span class="comment">//      TCanvas *Decon1 = gROOT-&gt;GetListOfCanvases()-&gt;FindObject(&quot;Decon1&quot;);</span></div>
<div class="line"><span class="comment">//      if (!Decon1) Decon1 = new TCanvas(&quot;Decon1&quot;,&quot;Decon1&quot;,10,10,1000,700);</span></div>
<div class="line"><span class="comment">//      h-&gt;Draw(&quot;L&quot;);</span></div>
<div class="line"><span class="comment">//      NcSpectrum *s = new NcSpectrum();</span></div>
<div class="line"><span class="comment">//      s-&gt;Deconvolution(source,response,256,1000,1,1);</span></div>
<div class="line"><span class="comment">//      for (i = 0; i &lt; nbins; i++) d-&gt;SetBinContent(i + 1,source[i]);</span></div>
<div class="line"><span class="comment">//      d-&gt;SetLineColor(kRed);</span></div>
<div class="line"><span class="comment">//      d-&gt;Draw(&quot;SAME L&quot;);</span></div>
<div class="line"><span class="comment">//   }</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   Examples of Gold deconvolution method:</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   First let us study the influence of the number of iterations on the</span></div>
<div class="line"><span class="comment">//   deconvolved spectrum (Figure 12).</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   &lt;img width=602 height=409 src=&quot;gif/NcSpectrum_Deconvolution_wide1.jpg&quot;&gt;</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   Figure 12 Study of Gold deconvolution algorithm.The original source spectrum</span></div>
<div class="line"><span class="comment">//   is drawn with black color, spectrum after 100 iterations with red color,</span></div>
<div class="line"><span class="comment">//   spectrum after 1000 iterations with blue color, spectrum after 10000</span></div>
<div class="line"><span class="comment">//   iterations with green color and spectrum after 100000 iterations with</span></div>
<div class="line"><span class="comment">//   magenta color.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   For relatively narrow peaks in the above given example the Gold</span></div>
<div class="line"><span class="comment">//   deconvolution method is able to decompose overlapping peaks practically to</span></div>
<div class="line"><span class="comment">//   delta - functions. In the next example we have chosen a synthetic data</span></div>
<div class="line"><span class="comment">//   (spectrum, 256 channels) consisting of 5 very closely positioned, relatively</span></div>
<div class="line"><span class="comment">//   wide peaks (sigma =5), with added noise (Figure 13). Thin lines represent</span></div>
<div class="line"><span class="comment">//   pure Gaussians (see Table 1); thick line is a resulting spectrum with</span></div>
<div class="line"><span class="comment">//   additive noise (10% of the amplitude of small peaks).</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   &lt;img width=600 height=367 src=&quot;gif/NcSpectrum_Deconvolution_wide2.jpg&quot;&gt;</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   Figure 13 Testing example of synthetic spectrum composed of 5 Gaussians with</span></div>
<div class="line"><span class="comment">//   added noise.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   In ideal case, we should obtain the result given in Figure 14. The areas of</span></div>
<div class="line"><span class="comment">//   the Gaussian components of the spectrum are concentrated completely to</span></div>
<div class="line"><span class="comment">//   delta-functions. When solving the overdetermined system of linear equations</span></div>
<div class="line"><span class="comment">//   with data from Figure 13 in the sense of minimum least squares criterion</span></div>
<div class="line"><span class="comment">//   without any regularization we obtain the result with large oscillations</span></div>
<div class="line"><span class="comment">//   (Figure 15). From mathematical point of view, it is the optimal solution in</span></div>
<div class="line"><span class="comment">//   the unconstrained space of independent variables. From physical point of</span></div>
<div class="line"><span class="comment">//   view we are interested only in a meaningful solution. Therefore, we have to</span></div>
<div class="line"><span class="comment">//   employ regularization techniques (e.g. Gold deconvolution) and/or to</span></div>
<div class="line"><span class="comment">//   confine the space of allowed solutions to subspace of positive solutions.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   &lt;img width=589 height=189 src=&quot;gif/NcSpectrum_Deconvolution_wide3.jpg&quot;&gt;</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   Figure 14 The same spectrum like in Figure 13, outlined bars show the</span></div>
<div class="line"><span class="comment">//   contents of present components (peaks).</span></div>
<div class="line"><span class="comment">//   &lt;img width=585 height=183 src=&quot;gif/NcSpectrum_Deconvolution_wide4.jpg&quot;&gt;</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   Figure 15 Least squares solution of the system of linear equations without</span></div>
<div class="line"><span class="comment">//   regularization.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   Example 9 - script Deconvolution_wide.c</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   When we employ Gold deconvolution algorithm we obtain the result given in</span></div>
<div class="line"><span class="comment">//   Fig. 16. One can observe that the resulting spectrum is smooth. On the</span></div>
<div class="line"><span class="comment">//   other hand the method is not able to decompose completely the peaks in the</span></div>
<div class="line"><span class="comment">//   spectrum.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   &lt;img width=601 height=407 src=&quot;gif/NcSpectrum_Deconvolution_wide5.jpg&quot;&gt;</span></div>
<div class="line"><span class="comment">//   Figure 16 Example of Gold deconvolution for closely positioned wide peaks.</span></div>
<div class="line"><span class="comment">//   The original source spectrum is drawn with black color, the spectrum after</span></div>
<div class="line"><span class="comment">//   the deconvolution (10000 iterations) with red color.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   Script:</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Example to illustrate deconvolution function (class NcSpectrum).</span></div>
<div class="line"><span class="comment">// To execute this example, do</span></div>
<div class="line"><span class="comment">// root &gt; .x Deconvolution_wide.C</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   #include &lt;NcSpectrum&gt;</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   void Deconvolution_wide() {</span></div>
<div class="line"><span class="comment">//      Int_t i;</span></div>
<div class="line"><span class="comment">//      Double_t nbins = 256;</span></div>
<div class="line"><span class="comment">//      Double_t xmin  = 0;</span></div>
<div class="line"><span class="comment">//      Double_t xmax  = (Double_t)nbins;</span></div>
<div class="line"><span class="comment">//      Float_t * source = new float[nbins];</span></div>
<div class="line"><span class="comment">//      Float_t * response = new float[nbins];</span></div>
<div class="line"><span class="comment">//      TH1F *h = new TH1F(&quot;h&quot;,&quot;Deconvolution&quot;,nbins,xmin,xmax);</span></div>
<div class="line"><span class="comment">//      TH1F *d = new TH1F(&quot;d&quot;,&quot;&quot;,nbins,xmin,xmax);</span></div>
<div class="line"><span class="comment">//      TFile *f = new TFile(&quot;spectra\\NcSpectrum.root&quot;);</span></div>
<div class="line"><span class="comment">//      h=(TH1F*) f-&gt;Get(&quot;decon3;1&quot;);</span></div>
<div class="line"><span class="comment">//      TFile *fr = new TFile(&quot;spectra\\NcSpectrum.root&quot;);</span></div>
<div class="line"><span class="comment">//      d=(TH1F*) fr-&gt;Get(&quot;decon_response_wide;1&quot;);</span></div>
<div class="line"><span class="comment">//      for (i = 0; i &lt; nbins; i++) source[i]=h-&gt;GetBinContent(i + 1);</span></div>
<div class="line"><span class="comment">//      for (i = 0; i &lt; nbins; i++) response[i]=d-&gt;GetBinContent(i + 1);</span></div>
<div class="line"><span class="comment">//      TCanvas *Decon1 = gROOT-&gt;GetListOfCanvases()-&gt;FindObject(&quot;Decon1&quot;);</span></div>
<div class="line"><span class="comment">//      if (!Decon1) Decon1 = new TCanvas(&quot;Decon1&quot;,</span></div>
<div class="line"><span class="comment">//      &quot;Deconvolution of closely positioned overlapping peaks using Gold deconvolution method&quot;,10,10,1000,700);</span></div>
<div class="line"><span class="comment">//      h-&gt;SetMaximum(30000);</span></div>
<div class="line"><span class="comment">//      h-&gt;Draw(&quot;L&quot;);</span></div>
<div class="line"><span class="comment">//      NcSpectrum *s = new NcSpectrum();</span></div>
<div class="line"><span class="comment">//      s-&gt;Deconvolution(source,response,256,10000,1,1);</span></div>
<div class="line"><span class="comment">//      for (i = 0; i &lt; nbins; i++) d-&gt;SetBinContent(i + 1,source[i]);</span></div>
<div class="line"><span class="comment">//      d-&gt;SetLineColor(kRed);</span></div>
<div class="line"><span class="comment">//      d-&gt;Draw(&quot;SAME L&quot;);</span></div>
<div class="line"><span class="comment">//   }</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   Example 10 - script Deconvolution_wide_boost.c :</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   Further let us employ boosting operation into deconvolution (Fig. 17).</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   &lt;img width=601 height=407 src=&quot;gif/NcSpectrum_Deconvolution_wide6.jpg&quot;&gt;</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   Figure 17 The original source spectrum is drawn with black color, the</span></div>
<div class="line"><span class="comment">//   spectrum after the deconvolution with red color. Number of iterations = 200,</span></div>
<div class="line"><span class="comment">//   number of repetitions = 50 and boosting coefficient = 1.2.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   One can observe that peaks are decomposed practically to delta functions.</span></div>
<div class="line"><span class="comment">//   Number of peaks is correct, positions of big peaks as well as their areas</span></div>
<div class="line"><span class="comment">//   are relatively well estimated. However there is a considerable error in</span></div>
<div class="line"><span class="comment">//   the estimation of the position of small right hand peak.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   Script:</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Example to illustrate deconvolution function (class NcSpectrum).</span></div>
<div class="line"><span class="comment">// To execute this example, do</span></div>
<div class="line"><span class="comment">// root &gt; .x Deconvolution_wide_boost.C</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   #include &lt;NcSpectrum&gt;</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   void Deconvolution_wide_boost() {</span></div>
<div class="line"><span class="comment">//      Int_t i;</span></div>
<div class="line"><span class="comment">//      Double_t nbins = 256;</span></div>
<div class="line"><span class="comment">//      Double_t xmin  = 0;</span></div>
<div class="line"><span class="comment">//      Double_t xmax  = (Double_t)nbins;</span></div>
<div class="line"><span class="comment">//      Float_t * source = new float[nbins];</span></div>
<div class="line"><span class="comment">//      Float_t * response = new float[nbins];</span></div>
<div class="line"><span class="comment">//      TH1F *h = new TH1F(&quot;h&quot;,&quot;Deconvolution&quot;,nbins,xmin,xmax);</span></div>
<div class="line"><span class="comment">//      TH1F *d = new TH1F(&quot;d&quot;,&quot;&quot;,nbins,xmin,xmax);</span></div>
<div class="line"><span class="comment">//      TFile *f = new TFile(&quot;spectra\\NcSpectrum.root&quot;);</span></div>
<div class="line"><span class="comment">//      h=(TH1F*) f-&gt;Get(&quot;decon3;1&quot;);</span></div>
<div class="line"><span class="comment">//      TFile *fr = new TFile(&quot;spectra\\NcSpectrum.root&quot;);</span></div>
<div class="line"><span class="comment">//      d=(TH1F*) fr-&gt;Get(&quot;decon_response_wide;1&quot;);</span></div>
<div class="line"><span class="comment">//      for (i = 0; i &lt; nbins; i++) source[i]=h-&gt;GetBinContent(i + 1);</span></div>
<div class="line"><span class="comment">//      for (i = 0; i &lt; nbins; i++) response[i]=d-&gt;GetBinContent(i + 1);</span></div>
<div class="line"><span class="comment">//      TCanvas *Decon1 = gROOT-&gt;GetListOfCanvases()-&gt;FindObject(&quot;Decon1&quot;);</span></div>
<div class="line"><span class="comment">//      if (!Decon1) Decon1 = new TCanvas(&quot;Decon1&quot;,</span></div>
<div class="line"><span class="comment">//      &quot;Deconvolution of closely positioned overlapping peaks using boosted Gold deconvolution method&quot;,10,10,1000,700);</span></div>
<div class="line"><span class="comment">//      h-&gt;SetMaximum(110000);</span></div>
<div class="line"><span class="comment">//      h-&gt;Draw(&quot;L&quot;);</span></div>
<div class="line"><span class="comment">//      NcSpectrum *s = new NcSpectrum();</span></div>
<div class="line"><span class="comment">//      s-&gt;Deconvolution(source,response,256,200,50,1.2);</span></div>
<div class="line"><span class="comment">//      for (i = 0; i &lt; nbins; i++) d-&gt;SetBinContent(i + 1,source[i]);</span></div>
<div class="line"><span class="comment">//      d-&gt;SetLineColor(kRed);</span></div>
<div class="line"><span class="comment">//      d-&gt;Draw(&quot;SAME L&quot;);</span></div>
<div class="line"><span class="comment">//   }</span></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../df/dc3/_nc_spectrum_8cxx_source.html#l01659">1659</a> of file <a class="el" href="../../df/dc3/_nc_spectrum_8cxx_source.html">NcSpectrum.cxx</a>.</p>

</div>
</div>
<a id="ae756a0bbd2e82b246492c33407298137" name="ae756a0bbd2e82b246492c33407298137"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae756a0bbd2e82b246492c33407298137">&#9670;&#160;</a></span>DeconvolutionRL()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char * NcSpectrum::DeconvolutionRL </td>
          <td>(</td>
          <td class="paramtype">float *</td>          <td class="paramname"><span class="paramname"><em>source</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float *</td>          <td class="paramname"><span class="paramname"><em>response</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t</td>          <td class="paramname"><span class="paramname"><em>ssize</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t</td>          <td class="paramname"><span class="paramname"><em>numberIterations</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t</td>          <td class="paramname"><span class="paramname"><em>numberRepetitions</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Double_t</td>          <td class="paramname"><span class="paramname"><em>boost</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="comment">//   One-dimensional deconvolution function.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   This function calculates deconvolution from source spectrum according to</span></div>
<div class="line"><span class="comment">//   response spectrum using Richardson-Lucy deconvolution algorithm. The result</span></div>
<div class="line"><span class="comment">//   is placed in the vector pointed by source pointer. On successful completion</span></div>
<div class="line"><span class="comment">//   it returns 0. On error it returns pointer to the string describing error.</span></div>
<div class="line"><span class="comment">//   If desired after every numberIterations one can apply boosting operation</span></div>
<div class="line"><span class="comment">//   (exponential function with exponent given by boost coefficient) and repeat</span></div>
<div class="line"><span class="comment">//   it numberRepetitions times (see Gold deconvolution).</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   Function parameters:</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   source:  pointer to the vector of source spectrum</span></div>
<div class="line"><span class="comment">//   response:     pointer to the vector of response spectrum</span></div>
<div class="line"><span class="comment">//   ssize:    length of source and response spectra</span></div>
<div class="line"><span class="comment">//   numberIterations, for details we refer to the reference given above</span></div>
<div class="line"><span class="comment">//   numberRepetitions, for repeated boosted deconvolution</span></div>
<div class="line"><span class="comment">//   boost, boosting coefficient</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   Richardson-Lucy deconvolution algorithm:</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   For discrete systems it has the form:</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   &lt;img width=438 height=98 src=&quot;gif/NcSpectrum_DeconvolutionRL1.gif&quot;&gt;</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   &lt;img width=124 height=39 src=&quot;gif/NcSpectrum_DeconvolutionRL2.gif&quot;&gt;</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   for positive input data and response matrix this iterative method forces</span></div>
<div class="line"><span class="comment">//   the deconvoluted spectra to be non-negative. The Richardson-Lucy</span></div>
<div class="line"><span class="comment">//   iteration converges to the maximum likelihood solution for Poisson statistics</span></div>
<div class="line"><span class="comment">//   in the data.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   References:</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   Abreu M.C. et al., A four-dimensional deconvolution method to correct NA38</span></div>
<div class="line"><span class="comment">//   experimental data, NIM A 405 (1998) 139.</span></div>
<div class="line"><span class="comment">//   Lucy L.B., A.J. 79 (1974) 745.</span></div>
<div class="line"><span class="comment">//   Richardson W.H., J. Opt. Soc. Am. 62 (1972) 55.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   Examples of Richardson-Lucy deconvolution method:</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   Example 11 - script DeconvolutionRL_wide.c :</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   When we employ Richardson-Lucy deconvolution algorithm to our data from</span></div>
<div class="line"><span class="comment">//   Fig. 13 we obtain the result given in Fig. 18. One can observe improvements</span></div>
<div class="line"><span class="comment">//   as compared to the result achieved by Gold deconvolution. Neverthless it is</span></div>
<div class="line"><span class="comment">//   unable to decompose the multiplet.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   &lt;img width=601 height=407 src=&quot;gif/NcSpectrum_DeconvolutionRL_wide1.jpg&quot;&gt;</span></div>
<div class="line"><span class="comment">//   Figure 18 Example of Richardson-Lucy deconvolution for closely positioned</span></div>
<div class="line"><span class="comment">//   wide peaks. The original source spectrum is drawn with black color, the</span></div>
<div class="line"><span class="comment">//   spectrum after the deconvolution (10000 iterations) with red color.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   Script:</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Example to illustrate deconvolution function (class NcSpectrum).</span></div>
<div class="line"><span class="comment">// To execute this example, do</span></div>
<div class="line"><span class="comment">// root &gt; .x DeconvolutionRL_wide.C</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   #include &lt;NcSpectrum&gt;</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   void DeconvolutionRL_wide() {</span></div>
<div class="line"><span class="comment">//      Int_t i;</span></div>
<div class="line"><span class="comment">//      Double_t nbins = 256;</span></div>
<div class="line"><span class="comment">//      Double_t xmin  = 0;</span></div>
<div class="line"><span class="comment">//      Double_t xmax  = (Double_t)nbins;</span></div>
<div class="line"><span class="comment">//      Float_t * source = new float[nbins];</span></div>
<div class="line"><span class="comment">//      Float_t * response = new float[nbins];</span></div>
<div class="line"><span class="comment">//      TH1F *h = new TH1F(&quot;h&quot;,&quot;Deconvolution&quot;,nbins,xmin,xmax);</span></div>
<div class="line"><span class="comment">//      TH1F *d = new TH1F(&quot;d&quot;,&quot;&quot;,nbins,xmin,xmax);</span></div>
<div class="line"><span class="comment">//      TFile *f = new TFile(&quot;spectra\\NcSpectrum.root&quot;);</span></div>
<div class="line"><span class="comment">//      h=(TH1F*) f-&gt;Get(&quot;decon3;1&quot;);</span></div>
<div class="line"><span class="comment">//      TFile *fr = new TFile(&quot;spectra\\NcSpectrum.root&quot;);</span></div>
<div class="line"><span class="comment">//      d=(TH1F*) fr-&gt;Get(&quot;decon_response_wide;1&quot;);</span></div>
<div class="line"><span class="comment">//      for (i = 0; i &lt; nbins; i++) source[i]=h-&gt;GetBinContent(i + 1);</span></div>
<div class="line"><span class="comment">//      for (i = 0; i &lt; nbins; i++) response[i]=d-&gt;GetBinContent(i + 1);</span></div>
<div class="line"><span class="comment">//      TCanvas *Decon1 = gROOT-&gt;GetListOfCanvases()-&gt;FindObject(&quot;Decon1&quot;);</span></div>
<div class="line"><span class="comment">//      if (!Decon1) Decon1 = new TCanvas(&quot;Decon1&quot;,</span></div>
<div class="line"><span class="comment">//      &quot;Deconvolution of closely positioned overlapping peaks using Richardson-Lucy deconvolution method&quot;,</span></div>
<div class="line"><span class="comment">//      10,10,1000,700);</span></div>
<div class="line"><span class="comment">//      h-&gt;SetMaximum(30000);</span></div>
<div class="line"><span class="comment">//      h-&gt;Draw(&quot;L&quot;);</span></div>
<div class="line"><span class="comment">//      NcSpectrum *s = new NcSpectrum();</span></div>
<div class="line"><span class="comment">//      s-&gt;DeconvolutionRL(source,response,256,10000,1,1);</span></div>
<div class="line"><span class="comment">//      for (i = 0; i &lt; nbins; i++) d-&gt;SetBinContent(i + 1,source[i]);</span></div>
<div class="line"><span class="comment">//      d-&gt;SetLineColor(kRed);</span></div>
<div class="line"><span class="comment">//      d-&gt;Draw(&quot;SAME L&quot;);</span></div>
<div class="line"><span class="comment">//   }</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   Example 12 - script DeconvolutionRL_wide_boost.c :</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   Further let us employ boosting operation into deconvolution (Fig. 19).</span></div>
<div class="line"><span class="comment">//   &lt;img width=601 height=407 src=&quot;gif/NcSpectrum_DeconvolutionRL_wide2.jpg&quot;&gt;</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   Figure 19 The original source spectrum is drawn with black color, the</span></div>
<div class="line"><span class="comment">//   spectrum after the deconvolution with red color. Number of iterations = 200,</span></div>
<div class="line"><span class="comment">//   number of repetitions = 50 and boosting coefficient = 1.2.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   One can observe improvements in the estimation of peak positions as compared</span></div>
<div class="line"><span class="comment">//   to the results achieved by Gold deconvolution.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   Script:</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Example to illustrate deconvolution function (class NcSpectrum).</span></div>
<div class="line"><span class="comment">// To execute this example, do</span></div>
<div class="line"><span class="comment">// root &gt; .x DeconvolutionRL_wide_boost.C</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   #include &lt;NcSpectrum&gt;</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   void DeconvolutionRL_wide_boost() {</span></div>
<div class="line"><span class="comment">//      Int_t i;</span></div>
<div class="line"><span class="comment">//      Double_t nbins = 256;</span></div>
<div class="line"><span class="comment">//      Double_t xmin  = 0;</span></div>
<div class="line"><span class="comment">//      Double_t xmax  = (Double_t)nbins;</span></div>
<div class="line"><span class="comment">//      Float_t * source = new float[nbins];</span></div>
<div class="line"><span class="comment">//      Float_t * response = new float[nbins];</span></div>
<div class="line"><span class="comment">//      TH1F *h = new TH1F(&quot;h&quot;,&quot;Deconvolution&quot;,nbins,xmin,xmax);</span></div>
<div class="line"><span class="comment">//      TH1F *d = new TH1F(&quot;d&quot;,&quot;&quot;,nbins,xmin,xmax);</span></div>
<div class="line"><span class="comment">//      TFile *f = new TFile(&quot;spectra\\NcSpectrum.root&quot;);</span></div>
<div class="line"><span class="comment">//      h=(TH1F*) f-&gt;Get(&quot;decon3;1&quot;);</span></div>
<div class="line"><span class="comment">//      TFile *fr = new TFile(&quot;spectra\\NcSpectrum.root&quot;);</span></div>
<div class="line"><span class="comment">//      d=(TH1F*) fr-&gt;Get(&quot;decon_response_wide;1&quot;);</span></div>
<div class="line"><span class="comment">//      for (i = 0; i &lt; nbins; i++) source[i]=h-&gt;GetBinContent(i + 1);</span></div>
<div class="line"><span class="comment">//      for (i = 0; i &lt; nbins; i++) response[i]=d-&gt;GetBinContent(i + 1);</span></div>
<div class="line"><span class="comment">//      TCanvas *Decon1 = gROOT-&gt;GetListOfCanvases()-&gt;FindObject(&quot;Decon1&quot;);</span></div>
<div class="line"><span class="comment">//      if (!Decon1) Decon1 = new TCanvas(&quot;Decon1&quot;,</span></div>
<div class="line"><span class="comment">//      &quot;Deconvolution of closely positioned overlapping peaks using boosted Richardson-Lucy deconvolution method&quot;,</span></div>
<div class="line"><span class="comment">//      10,10,1000,700);</span></div>
<div class="line"><span class="comment">//      h-&gt;SetMaximum(110000);</span></div>
<div class="line"><span class="comment">//      h-&gt;Draw(&quot;L&quot;);</span></div>
<div class="line"><span class="comment">//      NcSpectrum *s = new NcSpectrum();</span></div>
<div class="line"><span class="comment">//      s-&gt;DeconvolutionRL(source,response,256,200,50,1.2);</span></div>
<div class="line"><span class="comment">//      for (i = 0; i &lt; nbins; i++) d-&gt;SetBinContent(i + 1,source[i]);</span></div>
<div class="line"><span class="comment">//      d-&gt;SetLineColor(kRed);</span></div>
<div class="line"><span class="comment">//      d-&gt;Draw(&quot;SAME L&quot;);</span></div>
<div class="line"><span class="comment">//   }</span></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../df/dc3/_nc_spectrum_8cxx_source.html#l02063">2063</a> of file <a class="el" href="../../df/dc3/_nc_spectrum_8cxx_source.html">NcSpectrum.cxx</a>.</p>

</div>
</div>
<a id="ab11f1cc222e91eeccd410340774f75ea" name="ab11f1cc222e91eeccd410340774f75ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab11f1cc222e91eeccd410340774f75ea">&#9670;&#160;</a></span>GetHistogram()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TH1 * NcSpectrum::GetHistogram </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../de/da1/_nc_spectrum_8h_source.html#l00064">64</a> of file <a class="el" href="../../de/da1/_nc_spectrum_8h_source.html">NcSpectrum.h</a>.</p>

</div>
</div>
<a id="a7079586bed09ed52d5f4749d8d9b11a9" name="a7079586bed09ed52d5f4749d8d9b11a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7079586bed09ed52d5f4749d8d9b11a9">&#9670;&#160;</a></span>GetNPeaks()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Int_t NcSpectrum::GetNPeaks </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../de/da1/_nc_spectrum_8h_source.html#l00065">65</a> of file <a class="el" href="../../de/da1/_nc_spectrum_8h_source.html">NcSpectrum.h</a>.</p>

</div>
</div>
<a id="a88cc8f7cda94dd734bd9d48adc8a6518" name="a88cc8f7cda94dd734bd9d48adc8a6518"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a88cc8f7cda94dd734bd9d48adc8a6518">&#9670;&#160;</a></span>GetPositionX()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Float_t * NcSpectrum::GetPositionX </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../de/da1/_nc_spectrum_8h_source.html#l00066">66</a> of file <a class="el" href="../../de/da1/_nc_spectrum_8h_source.html">NcSpectrum.h</a>.</p>

</div>
</div>
<a id="ae945bf75012c73653317c103205349e6" name="ae945bf75012c73653317c103205349e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae945bf75012c73653317c103205349e6">&#9670;&#160;</a></span>GetPositionY()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Float_t * NcSpectrum::GetPositionY </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../de/da1/_nc_spectrum_8h_source.html#l00067">67</a> of file <a class="el" href="../../de/da1/_nc_spectrum_8h_source.html">NcSpectrum.h</a>.</p>

</div>
</div>
<a id="a353d75294b3b83b34de20b71f5623130" name="a353d75294b3b83b34de20b71f5623130"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a353d75294b3b83b34de20b71f5623130">&#9670;&#160;</a></span>operator=()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d1/d95/class_nc_spectrum.html">NcSpectrum</a> &amp; NcSpectrum::operator= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d1/d95/class_nc_spectrum.html">NcSpectrum</a> &amp;</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a923dd695cc8bbbae6cd03b49c47416df" name="a923dd695cc8bbbae6cd03b49c47416df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a923dd695cc8bbbae6cd03b49c47416df">&#9670;&#160;</a></span>Print()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void NcSpectrum::Print </td>
          <td>(</td>
          <td class="paramtype">Option_t *</td>          <td class="paramname"><span class="paramname"><em>option</em></span><span class="paramdefsep"> = </span><span class="paramdefval">&quot;&quot;</span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel virtual">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="comment">// Print the array of positions.</span></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../df/dc3/_nc_spectrum_8cxx_source.html#l00279">279</a> of file <a class="el" href="../../df/dc3/_nc_spectrum_8cxx_source.html">NcSpectrum.cxx</a>.</p>

</div>
</div>
<a id="a26bb05ce59ac76a5798fd0c600d5a4f2" name="a26bb05ce59ac76a5798fd0c600d5a4f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a26bb05ce59ac76a5798fd0c600d5a4f2">&#9670;&#160;</a></span>Search()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Int_t NcSpectrum::Search </td>
          <td>(</td>
          <td class="paramtype">const TH1 *</td>          <td class="paramname"><span class="paramname"><em>hist</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Double_t</td>          <td class="paramname"><span class="paramname"><em>sigma</em></span><span class="paramdefsep"> = </span><span class="paramdefval">2</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Option_t *</td>          <td class="paramname"><span class="paramname"><em>option</em></span><span class="paramdefsep"> = </span><span class="paramdefval">&quot;&quot;</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Double_t</td>          <td class="paramname"><span class="paramname"><em>threshold</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0.05</span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel virtual">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="comment">// One-dimensional peak search function</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// This function searches for peaks in source spectrum in hin</span></div>
<div class="line"><span class="comment">// The number of found peaks and their positions are written into</span></div>
<div class="line"><span class="comment">// the members fNpeaks and fPositionX.</span></div>
<div class="line"><span class="comment">// The search is performed in the current histogram range.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Function parameters:</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// hin:       pointer to the histogram of source spectrum</span></div>
<div class="line"><span class="comment">// sigma:     sigma of searched peaks, for details we refer to manual</span></div>
<div class="line"><span class="comment">// threshold: (default=0.05)  peaks with amplitude less than</span></div>
<div class="line"><span class="comment">//            threshold*highest_peak are discarded.  0&lt;threshold&lt;1</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// By default, the background is removed before deconvolution.</span></div>
<div class="line"><span class="comment">// Specify the option &quot;nobackground&quot; to not remove the background.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// By default the &quot;Markov&quot; chain algorithm is used.</span></div>
<div class="line"><span class="comment">// Specify the option &quot;noMarkov&quot; to disable this algorithm</span></div>
<div class="line"><span class="comment">// Note that by default the source spectrum is replaced by a new spectrum</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// By default a polymarker object is created and added to the list of</span></div>
<div class="line"><span class="comment">// functions of the histogram. The histogram is drawn with the specified</span></div>
<div class="line"><span class="comment">// option and the polymarker object drawn on top of the histogram.</span></div>
<div class="line"><span class="comment">// The polymarker coordinates correspond to the npeaks peaks found in the histogram.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// A pointer to the polymarker object can be retrieved later via:</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//  TList *functions = hin-&gt;GetListOfFunctions();</span></div>
<div class="line"><span class="comment">//  TPolyMarker *pm = (TPolyMarker*)functions-&gt;FindObject(&quot;TPolyMarker&quot;);</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Specify the option &quot;goff&quot; to disable the storage and drawing of the polymarker.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   To disable the final drawing of the histogram with the search results (in case</span></div>
<div class="line"><span class="comment">//   you want to draw it yourself) specify &quot;nodraw&quot; in the options parameter.</span></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../df/dc3/_nc_spectrum_8cxx_source.html#l00295">295</a> of file <a class="el" href="../../df/dc3/_nc_spectrum_8cxx_source.html">NcSpectrum.cxx</a>.</p>

</div>
</div>
<a id="a61bd2301f86a31488ab514878d29dbeb" name="a61bd2301f86a31488ab514878d29dbeb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a61bd2301f86a31488ab514878d29dbeb">&#9670;&#160;</a></span>Search1HighRes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Int_t NcSpectrum::Search1HighRes </td>
          <td>(</td>
          <td class="paramtype">float *</td>          <td class="paramname"><span class="paramname"><em>source</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *</td>          <td class="paramname"><span class="paramname"><em>destVector</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t</td>          <td class="paramname"><span class="paramname"><em>ssize</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float</td>          <td class="paramname"><span class="paramname"><em>sigma</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Double_t</td>          <td class="paramname"><span class="paramname"><em>threshold</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>backgroundRemove</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t</td>          <td class="paramname"><span class="paramname"><em>deconIterations</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>markov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t</td>          <td class="paramname"><span class="paramname"><em>averWindow</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="comment">//   Old name of SearcHighRes introduced for back compatibility.</span></div>
<div class="line"><span class="comment">//   This function will be removed after the June 2006 release</span></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../df/dc3/_nc_spectrum_8cxx_source.html#l03215">3215</a> of file <a class="el" href="../../df/dc3/_nc_spectrum_8cxx_source.html">NcSpectrum.cxx</a>.</p>

</div>
</div>
<a id="a6ef0ca3a8d6e596900bec773ec4ff508" name="a6ef0ca3a8d6e596900bec773ec4ff508"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ef0ca3a8d6e596900bec773ec4ff508">&#9670;&#160;</a></span>SearchHighRes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Int_t NcSpectrum::SearchHighRes </td>
          <td>(</td>
          <td class="paramtype">float *</td>          <td class="paramname"><span class="paramname"><em>source</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *</td>          <td class="paramname"><span class="paramname"><em>destVector</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t</td>          <td class="paramname"><span class="paramname"><em>ssize</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float</td>          <td class="paramname"><span class="paramname"><em>sigma</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Double_t</td>          <td class="paramname"><span class="paramname"><em>threshold</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>backgroundRemove</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t</td>          <td class="paramname"><span class="paramname"><em>deconIterations</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>markov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t</td>          <td class="paramname"><span class="paramname"><em>averWindow</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="comment">//   One-dimensional high-resolution peak search function</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   This function searches for peaks in source spectrum. It is based on</span></div>
<div class="line"><span class="comment">//   deconvolution method. First the background is removed (if desired), then</span></div>
<div class="line"><span class="comment">//   Markov smoothed spectrum is calculated (if desired), then the response</span></div>
<div class="line"><span class="comment">//   function is generated according to given sigma and deconvolution is</span></div>
<div class="line"><span class="comment">//   carried out. The order of peaks is arranged according to their heights in</span></div>
<div class="line"><span class="comment">//   the spectrum after background elimination. The highest peak is the first in</span></div>
<div class="line"><span class="comment">//   the list. On success it returns number of found peaks.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   Function parameters:</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   source: pointer to the vector of source spectrum.</span></div>
<div class="line"><span class="comment">//   destVector: pointer to the vector of resulting deconvolved spectrum.</span></div>
<div class="line"><span class="comment">//   ssize: length of source spectrum.</span></div>
<div class="line"><span class="comment">//   sigma: sigma of searched peaks, for details we refer to manual.</span></div>
<div class="line"><span class="comment">//   threshold: threshold value in % for selected peaks, peaks with</span></div>
<div class="line"><span class="comment">//              amplitude less than threshold*highest_peak/100 are ignored, see manual.</span></div>
<div class="line"><span class="comment">//   backgroundRemove: logical variable, set if the removal of background before deconvolution is desired.</span></div>
<div class="line"><span class="comment">//   deconIterations-number of iterations in deconvolution operation.</span></div>
<div class="line"><span class="comment">//   markov: logical variable, if it is true, first the source spectrum</span></div>
<div class="line"><span class="comment">//           is replaced by new spectrum calculated using Markov chains method.</span></div>
<div class="line"><span class="comment">//   averWindow: averanging window of searched peaks, for details</span></div>
<div class="line"><span class="comment">//               we refer to manual (applies only for Markov method).</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   Peaks searching:</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   The goal of this function is to identify automatically the peaks in spectrum</span></div>
<div class="line"><span class="comment">//   with the presence of the continuous background and statistical</span></div>
<div class="line"><span class="comment">//   fluctuations - noise.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   The common problems connected with correct peak identification are:</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   non-sensitivity to noise, i.e., only statistically relevant peaks should be identified.</span></div>
<div class="line"><span class="comment">//   non-sensitivity of the algorithm to continuous background.</span></div>
<div class="line"><span class="comment">//   ability to identify peaks close to the edges of the spectrum region.</span></div>
<div class="line"><span class="comment">//   Usually peak finders fail to detect them.</span></div>
<div class="line"><span class="comment">//   resolution, decomposition of doublets and multiplets.</span></div>
<div class="line"><span class="comment">//   The algorithm should be able to recognize close positioned peaks.</span></div>
<div class="line"><span class="comment">//   ability to identify peaks with different sigma.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   &lt;img width=600 height=375 src=&quot;gif/NcSpectrum_Searching1.jpg&quot;&gt;</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   Fig. 27 An example of one-dimensional synthetic spectrum with found peaks</span></div>
<div class="line"><span class="comment">//   denoted by markers.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   References:</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   A method for identification of peaks in the presence of</span></div>
<div class="line"><span class="comment">//   background and its application to spectrum analysis. NIM 50 (1967), 309-320.</span></div>
<div class="line"><span class="comment">//   Identification of peaks in multidimensional coincidence gamma-ray spectra.</span></div>
<div class="line"><span class="comment">//   NIM, A443 (2000) 108-125.</span></div>
<div class="line"><span class="comment">//   A new algorithm for automatic photopeak searches. NIM A 376 (1996), 451.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   Examples of peak searching method:</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   The SearchHighRes function provides users with the possibility to vary the</span></div>
<div class="line"><span class="comment">//   input parameters and with the access to the output deconvolved data in the</span></div>
<div class="line"><span class="comment">//   destination spectrum. Based on the output data one can tune the parameters.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   Example 15 - script SearchHR1.c:</span></div>
<div class="line"><span class="comment">//   &lt;img width=600 height=321 src=&quot;gif/NcSpectrum_Searching1.jpg&quot;&gt;</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   Fig. 28 One-dimensional spectrum with found peaks denoted by markers, 3</span></div>
<div class="line"><span class="comment">//   iterations steps in the deconvolution.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   &lt;img width=600 height=323 src=&quot;gif/NcSpectrum_Searching2.jpg&quot;&gt;</span></div>
<div class="line"><span class="comment">//   Fig. 29 One-dimensional spectrum with found peaks denoted by markers, 8</span></div>
<div class="line"><span class="comment">//   iterations steps in the deconvolution.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   Script:</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Example to illustrate high resolution peak searching function (class NcSpectrum).</span></div>
<div class="line"><span class="comment">// To execute this example, do</span></div>
<div class="line"><span class="comment">// root &gt; .x SearchHR1.C</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   #include &lt;NcSpectrum&gt;</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   void SearchHR1() {</span></div>
<div class="line"><span class="comment">//      Float_t fPositionX[100];</span></div>
<div class="line"><span class="comment">//      Float_t fPositionY[100];</span></div>
<div class="line"><span class="comment">//      Int_t fNPeaks = 0;</span></div>
<div class="line"><span class="comment">//      Int_t i,nfound,bin;</span></div>
<div class="line"><span class="comment">//      Double_t nbins = 1024,a;</span></div>
<div class="line"><span class="comment">//      Double_t xmin  = 0;</span></div>
<div class="line"><span class="comment">//      Double_t xmax  = (Double_t)nbins;</span></div>
<div class="line"><span class="comment">//      Float_t * source = new float[nbins];</span></div>
<div class="line"><span class="comment">//      Float_t * dest = new float[nbins];</span></div>
<div class="line"><span class="comment">//      TH1F *h = new TH1F(&quot;h&quot;,&quot;High resolution peak searching, number of iterations = 3&quot;,nbins,xmin,xmax);</span></div>
<div class="line"><span class="comment">//      TH1F *d = new TH1F(&quot;d&quot;,&quot;&quot;,nbins,xmin,xmax);</span></div>
<div class="line"><span class="comment">//      TFile *f = new TFile(&quot;spectra\\NcSpectrum.root&quot;);</span></div>
<div class="line"><span class="comment">//      h=(TH1F*) f-&gt;Get(&quot;search2;1&quot;);</span></div>
<div class="line"><span class="comment">//      for (i = 0; i &lt; nbins; i++) source[i]=h-&gt;GetBinContent(i + 1);</span></div>
<div class="line"><span class="comment">//      TCanvas *Search = gROOT-&gt;GetListOfCanvases()-&gt;FindObject(&quot;Search&quot;);</span></div>
<div class="line"><span class="comment">//      if (!Search) Search = new TCanvas(&quot;Search&quot;,&quot;Search&quot;,10,10,1000,700);</span></div>
<div class="line"><span class="comment">//      h-&gt;SetMaximum(4000);</span></div>
<div class="line"><span class="comment">//      h-&gt;Draw(&quot;L&quot;);</span></div>
<div class="line"><span class="comment">//      NcSpectrum *s = new NcSpectrum();</span></div>
<div class="line"><span class="comment">//      nfound = s-&gt;SearchHighRes(source, dest, nbins, 8, 2, kTRUE, 3, kTRUE, 3);</span></div>
<div class="line"><span class="comment">//      Float_t *xpeaks = s-&gt;GetPositionX();</span></div>
<div class="line"><span class="comment">//      for (i = 0; i &lt; nfound; i++) {</span></div>
<div class="line"><span class="comment">//         a=xpeaks[i];</span></div>
<div class="line"><span class="comment">//         bin = 1 + Int_t(a + 0.5);</span></div>
<div class="line"><span class="comment">//         fPositionX[i] = h-&gt;GetBinCenter(bin);</span></div>
<div class="line"><span class="comment">//         fPositionY[i] = h-&gt;GetBinContent(bin);</span></div>
<div class="line"><span class="comment">//      }</span></div>
<div class="line"><span class="comment">//      TPolyMarker * pm = (TPolyMarker*)h-&gt;GetListOfFunctions()-&gt;FindObject(&quot;TPolyMarker&quot;);</span></div>
<div class="line"><span class="comment">//      if (pm) {</span></div>
<div class="line"><span class="comment">//         h-&gt;GetListOfFunctions()-&gt;Remove(pm);</span></div>
<div class="line"><span class="comment">//         delete pm;</span></div>
<div class="line"><span class="comment">//      }</span></div>
<div class="line"><span class="comment">//      pm = new TPolyMarker(nfound, fPositionX, fPositionY);</span></div>
<div class="line"><span class="comment">//      h-&gt;GetListOfFunctions()-&gt;Add(pm);</span></div>
<div class="line"><span class="comment">//      pm-&gt;SetMarkerStyle(23);</span></div>
<div class="line"><span class="comment">//      pm-&gt;SetMarkerColor(kRed);</span></div>
<div class="line"><span class="comment">//      pm-&gt;SetMarkerSize(1.3);</span></div>
<div class="line"><span class="comment">//      for (i = 0; i &lt; nbins; i++) d-&gt;SetBinContent(i + 1,dest[i]);</span></div>
<div class="line"><span class="comment">//      d-&gt;SetLineColor(kRed);</span></div>
<div class="line"><span class="comment">//      d-&gt;Draw(&quot;SAME&quot;);</span></div>
<div class="line"><span class="comment">//      printf(&quot;Found %d candidate peaks\n&quot;,nfound);</span></div>
<div class="line"><span class="comment">//      for(i=0;i&lt;nfound;i++)</span></div>
<div class="line"><span class="comment">//         printf(&quot;posx= %d, posy= %d\n&quot;,fPositionX[i], fPositionY[i]);</span></div>
<div class="line"><span class="comment">//      }</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   Example 16 - script SearchHR3.c:</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   &lt;img width=600 height=328 src=&quot;gif/NcSpectrum_Searching3.jpg&quot;&gt;</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   Fig. 30 Influence of number of iterations (3-red, 10-blue, 100- green,</span></div>
<div class="line"><span class="comment">//   1000-magenta), sigma=8, smoothing width=3.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   &lt;img width=600 height=321 src=&quot;gif/NcSpectrum_Searching4.jpg&quot;&gt;</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   Fig. 31 Influence of sigma (3-red, 8-blue, 20- green, 43-magenta),</span></div>
<div class="line"><span class="comment">//   num. iter.=10, sm. width=3.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   &lt;img width=600 height=323 src=&quot;gif/NcSpectrum_Searching5.jpg&quot;&gt;&lt;/p&gt;</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   Fig. 32 Influence smoothing width (0-red, 3-blue, 7- green, 20-magenta), num.</span></div>
<div class="line"><span class="comment">//   iter.=10, sigma=8.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   Script:</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Example to illustrate the influence of number of iterations in deconvolution in high resolution peak searching function (class NcSpectrum).</span></div>
<div class="line"><span class="comment">// To execute this example, do</span></div>
<div class="line"><span class="comment">// root &gt; .x SearchHR3.C</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   #include &lt;NcSpectrum&gt;</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   void SearchHR3() {</span></div>
<div class="line"><span class="comment">//      Float_t fPositionX[100];</span></div>
<div class="line"><span class="comment">//      Float_t fPositionY[100];</span></div>
<div class="line"><span class="comment">//      Int_t fNPeaks = 0;</span></div>
<div class="line"><span class="comment">//      Int_t i,nfound,bin;</span></div>
<div class="line"><span class="comment">//      Double_t nbins = 1024,a;</span></div>
<div class="line"><span class="comment">//      Double_t xmin  = 0;</span></div>
<div class="line"><span class="comment">//      Double_t xmax  = (Double_t)nbins;</span></div>
<div class="line"><span class="comment">//      Float_t * source = new float[nbins];</span></div>
<div class="line"><span class="comment">//      Float_t * dest = new float[nbins];</span></div>
<div class="line"><span class="comment">//      TH1F *h = new TH1F(&quot;h&quot;,&quot;Influence of # of iterations in deconvolution in peak searching&quot;,nbins,xmin,xmax);</span></div>
<div class="line"><span class="comment">//      TH1F *d1 = new TH1F(&quot;d1&quot;,&quot;&quot;,nbins,xmin,xmax);</span></div>
<div class="line"><span class="comment">//      TH1F *d2 = new TH1F(&quot;d2&quot;,&quot;&quot;,nbins,xmin,xmax);</span></div>
<div class="line"><span class="comment">//      TH1F *d3 = new TH1F(&quot;d3&quot;,&quot;&quot;,nbins,xmin,xmax);</span></div>
<div class="line"><span class="comment">//      TH1F *d4 = new TH1F(&quot;d4&quot;,&quot;&quot;,nbins,xmin,xmax);</span></div>
<div class="line"><span class="comment">//      TFile *f = new TFile(&quot;spectra\\NcSpectrum.root&quot;);</span></div>
<div class="line"><span class="comment">//      h=(TH1F*) f-&gt;Get(&quot;search3;1&quot;);</span></div>
<div class="line"><span class="comment">//      for (i = 0; i &lt; nbins; i++) source[i]=h-&gt;GetBinContent(i + 1);</span></div>
<div class="line"><span class="comment">//      TCanvas *Search = gROOT-&gt;GetListOfCanvases()-&gt;FindObject(&quot;Search&quot;);</span></div>
<div class="line"><span class="comment">//      if (!Search) Search = new TCanvas(&quot;Search&quot;,&quot;Search&quot;,10,10,1000,700);</span></div>
<div class="line"><span class="comment">//      h-&gt;SetMaximum(1300);</span></div>
<div class="line"><span class="comment">//      h-&gt;Draw(&quot;L&quot;);</span></div>
<div class="line"><span class="comment">//      NcSpectrum *s = new NcSpectrum();</span></div>
<div class="line"><span class="comment">//      nfound = s-&gt;SearchHighRes(source, dest, nbins, 8, 2, kTRUE, 3, kTRUE, 3);</span></div>
<div class="line"><span class="comment">//      Float_t *xpeaks = s-&gt;GetPositionX();</span></div>
<div class="line"><span class="comment">//      for (i = 0; i &lt; nfound; i++) {</span></div>
<div class="line"><span class="comment">//         a=xpeaks[i];</span></div>
<div class="line"><span class="comment">//         bin = 1 + Int_t(a + 0.5);</span></div>
<div class="line"><span class="comment">//         fPositionX[i] = h-&gt;GetBinCenter(bin);</span></div>
<div class="line"><span class="comment">//         fPositionY[i] = h-&gt;GetBinContent(bin);</span></div>
<div class="line"><span class="comment">//      }</span></div>
<div class="line"><span class="comment">//      TPolyMarker * pm = (TPolyMarker*)h-&gt;GetListOfFunctions()-&gt;FindObject(&quot;TPolyMarker&quot;);</span></div>
<div class="line"><span class="comment">//      if (pm) {</span></div>
<div class="line"><span class="comment">//         h-&gt;GetListOfFunctions()-&gt;Remove(pm);</span></div>
<div class="line"><span class="comment">//         delete pm;</span></div>
<div class="line"><span class="comment">//      }</span></div>
<div class="line"><span class="comment">//      pm = new TPolyMarker(nfound, fPositionX, fPositionY);</span></div>
<div class="line"><span class="comment">//      h-&gt;GetListOfFunctions()-&gt;Add(pm);</span></div>
<div class="line"><span class="comment">//      pm-&gt;SetMarkerStyle(23);</span></div>
<div class="line"><span class="comment">//      pm-&gt;SetMarkerColor(kRed);</span></div>
<div class="line"><span class="comment">//      pm-&gt;SetMarkerSize(1.3);</span></div>
<div class="line"><span class="comment">//      for (i = 0; i &lt; nbins; i++) d1-&gt;SetBinContent(i + 1,dest[i]);</span></div>
<div class="line"><span class="comment">//      h-&gt;Draw(&quot;&quot;);</span></div>
<div class="line"><span class="comment">//      d1-&gt;SetLineColor(kRed);</span></div>
<div class="line"><span class="comment">//      d1-&gt;Draw(&quot;SAME&quot;);</span></div>
<div class="line"><span class="comment">//      for (i = 0; i &lt; nbins; i++) source[i]=h-&gt;GetBinContent(i + 1);</span></div>
<div class="line"><span class="comment">//      s-&gt;SearchHighRes(source, dest, nbins, 8, 2, kTRUE, 10, kTRUE, 3);</span></div>
<div class="line"><span class="comment">//      for (i = 0; i &lt; nbins; i++) d2-&gt;SetBinContent(i + 1,dest[i]);</span></div>
<div class="line"><span class="comment">//      d2-&gt;SetLineColor(kBlue);</span></div>
<div class="line"><span class="comment">//      d2-&gt;Draw(&quot;SAME&quot;);</span></div>
<div class="line"><span class="comment">//      for (i = 0; i &lt; nbins; i++) source[i]=h-&gt;GetBinContent(i + 1);</span></div>
<div class="line"><span class="comment">//      s-&gt;SearchHighRes(source, dest, nbins, 8, 2, kTRUE, 100, kTRUE, 3);</span></div>
<div class="line"><span class="comment">//      for (i = 0; i &lt; nbins; i++) d3-&gt;SetBinContent(i + 1,dest[i]);</span></div>
<div class="line"><span class="comment">//      d3-&gt;SetLineColor(kGreen);</span></div>
<div class="line"><span class="comment">//      d3-&gt;Draw(&quot;SAME&quot;);</span></div>
<div class="line"><span class="comment">//      for (i = 0; i &lt; nbins; i++) source[i]=h-&gt;GetBinContent(i + 1);</span></div>
<div class="line"><span class="comment">//      s-&gt;SearchHighRes(source, dest, nbins, 8, 2, kTRUE, 1000, kTRUE, 3);</span></div>
<div class="line"><span class="comment">//      for (i = 0; i &lt; nbins; i++) d4-&gt;SetBinContent(i + 1,dest[i]);</span></div>
<div class="line"><span class="comment">//      d4-&gt;SetLineColor(kMagenta);</span></div>
<div class="line"><span class="comment">//      d4-&gt;Draw(&quot;SAME&quot;);</span></div>
<div class="line"><span class="comment">//      printf(&quot;Found %d candidate peaks\n&quot;,nfound);</span></div>
<div class="line"><span class="comment">//   }</span></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../df/dc3/_nc_spectrum_8cxx_source.html#l02564">2564</a> of file <a class="el" href="../../df/dc3/_nc_spectrum_8cxx_source.html">NcSpectrum.cxx</a>.</p>

</div>
</div>
<a id="ab595c5f7ecd5ea0ecd12c49176e28212" name="ab595c5f7ecd5ea0ecd12c49176e28212"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab595c5f7ecd5ea0ecd12c49176e28212">&#9670;&#160;</a></span>SetAverageWindow()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void NcSpectrum::SetAverageWindow </td>
          <td>(</td>
          <td class="paramtype">Int_t</td>          <td class="paramname"><span class="paramname"><em>w</em></span><span class="paramdefsep"> = </span><span class="paramdefval">3</span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="comment">// Static function: Set average window of searched peaks</span></div>
<div class="line"><span class="comment">// (see NcSpectrum::SearchHighRes).</span></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../df/dc3/_nc_spectrum_8cxx_source.html#l00146">146</a> of file <a class="el" href="../../df/dc3/_nc_spectrum_8cxx_source.html">NcSpectrum.cxx</a>.</p>

</div>
</div>
<a id="a3f4b1232eee5af4d41f7676d0dcd1233" name="a3f4b1232eee5af4d41f7676d0dcd1233"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f4b1232eee5af4d41f7676d0dcd1233">&#9670;&#160;</a></span>SetDeconIterations()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void NcSpectrum::SetDeconIterations </td>
          <td>(</td>
          <td class="paramtype">Int_t</td>          <td class="paramname"><span class="paramname"><em>n</em></span><span class="paramdefsep"> = </span><span class="paramdefval">3</span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="comment">// Static function: Set max number of decon iterations in deconvolution</span></div>
<div class="line"><span class="comment">// operation (see NcSpectrum::SearchHighRes).</span></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../df/dc3/_nc_spectrum_8cxx_source.html#l00160">160</a> of file <a class="el" href="../../df/dc3/_nc_spectrum_8cxx_source.html">NcSpectrum.cxx</a>.</p>

</div>
</div>
<a id="adef98295d4872921c50584157e7bcbbd" name="adef98295d4872921c50584157e7bcbbd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adef98295d4872921c50584157e7bcbbd">&#9670;&#160;</a></span>SetResolution()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NcSpectrum::SetResolution </td>
          <td>(</td>
          <td class="paramtype">Float_t</td>          <td class="paramname"><span class="paramname"><em>resolution</em></span><span class="paramdefsep"> = </span><span class="paramdefval">1</span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="comment">// resolution: determines resolution of the neighboring peaks</span></div>
<div class="line"><span class="comment">//             default value is 1 correspond to 3 sigma distance</span></div>
<div class="line"><span class="comment">//             between peaks. Higher values allow higher resolution</span></div>
<div class="line"><span class="comment">//             (smaller distance between peaks.</span></div>
<div class="line"><span class="comment">//             May be set later through SetResolution.</span></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../df/dc3/_nc_spectrum_8cxx_source.html#l00414">414</a> of file <a class="el" href="../../df/dc3/_nc_spectrum_8cxx_source.html">NcSpectrum.cxx</a>.</p>

</div>
</div>
<a id="adda88c99031602639b32a1d0df7e38be" name="adda88c99031602639b32a1d0df7e38be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adda88c99031602639b32a1d0df7e38be">&#9670;&#160;</a></span>SmoothMarkov()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char * NcSpectrum::SmoothMarkov </td>
          <td>(</td>
          <td class="paramtype">float *</td>          <td class="paramname"><span class="paramname"><em>source</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t</td>          <td class="paramname"><span class="paramname"><em>ssize</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t</td>          <td class="paramname"><span class="paramname"><em>averWindow</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="comment">// One-dimensional markov spectrum smoothing function</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   This function calculates smoothed spectrum from source spectrum based on</span></div>
<div class="line"><span class="comment">//   Markov chain method. The result is placed in the array pointed by source</span></div>
<div class="line"><span class="comment">//   pointer. On successful completion it returns 0. On error it returns pointer</span></div>
<div class="line"><span class="comment">//   to the string describing error.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   Function parameters:</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   source: pointer to the array of source spectrum</span></div>
<div class="line"><span class="comment">//   ssize: length of source array</span></div>
<div class="line"><span class="comment">//   averWindow: width of averaging smoothing window</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   The goal of this function is the suppression of the statistical fluctuations.</span></div>
<div class="line"><span class="comment">//   The algorithm is based on discrete Markov chain, which has very simple</span></div>
<div class="line"><span class="comment">//   invariant distribution:</span></div>
<div class="line"><span class="comment">//   &lt;img width=551 height=63 src=&quot;gif/NcSpectrum_Smoothing1.gif&quot;&gt;</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   &lt;img width=28 height=36 src=&quot;gif/NcSpectrum_Smoothing2.gif&quot;&gt; being defined</span></div>
<div class="line"><span class="comment">//   from the normalization condition</span></div>
<div class="line"><span class="comment">//   &lt;img width=70 height=52 src=&quot;gif/NcSpectrum_Smoothing3.gif&quot;&gt;.</span></div>
<div class="line"><span class="comment">//   n is the length of the smoothed spectrum and</span></div>
<div class="line"><span class="comment">//   &lt;img width=258 height=60 src=&quot;gif/NcSpectrum_Smoothing4.gif&quot;&gt;</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   Reference:</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   A new algorithm for automatic photopeak searches.</span></div>
<div class="line"><span class="comment">//   NIM A 376 (1996), 451.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   Example 14 - script Smoothing.c</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   &lt;img width=296 height=182 src=&quot;gif/NcSpectrum_Smoothing1.jpg&quot;&gt;</span></div>
<div class="line"><span class="comment">//   Fig. 23 Original noisy spectrum</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   &lt;img width=296 height=182 src=&quot;gif/NcSpectrum_Smoothing2.jpg&quot;&gt;</span></div>
<div class="line"><span class="comment">//   Fig. 24 Smoothed spectrum m=3</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   &lt;img width=299 height=184 src=&quot;gif/NcSpectrum_Smoothing3.jpg&quot;&gt;</span></div>
<div class="line"><span class="comment">//   Fig. 25 Smoothed spectrum</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   &lt;img width=299 height=184 src=&quot;gif/NcSpectrum_Smoothing4.jpg&quot;&gt;</span></div>
<div class="line"><span class="comment">//   Fig.26 Smoothed spectrum m=10</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   Script:</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Example to illustrate smoothing using Markov algorithm (class NcSpectrum).</span></div>
<div class="line"><span class="comment">// To execute this example, do</span></div>
<div class="line"><span class="comment">// root &gt; .x Smoothing.C</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   void Smoothing() {</span></div>
<div class="line"><span class="comment">//      Int_t i;</span></div>
<div class="line"><span class="comment">//      Double_t nbins = 1024;</span></div>
<div class="line"><span class="comment">//      Double_t xmin  = 0;</span></div>
<div class="line"><span class="comment">//      Double_t xmax  = (Double_t)nbins;</span></div>
<div class="line"><span class="comment">//      Float_t * source = new float[nbins];</span></div>
<div class="line"><span class="comment">//      TH1F *h = new TH1F(&quot;h&quot;,&quot;Smoothed spectrum for m=3&quot;,nbins,xmin,xmax);</span></div>
<div class="line"><span class="comment">//      TFile *f = new TFile(&quot;spectra\\NcSpectrum.root&quot;);</span></div>
<div class="line"><span class="comment">//      h=(TH1F*) f-&gt;Get(&quot;smooth1;1&quot;);</span></div>
<div class="line"><span class="comment">//      for (i = 0; i &lt; nbins; i++) source[i]=h-&gt;GetBinContent(i + 1);</span></div>
<div class="line"><span class="comment">//      TCanvas *Smooth1 = gROOT-&gt;GetListOfCanvases()-&gt;FindObject(&quot;Smooth1&quot;);</span></div>
<div class="line"><span class="comment">//      if (!Smooth1) Smooth1 = new TCanvas(&quot;Smooth1&quot;,&quot;Smooth1&quot;,10,10,1000,700);</span></div>
<div class="line"><span class="comment">//      NcSpectrum *s = new NcSpectrum();</span></div>
<div class="line"><span class="comment">//      s-&gt;SmoothMarkov(source,1024,3);  //3, 7, 10</span></div>
<div class="line"><span class="comment">//      for (i = 0; i &lt; nbins; i++) h-&gt;SetBinContent(i + 1,source[i]);</span></div>
<div class="line"><span class="comment">//      h-&gt;SetAxisRange(330,880);</span></div>
<div class="line"><span class="comment">//      h-&gt;Draw(&quot;L&quot;);</span></div>
<div class="line"><span class="comment">//   }</span></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../df/dc3/_nc_spectrum_8cxx_source.html#l01516">1516</a> of file <a class="el" href="../../df/dc3/_nc_spectrum_8cxx_source.html">NcSpectrum.cxx</a>.</p>

</div>
</div>
<a id="a23e8c63f833c391897e38408cf8901d2" name="a23e8c63f833c391897e38408cf8901d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a23e8c63f833c391897e38408cf8901d2">&#9670;&#160;</a></span>StaticBackground()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TH1 * NcSpectrum::StaticBackground </td>
          <td>(</td>
          <td class="paramtype">const TH1 *</td>          <td class="paramname"><span class="paramname"><em>hist</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t</td>          <td class="paramname"><span class="paramname"><em>niter</em></span><span class="paramdefsep"> = </span><span class="paramdefval">20</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Option_t *</td>          <td class="paramname"><span class="paramname"><em>option</em></span><span class="paramdefsep"> = </span><span class="paramdefval">&quot;&quot;</span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="comment">//   Static function, interface to NcSpectrum::Background.</span></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../df/dc3/_nc_spectrum_8cxx_source.html#l03247">3247</a> of file <a class="el" href="../../df/dc3/_nc_spectrum_8cxx_source.html">NcSpectrum.cxx</a>.</p>

</div>
</div>
<a id="a247b66859a54abc62f3c42d2cad8fcaf" name="a247b66859a54abc62f3c42d2cad8fcaf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a247b66859a54abc62f3c42d2cad8fcaf">&#9670;&#160;</a></span>StaticSearch()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Int_t NcSpectrum::StaticSearch </td>
          <td>(</td>
          <td class="paramtype">const TH1 *</td>          <td class="paramname"><span class="paramname"><em>hist</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Double_t</td>          <td class="paramname"><span class="paramname"><em>sigma</em></span><span class="paramdefsep"> = </span><span class="paramdefval">2</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Option_t *</td>          <td class="paramname"><span class="paramname"><em>option</em></span><span class="paramdefsep"> = </span><span class="paramdefval">&quot;goff&quot;</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Double_t</td>          <td class="paramname"><span class="paramname"><em>threshold</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0.05</span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="comment">//   Static function, interface to NcSpectrum::Search.</span></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../df/dc3/_nc_spectrum_8cxx_source.html#l03233">3233</a> of file <a class="el" href="../../df/dc3/_nc_spectrum_8cxx_source.html">NcSpectrum.cxx</a>.</p>

</div>
</div>
<a id="ae735efe2ca607bce8d835ca928611bd9" name="ae735efe2ca607bce8d835ca928611bd9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae735efe2ca607bce8d835ca928611bd9">&#9670;&#160;</a></span>Unfolding()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char * NcSpectrum::Unfolding </td>
          <td>(</td>
          <td class="paramtype">float *</td>          <td class="paramname"><span class="paramname"><em>source</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float **</td>          <td class="paramname"><span class="paramname"><em>respMatrix</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t</td>          <td class="paramname"><span class="paramname"><em>ssizex</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t</td>          <td class="paramname"><span class="paramname"><em>ssizey</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t</td>          <td class="paramname"><span class="paramname"><em>numberIterations</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t</td>          <td class="paramname"><span class="paramname"><em>numberRepetitions</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Double_t</td>          <td class="paramname"><span class="paramname"><em>boost</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="comment">//   One-dimensional unfolding function</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   This function unfolds source spectrum according to response matrix columns.</span></div>
<div class="line"><span class="comment">//   The result is placed in the vector pointed by source pointer.</span></div>
<div class="line"><span class="comment">//   The coefficients of the resulting vector represent contents of the columns</span></div>
<div class="line"><span class="comment">//   (weights) in the input vector. On successful completion it returns 0. On</span></div>
<div class="line"><span class="comment">//   error it returns pointer to the string describing error. If desired after</span></div>
<div class="line"><span class="comment">//   every numberIterations one can apply boosting operation (exponential</span></div>
<div class="line"><span class="comment">//   function with exponent given by boost coefficient) and repeat it</span></div>
<div class="line"><span class="comment">//   numberRepetitions times. For details we refer to [1].</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   Function parameters:</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   source: pointer to the vector of source spectrum</span></div>
<div class="line"><span class="comment">//   respMatrix: pointer to the matrix of response spectra</span></div>
<div class="line"><span class="comment">//   ssizex: length of source spectrum and # of columns of the response matrix. ssizex must be &gt;= ssizey.</span></div>
<div class="line"><span class="comment">//   ssizey: length of destination spectrum and # of rows of the response matrix.</span></div>
<div class="line"><span class="comment">//   numberIterations: number of iterations</span></div>
<div class="line"><span class="comment">//   numberRepetitions: number of repetitions for boosted deconvolution. It must be greater or equal to one.</span></div>
<div class="line"><span class="comment">//   boost: boosting coefficient, applies only if numberRepetitions is greater than one.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   Unfolding:</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   The goal is the decomposition of spectrum to a given set of component spectra.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   The mathematical formulation of the discrete linear system is:</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   &lt;img width=588 height=89 src=&quot;gif/NcSpectrum_Unfolding1.gif&quot;&gt;</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   &lt;img width=597 height=228 src=&quot;gif/NcSpectrum_Unfolding2.gif&quot;&gt;</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   References:</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   Decomposition of continuum gamma-ray spectra using synthetized response matrix.</span></div>
<div class="line"><span class="comment">//   NIM A 516 (2004), 172-183.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   Example of unfolding:</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   Example 13 - script Unfolding.c:</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   &lt;img width=442 height=648 src=&quot;gif/NcSpectrum_Unfolding3.gif&quot;&gt;</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   Fig. 20 Response matrix composed of neutron spectra of pure chemical elements.</span></div>
<div class="line"><span class="comment">//   &lt;img width=604 height=372 src=&quot;gif/NcSpectrum_Unfolding2.jpg&quot;&gt;</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   Fig. 21 Source neutron spectrum to be decomposed</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   &lt;img width=600 height=360 src=&quot;gif/NcSpectrum_Unfolding3.jpg&quot;&gt;</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   Fig. 22 Spectrum after decomposition, contains 10 coefficients, which</span></div>
<div class="line"><span class="comment">//   correspond to contents of chemical components (dominant 8-th and 10-th</span></div>
<div class="line"><span class="comment">//   components, i.e. O, Si)</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   Script:</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Example to illustrate unfolding function (class NcSpectrum).</span></div>
<div class="line"><span class="comment">// To execute this example, do</span></div>
<div class="line"><span class="comment">// root &gt; .x Unfolding.C</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   #include &lt;NcSpectrum&gt;</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   void Unfolding() {</span></div>
<div class="line"><span class="comment">//      Int_t i, j;</span></div>
<div class="line"><span class="comment">//      Int_t nbinsx = 2048;</span></div>
<div class="line"><span class="comment">//      Int_t nbinsy = 10;</span></div>
<div class="line"><span class="comment">//      Double_t xmin  = 0;</span></div>
<div class="line"><span class="comment">//      Double_t xmax  = (Double_t)nbinsx;</span></div>
<div class="line"><span class="comment">//      Double_t ymin  = 0;</span></div>
<div class="line"><span class="comment">//      Double_t ymax  = (Double_t)nbinsy;</span></div>
<div class="line"><span class="comment">//      Float_t * source = new float[nbinsx];</span></div>
<div class="line"><span class="comment">//      Float_t ** response = new float *[nbinsy];</span></div>
<div class="line"><span class="comment">//      for (i=0;i&lt;nbinsy;i++) response[i]=new float[nbinsx];</span></div>
<div class="line"><span class="comment">//      TH1F *h = new TH1F(&quot;h&quot;,&quot;&quot;,nbinsx,xmin,xmax);</span></div>
<div class="line"><span class="comment">//      TH1F *d = new TH1F(&quot;d&quot;,&quot;Decomposition - unfolding&quot;,nbinsx,xmin,xmax);</span></div>
<div class="line"><span class="comment">//      TH2F *decon_unf_resp = new TH2F(&quot;decon_unf_resp&quot;,&quot;Root File&quot;,nbinsy,ymin,ymax,nbinsx,xmin,xmax);</span></div>
<div class="line"><span class="comment">//      TFile *f = new TFile(&quot;spectra\\NcSpectrum.root&quot;);</span></div>
<div class="line"><span class="comment">//      h=(TH1F*) f-&gt;Get(&quot;decon_unf_in;1&quot;);</span></div>
<div class="line"><span class="comment">//      TFile *fr = new TFile(&quot;spectra\\NcSpectrum.root&quot;);</span></div>
<div class="line"><span class="comment">//      decon_unf_resp = (TH2F*) fr-&gt;Get(&quot;decon_unf_resp;1&quot;);</span></div>
<div class="line"><span class="comment">//      for (i = 0; i &lt; nbinsx; i++) source[i] = h-&gt;GetBinContent(i + 1);</span></div>
<div class="line"><span class="comment">//      for (i = 0; i &lt; nbinsy; i++){</span></div>
<div class="line"><span class="comment">//         for (j = 0; j&lt; nbinsx; j++){</span></div>
<div class="line"><span class="comment">//            response[i][j] = decon_unf_resp-&gt;GetBinContent(i + 1, j + 1);</span></div>
<div class="line"><span class="comment">//         }</span></div>
<div class="line"><span class="comment">//      }</span></div>
<div class="line"><span class="comment">//      TCanvas *Decon1 = gROOT-&gt;GetListOfCanvases()-&gt;FindObject(&quot;Decon1&quot;);</span></div>
<div class="line"><span class="comment">//      if (!Decon1) Decon1 = new TCanvas(&quot;Decon1&quot;,&quot;Decon1&quot;,10,10,1000,700);</span></div>
<div class="line"><span class="comment">//      h-&gt;Draw(&quot;L&quot;);</span></div>
<div class="line"><span class="comment">//      NcSpectrum *s = new NcSpectrum();</span></div>
<div class="line"><span class="comment">//      s-&gt;Unfolding(source,response,nbinsx,nbinsy,1000,1,1);</span></div>
<div class="line"><span class="comment">//      for (i = 0; i &lt; nbinsy; i++) d-&gt;SetBinContent(i + 1,source[i]);</span></div>
<div class="line"><span class="comment">//      d-&gt;SetLineColor(kRed);</span></div>
<div class="line"><span class="comment">//      d-&gt;SetAxisRange(0,nbinsy);</span></div>
<div class="line"><span class="comment">//      d-&gt;Draw(&quot;&quot;);</span></div>
<div class="line"><span class="comment">//   }</span></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../df/dc3/_nc_spectrum_8cxx_source.html#l02312">2312</a> of file <a class="el" href="../../df/dc3/_nc_spectrum_8cxx_source.html">NcSpectrum.cxx</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a385d3be870dc7f18eefa2cbd761a3b20" name="a385d3be870dc7f18eefa2cbd761a3b20"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a385d3be870dc7f18eefa2cbd761a3b20">&#9670;&#160;</a></span>fgAverageWindow</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Int_t NcSpectrum::fgAverageWindow = 3</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../de/da1/_nc_spectrum_8h_source.html#l00040">40</a> of file <a class="el" href="../../de/da1/_nc_spectrum_8h_source.html">NcSpectrum.h</a>.</p>

</div>
</div>
<a id="a5eaccc50d73d4ca438fb9fa7ebd4b7c1" name="a5eaccc50d73d4ca438fb9fa7ebd4b7c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5eaccc50d73d4ca438fb9fa7ebd4b7c1">&#9670;&#160;</a></span>fgIterations</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Int_t NcSpectrum::fgIterations = 3</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../de/da1/_nc_spectrum_8h_source.html#l00041">41</a> of file <a class="el" href="../../de/da1/_nc_spectrum_8h_source.html">NcSpectrum.h</a>.</p>

</div>
</div>
<a id="ae7736adfee8b27bdd733cce4e7235e32" name="ae7736adfee8b27bdd733cce4e7235e32"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7736adfee8b27bdd733cce4e7235e32">&#9670;&#160;</a></span>fHistogram</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TH1* NcSpectrum::fHistogram</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../de/da1/_nc_spectrum_8h_source.html#l00039">39</a> of file <a class="el" href="../../de/da1/_nc_spectrum_8h_source.html">NcSpectrum.h</a>.</p>

</div>
</div>
<a id="aba8972fa4f6284ce6dd6ca7a56d22358" name="aba8972fa4f6284ce6dd6ca7a56d22358"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba8972fa4f6284ce6dd6ca7a56d22358">&#9670;&#160;</a></span>fMaxPeaks</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Int_t NcSpectrum::fMaxPeaks</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../de/da1/_nc_spectrum_8h_source.html#l00033">33</a> of file <a class="el" href="../../de/da1/_nc_spectrum_8h_source.html">NcSpectrum.h</a>.</p>

</div>
</div>
<a id="af3dec61e8c65baf4804d2d1e56e402f0" name="af3dec61e8c65baf4804d2d1e56e402f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af3dec61e8c65baf4804d2d1e56e402f0">&#9670;&#160;</a></span>fNPeaks</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Int_t NcSpectrum::fNPeaks</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../de/da1/_nc_spectrum_8h_source.html#l00034">34</a> of file <a class="el" href="../../de/da1/_nc_spectrum_8h_source.html">NcSpectrum.h</a>.</p>

</div>
</div>
<a id="a74708032eb1a9796c7d6c978e026aee3" name="a74708032eb1a9796c7d6c978e026aee3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a74708032eb1a9796c7d6c978e026aee3">&#9670;&#160;</a></span>fPosition</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Float_t* NcSpectrum::fPosition</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../de/da1/_nc_spectrum_8h_source.html#l00035">35</a> of file <a class="el" href="../../de/da1/_nc_spectrum_8h_source.html">NcSpectrum.h</a>.</p>

</div>
</div>
<a id="a39e1200c4fda52e4fbe249efe319417a" name="a39e1200c4fda52e4fbe249efe319417a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a39e1200c4fda52e4fbe249efe319417a">&#9670;&#160;</a></span>fPositionX</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Float_t* NcSpectrum::fPositionX</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../de/da1/_nc_spectrum_8h_source.html#l00036">36</a> of file <a class="el" href="../../de/da1/_nc_spectrum_8h_source.html">NcSpectrum.h</a>.</p>

</div>
</div>
<a id="adca33b3120c85d8ab12aaee124cd210b" name="adca33b3120c85d8ab12aaee124cd210b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adca33b3120c85d8ab12aaee124cd210b">&#9670;&#160;</a></span>fPositionY</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Float_t* NcSpectrum::fPositionY</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../de/da1/_nc_spectrum_8h_source.html#l00037">37</a> of file <a class="el" href="../../de/da1/_nc_spectrum_8h_source.html">NcSpectrum.h</a>.</p>

</div>
</div>
<a id="a38f2353b9a3b30c608c5ec40167d2630" name="a38f2353b9a3b30c608c5ec40167d2630"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38f2353b9a3b30c608c5ec40167d2630">&#9670;&#160;</a></span>fResolution</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Float_t NcSpectrum::fResolution</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../de/da1/_nc_spectrum_8h_source.html#l00038">38</a> of file <a class="el" href="../../de/da1/_nc_spectrum_8h_source.html">NcSpectrum.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>ncfspack/source/<a class="el" href="../../de/da1/_nc_spectrum_8h_source.html">NcSpectrum.h</a></li>
<li>ncfspack/source/<a class="el" href="../../df/dc3/_nc_spectrum_8cxx_source.html">NcSpectrum.cxx</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../d1/d95/class_nc_spectrum.html">NcSpectrum</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
